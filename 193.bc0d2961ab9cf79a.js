(self.webpackChunkx4_new=self.webpackChunkx4_new||[]).push([[193],{7193:(he,te,R)=>{"use strict";R.r(te),R.d(te,{StationModule:()=>Zr});var e=R(1571),O=R(6895);function M(r){return null!=r&&"false"!=`${r}`}function L(r,n=0){return function m(r){return!isNaN(parseFloat(r))&&!isNaN(Number(r))}(r)?Number(r):n}function U(r){return r instanceof e.SBq?r.nativeElement:r}var F=R(7579),z=R(9646),W=R(9751),B=R(4968),Y=R(4408),H=R(727);const q={schedule(r){let n=requestAnimationFrame,t=cancelAnimationFrame;const{delegate:i}=q;i&&(n=i.requestAnimationFrame,t=i.cancelAnimationFrame);const o=n(l=>{t=void 0,r(l)});return new H.w0(()=>t?.(o))},requestAnimationFrame(...r){const{delegate:n}=q;return(n?.requestAnimationFrame||requestAnimationFrame)(...r)},cancelAnimationFrame(...r){const{delegate:n}=q;return(n?.cancelAnimationFrame||cancelAnimationFrame)(...r)},delegate:void 0};var N=R(640);const h=new class k extends N.v{flush(n){this._active=!0;const t=this._scheduled;this._scheduled=void 0;const{actions:i}=this;let o;n=n||i.shift();do{if(o=n.execute(n.state,n.delay))break}while((n=i[0])&&n.id===t&&i.shift());if(this._active=!1,o){for(;(n=i[0])&&n.id===t&&i.shift();)n.unsubscribe();throw o}}}(class se extends Y.o{constructor(n,t){super(n,t),this.scheduler=n,this.work=t}requestAsyncId(n,t,i=0){return null!==i&&i>0?super.requestAsyncId(n,t,i):(n.actions.push(this),n._scheduled||(n._scheduled=q.requestAnimationFrame(()=>n.flush(void 0))))}recycleAsyncId(n,t,i=0){var o;if(null!=i?i>0:this.delay>0)return super.recycleAsyncId(n,t,i);const{actions:l}=n;null!=t&&(null===(o=l[l.length-1])||void 0===o?void 0:o.id)!==t&&(q.cancelAnimationFrame(t),n._scheduled=void 0)}});let P,y=1;const $={};function T(r){return r in $&&(delete $[r],!0)}const K={setImmediate(r){const n=y++;return $[n]=!0,P||(P=Promise.resolve()),P.then(()=>T(n)&&r()),n},clearImmediate(r){T(r)}},{setImmediate:_e,clearImmediate:Ne}=K,ve={setImmediate(...r){const{delegate:n}=ve;return(n?.setImmediate||_e)(...r)},clearImmediate(r){const{delegate:n}=ve;return(n?.clearImmediate||Ne)(r)},delegate:void 0};new class De extends N.v{flush(n){this._active=!0;const t=this._scheduled;this._scheduled=void 0;const{actions:i}=this;let o;n=n||i.shift();do{if(o=n.execute(n.state,n.delay))break}while((n=i[0])&&n.id===t&&i.shift());if(this._active=!1,o){for(;(n=i[0])&&n.id===t&&i.shift();)n.unsubscribe();throw o}}}(class Me extends Y.o{constructor(n,t){super(n,t),this.scheduler=n,this.work=t}requestAsyncId(n,t,i=0){return null!==i&&i>0?super.requestAsyncId(n,t,i):(n.actions.push(this),n._scheduled||(n._scheduled=ve.setImmediate(n.flush.bind(n,void 0))))}recycleAsyncId(n,t,i=0){var o;if(null!=i?i>0:this.delay>0)return super.recycleAsyncId(n,t,i);const{actions:l}=n;null!=t&&(null===(o=l[l.length-1])||void 0===o?void 0:o.id)!==t&&(ve.clearImmediate(t),n._scheduled=void 0)}});var we=R(4986),xe=R(4482),ae=R(8421),ge=R(5403),be=R(5963);function Re(r,n=we.z){return function ke(r){return(0,xe.e)((n,t)=>{let i=!1,o=null,l=null,f=!1;const S=()=>{if(l?.unsubscribe(),l=null,i){i=!1;const x=o;o=null,t.next(x)}f&&t.complete()},v=()=>{l=null,f&&t.complete()};n.subscribe((0,ge.x)(t,x=>{i=!0,o=x,l||(0,ae.Xf)(r(x)).subscribe(l=(0,ge.x)(t,S,v))},()=>{f=!0,(!i||!l||l.closed)&&t.complete()}))})}(()=>(0,be.H)(r,n))}var $e=R(9300);let _;try{_=typeof Intl<"u"&&Intl.v8BreakIterator}catch{_=!1}let Q,E,c=(()=>{class r{constructor(t){this._platformId=t,this.isBrowser=this._platformId?(0,O.NF)(this._platformId):"object"==typeof document&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!(!window.chrome&&!_)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}}return r.\u0275fac=function(t){return new(t||r)(e.LFG(e.Lbi))},r.\u0275prov=e.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})();function Te(r){return function me(){if(null==Q&&typeof window<"u")try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>Q=!0}))}finally{Q=Q||!1}return Q}()?r:!!r.capture}function b(r){if(function w(){if(null==E){const r=typeof document<"u"?document.head:null;E=!(!r||!r.createShadowRoot&&!r.attachShadow)}return E}()){const n=r.getRootNode?r.getRootNode():null;if(typeof ShadowRoot<"u"&&ShadowRoot&&n instanceof ShadowRoot)return n}return null}function ie(r){return r.composedPath?r.composedPath()[0]:r.target}let Cn=(()=>{class r{constructor(t,i,o){this._ngZone=t,this._platform=i,this._scrolled=new F.x,this._globalSubscription=null,this._scrolledCount=0,this.scrollContainers=new Map,this._document=o}register(t){this.scrollContainers.has(t)||this.scrollContainers.set(t,t.elementScrolled().subscribe(()=>this._scrolled.next(t)))}deregister(t){const i=this.scrollContainers.get(t);i&&(i.unsubscribe(),this.scrollContainers.delete(t))}scrolled(t=20){return this._platform.isBrowser?new W.y(i=>{this._globalSubscription||this._addGlobalListener();const o=t>0?this._scrolled.pipe(Re(t)).subscribe(i):this._scrolled.subscribe(i);return this._scrolledCount++,()=>{o.unsubscribe(),this._scrolledCount--,this._scrolledCount||this._removeGlobalListener()}}):(0,z.of)()}ngOnDestroy(){this._removeGlobalListener(),this.scrollContainers.forEach((t,i)=>this.deregister(i)),this._scrolled.complete()}ancestorScrolled(t,i){const o=this.getAncestorScrollContainers(t);return this.scrolled(i).pipe((0,$e.h)(l=>!l||o.indexOf(l)>-1))}getAncestorScrollContainers(t){const i=[];return this.scrollContainers.forEach((o,l)=>{this._scrollableContainsElement(l,t)&&i.push(l)}),i}_getWindow(){return this._document.defaultView||window}_scrollableContainsElement(t,i){let o=U(i),l=t.getElementRef().nativeElement;do{if(o==l)return!0}while(o=o.parentElement);return!1}_addGlobalListener(){this._globalSubscription=this._ngZone.runOutsideAngular(()=>{const t=this._getWindow();return(0,B.R)(t.document,"scroll").subscribe(()=>this._scrolled.next())})}_removeGlobalListener(){this._globalSubscription&&(this._globalSubscription.unsubscribe(),this._globalSubscription=null)}}return r.\u0275fac=function(t){return new(t||r)(e.LFG(e.R0b),e.LFG(c),e.LFG(O.K0,8))},r.\u0275prov=e.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})(),yn=(()=>{class r{constructor(t,i,o){this._platform=t,this._change=new F.x,this._changeListener=l=>{this._change.next(l)},this._document=o,i.runOutsideAngular(()=>{if(t.isBrowser){const l=this._getWindow();l.addEventListener("resize",this._changeListener),l.addEventListener("orientationchange",this._changeListener)}this.change().subscribe(()=>this._viewportSize=null)})}ngOnDestroy(){if(this._platform.isBrowser){const t=this._getWindow();t.removeEventListener("resize",this._changeListener),t.removeEventListener("orientationchange",this._changeListener)}this._change.complete()}getViewportSize(){this._viewportSize||this._updateViewportSize();const t={width:this._viewportSize.width,height:this._viewportSize.height};return this._platform.isBrowser||(this._viewportSize=null),t}getViewportRect(){const t=this.getViewportScrollPosition(),{width:i,height:o}=this.getViewportSize();return{top:t.top,left:t.left,bottom:t.top+o,right:t.left+i,height:o,width:i}}getViewportScrollPosition(){if(!this._platform.isBrowser)return{top:0,left:0};const t=this._document,i=this._getWindow(),o=t.documentElement,l=o.getBoundingClientRect();return{top:-l.top||t.body.scrollTop||i.scrollY||o.scrollTop||0,left:-l.left||t.body.scrollLeft||i.scrollX||o.scrollLeft||0}}change(t=20){return t>0?this._change.pipe(Re(t)):this._change}_getWindow(){return this._document.defaultView||window}_updateViewportSize(){const t=this._getWindow();this._viewportSize=this._platform.isBrowser?{width:t.innerWidth,height:t.innerHeight}:{width:0,height:0}}}return r.\u0275fac=function(t){return new(t||r)(e.LFG(c),e.LFG(e.R0b),e.LFG(O.K0,8))},r.\u0275prov=e.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})(),vn=(()=>{class r{}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({}),r})();var at=R(6451),Ge=R(2722),lt=R(8675),Bn=R(4004),bt=R(5698),$n=R(8505),Yn=R(3900);const Gn=new e.OlP("cdk-dir-doc",{providedIn:"root",factory:function Vn(){return(0,e.f3M)(O.K0)}}),zn=/^(ar|ckb|dv|he|iw|fa|nqo|ps|sd|ug|ur|yi|.*[-_](Adlm|Arab|Hebr|Nkoo|Rohg|Thaa))(?!.*[-_](Latn|Cyrl)($|-|_))($|-|_)/i;let Rt=(()=>{class r{constructor(t){this.value="ltr",this.change=new e.vpe,t&&(this.value=function Hn(r){const n=r?.toLowerCase()||"";return"auto"===n&&typeof navigator<"u"&&navigator?.language?zn.test(navigator.language)?"rtl":"ltr":"rtl"===n?"rtl":"ltr"}((t.body?t.body.dir:null)||(t.documentElement?t.documentElement.dir:null)||"ltr"))}ngOnDestroy(){this.change.complete()}}return r.\u0275fac=function(t){return new(t||r)(e.LFG(Gn,8))},r.\u0275prov=e.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})();function ct(r,n,t){for(let i in n)if(n.hasOwnProperty(i)){const o=n[i];o?r.setProperty(i,o,t?.has(i)?"important":""):r.removeProperty(i)}return r}function Le(r,n){const t=n?"":"none";ct(r.style,{"touch-action":n?"":"none","-webkit-user-drag":n?"":"none","-webkit-tap-highlight-color":n?"":"transparent","user-select":t,"-ms-user-select":t,"-webkit-user-select":t,"-moz-user-select":t})}function xt(r,n,t){ct(r.style,{position:n?"":"fixed",top:n?"":"0",opacity:n?"":"0",left:n?"":"-999em"},t)}function Qe(r,n){return n&&"none"!=n?r+" "+n:r}function Pt(r){const n=r.toLowerCase().indexOf("ms")>-1?1:1e3;return parseFloat(r)*n}function ut(r,n){return r.getPropertyValue(n).split(",").map(i=>i.trim())}function dt(r){const n=r.getBoundingClientRect();return{top:n.top,right:n.right,bottom:n.bottom,left:n.left,width:n.width,height:n.height,x:n.x,y:n.y}}function _t(r,n,t){const{top:i,bottom:o,left:l,right:f}=r;return t>=i&&t<=o&&n>=l&&n<=f}function Ve(r,n,t){r.top+=n,r.bottom=r.top+r.height,r.left+=t,r.right=r.left+r.width}function Dt(r,n,t,i){const{top:o,right:l,bottom:f,left:S,width:v,height:x}=r,G=v*n,V=x*n;return i>o-V&&i<f+V&&t>S-G&&t<l+G}class kt{constructor(n){this._document=n,this.positions=new Map}clear(){this.positions.clear()}cache(n){this.clear(),this.positions.set(this._document,{scrollPosition:this.getViewportScrollPosition()}),n.forEach(t=>{this.positions.set(t,{scrollPosition:{top:t.scrollTop,left:t.scrollLeft},clientRect:dt(t)})})}handleScroll(n){const t=ie(n),i=this.positions.get(t);if(!i)return null;const o=i.scrollPosition;let l,f;if(t===this._document){const x=this.getViewportScrollPosition();l=x.top,f=x.left}else l=t.scrollTop,f=t.scrollLeft;const S=o.top-l,v=o.left-f;return this.positions.forEach((x,G)=>{x.clientRect&&t!==G&&t.contains(G)&&Ve(x.clientRect,S,v)}),o.top=l,o.left=f,{top:S,left:v}}getViewportScrollPosition(){return{top:window.scrollY,left:window.scrollX}}}function Lt(r){const n=r.cloneNode(!0),t=n.querySelectorAll("[id]"),i=r.nodeName.toLowerCase();n.removeAttribute("id");for(let o=0;o<t.length;o++)t[o].removeAttribute("id");return"canvas"===i?Zt(r,n):("input"===i||"select"===i||"textarea"===i)&&Ut(r,n),Ft("canvas",r,n,Zt),Ft("input, textarea, select",r,n,Ut),n}function Ft(r,n,t,i){const o=n.querySelectorAll(r);if(o.length){const l=t.querySelectorAll(r);for(let f=0;f<o.length;f++)i(o[f],l[f])}}let Kn=0;function Ut(r,n){"file"!==n.type&&(n.value=r.value),"radio"===n.type&&n.name&&(n.name=`mat-clone-${n.name}-${Kn++}`)}function Zt(r,n){const t=n.getContext("2d");if(t)try{t.drawImage(r,0,0)}catch{}}const Bt=Te({passive:!0}),et=Te({passive:!1}),ht=new Set(["position"]);class qn{get disabled(){return this._disabled||!(!this._dropContainer||!this._dropContainer.disabled)}set disabled(n){const t=M(n);t!==this._disabled&&(this._disabled=t,this._toggleNativeDragInteractions(),this._handles.forEach(i=>Le(i,t)))}constructor(n,t,i,o,l,f){this._config=t,this._document=i,this._ngZone=o,this._viewportRuler=l,this._dragDropRegistry=f,this._passiveTransform={x:0,y:0},this._activeTransform={x:0,y:0},this._hasStartedDragging=!1,this._moveEvents=new F.x,this._pointerMoveSubscription=H.w0.EMPTY,this._pointerUpSubscription=H.w0.EMPTY,this._scrollSubscription=H.w0.EMPTY,this._resizeSubscription=H.w0.EMPTY,this._boundaryElement=null,this._nativeInteractionsEnabled=!0,this._handles=[],this._disabledHandles=new Set,this._direction="ltr",this.dragStartDelay=0,this._disabled=!1,this.beforeStarted=new F.x,this.started=new F.x,this.released=new F.x,this.ended=new F.x,this.entered=new F.x,this.exited=new F.x,this.dropped=new F.x,this.moved=this._moveEvents,this._pointerDown=S=>{if(this.beforeStarted.next(),this._handles.length){const v=this._getTargetHandle(S);v&&!this._disabledHandles.has(v)&&!this.disabled&&this._initializeDragSequence(v,S)}else this.disabled||this._initializeDragSequence(this._rootElement,S)},this._pointerMove=S=>{const v=this._getPointerPositionOnPage(S);if(!this._hasStartedDragging){if(Math.abs(v.x-this._pickupPositionOnPage.x)+Math.abs(v.y-this._pickupPositionOnPage.y)>=this._config.dragStartThreshold){const Se=Date.now()>=this._dragStartTime+this._getDragStartDelay(S),de=this._dropContainer;if(!Se)return void this._endDragSequence(S);(!de||!de.isDragging()&&!de.isReceiving())&&(S.preventDefault(),this._hasStartedDragging=!0,this._ngZone.run(()=>this._startDragSequence(S)))}return}S.preventDefault();const x=this._getConstrainedPointerPosition(v);if(this._hasMoved=!0,this._lastKnownPointerPosition=v,this._updatePointerDirectionDelta(x),this._dropContainer)this._updateActiveDropContainer(x,v);else{const G=this.constrainPosition?this._initialClientRect:this._pickupPositionOnPage,V=this._activeTransform;V.x=x.x-G.x+this._passiveTransform.x,V.y=x.y-G.y+this._passiveTransform.y,this._applyRootElementTransform(V.x,V.y)}this._moveEvents.observers.length&&this._ngZone.run(()=>{this._moveEvents.next({source:this,pointerPosition:x,event:S,distance:this._getDragDistance(x),delta:this._pointerDirectionDelta})})},this._pointerUp=S=>{this._endDragSequence(S)},this._nativeDragStart=S=>{if(this._handles.length){const v=this._getTargetHandle(S);v&&!this._disabledHandles.has(v)&&!this.disabled&&S.preventDefault()}else this.disabled||S.preventDefault()},this.withRootElement(n).withParent(t.parentDragRef||null),this._parentPositions=new kt(i),f.registerDragItem(this)}getPlaceholderElement(){return this._placeholder}getRootElement(){return this._rootElement}getVisibleElement(){return this.isDragging()?this.getPlaceholderElement():this.getRootElement()}withHandles(n){this._handles=n.map(i=>U(i)),this._handles.forEach(i=>Le(i,this.disabled)),this._toggleNativeDragInteractions();const t=new Set;return this._disabledHandles.forEach(i=>{this._handles.indexOf(i)>-1&&t.add(i)}),this._disabledHandles=t,this}withPreviewTemplate(n){return this._previewTemplate=n,this}withPlaceholderTemplate(n){return this._placeholderTemplate=n,this}withRootElement(n){const t=U(n);return t!==this._rootElement&&(this._rootElement&&this._removeRootElementListeners(this._rootElement),this._ngZone.runOutsideAngular(()=>{t.addEventListener("mousedown",this._pointerDown,et),t.addEventListener("touchstart",this._pointerDown,Bt),t.addEventListener("dragstart",this._nativeDragStart,et)}),this._initialTransform=void 0,this._rootElement=t),typeof SVGElement<"u"&&this._rootElement instanceof SVGElement&&(this._ownerSVGElement=this._rootElement.ownerSVGElement),this}withBoundaryElement(n){return this._boundaryElement=n?U(n):null,this._resizeSubscription.unsubscribe(),n&&(this._resizeSubscription=this._viewportRuler.change(10).subscribe(()=>this._containInsideBoundaryOnResize())),this}withParent(n){return this._parentDragRef=n,this}dispose(){this._removeRootElementListeners(this._rootElement),this.isDragging()&&this._rootElement?.remove(),this._anchor?.remove(),this._destroyPreview(),this._destroyPlaceholder(),this._dragDropRegistry.removeDragItem(this),this._removeSubscriptions(),this.beforeStarted.complete(),this.started.complete(),this.released.complete(),this.ended.complete(),this.entered.complete(),this.exited.complete(),this.dropped.complete(),this._moveEvents.complete(),this._handles=[],this._disabledHandles.clear(),this._dropContainer=void 0,this._resizeSubscription.unsubscribe(),this._parentPositions.clear(),this._boundaryElement=this._rootElement=this._ownerSVGElement=this._placeholderTemplate=this._previewTemplate=this._anchor=this._parentDragRef=null}isDragging(){return this._hasStartedDragging&&this._dragDropRegistry.isDragging(this)}reset(){this._rootElement.style.transform=this._initialTransform||"",this._activeTransform={x:0,y:0},this._passiveTransform={x:0,y:0}}disableHandle(n){!this._disabledHandles.has(n)&&this._handles.indexOf(n)>-1&&(this._disabledHandles.add(n),Le(n,!0))}enableHandle(n){this._disabledHandles.has(n)&&(this._disabledHandles.delete(n),Le(n,this.disabled))}withDirection(n){return this._direction=n,this}_withDropContainer(n){this._dropContainer=n}getFreeDragPosition(){const n=this.isDragging()?this._activeTransform:this._passiveTransform;return{x:n.x,y:n.y}}setFreeDragPosition(n){return this._activeTransform={x:0,y:0},this._passiveTransform.x=n.x,this._passiveTransform.y=n.y,this._dropContainer||this._applyRootElementTransform(n.x,n.y),this}withPreviewContainer(n){return this._previewContainer=n,this}_sortFromLastPointerPosition(){const n=this._lastKnownPointerPosition;n&&this._dropContainer&&this._updateActiveDropContainer(this._getConstrainedPointerPosition(n),n)}_removeSubscriptions(){this._pointerMoveSubscription.unsubscribe(),this._pointerUpSubscription.unsubscribe(),this._scrollSubscription.unsubscribe()}_destroyPreview(){this._preview?.remove(),this._previewRef?.destroy(),this._preview=this._previewRef=null}_destroyPlaceholder(){this._placeholder?.remove(),this._placeholderRef?.destroy(),this._placeholder=this._placeholderRef=null}_endDragSequence(n){if(this._dragDropRegistry.isDragging(this)&&(this._removeSubscriptions(),this._dragDropRegistry.stopDragging(this),this._toggleNativeDragInteractions(),this._handles&&(this._rootElement.style.webkitTapHighlightColor=this._rootElementTapHighlight),this._hasStartedDragging))if(this.released.next({source:this,event:n}),this._dropContainer)this._dropContainer._stopScrolling(),this._animatePreviewToPlaceholder().then(()=>{this._cleanupDragArtifacts(n),this._cleanupCachedDimensions(),this._dragDropRegistry.stopDragging(this)});else{this._passiveTransform.x=this._activeTransform.x;const t=this._getPointerPositionOnPage(n);this._passiveTransform.y=this._activeTransform.y,this._ngZone.run(()=>{this.ended.next({source:this,distance:this._getDragDistance(t),dropPoint:t,event:n})}),this._cleanupCachedDimensions(),this._dragDropRegistry.stopDragging(this)}}_startDragSequence(n){ze(n)&&(this._lastTouchEventTime=Date.now()),this._toggleNativeDragInteractions();const t=this._dropContainer;if(t){const i=this._rootElement,o=i.parentNode,l=this._placeholder=this._createPlaceholderElement(),f=this._anchor=this._anchor||this._document.createComment(""),S=this._getShadowRoot();o.insertBefore(f,i),this._initialTransform=i.style.transform||"",this._preview=this._createPreviewElement(),xt(i,!1,ht),this._document.body.appendChild(o.replaceChild(l,i)),this._getPreviewInsertionPoint(o,S).appendChild(this._preview),this.started.next({source:this,event:n}),t.start(),this._initialContainer=t,this._initialIndex=t.getItemIndex(this)}else this.started.next({source:this,event:n}),this._initialContainer=this._initialIndex=void 0;this._parentPositions.cache(t?t.getScrollableParents():[])}_initializeDragSequence(n,t){this._parentDragRef&&t.stopPropagation();const i=this.isDragging(),o=ze(t),l=!o&&0!==t.button,f=this._rootElement,S=ie(t),v=!o&&this._lastTouchEventTime&&this._lastTouchEventTime+800>Date.now(),x=o?function Fn(r){const n=r.touches&&r.touches[0]||r.changedTouches&&r.changedTouches[0];return!(!n||-1!==n.identifier||null!=n.radiusX&&1!==n.radiusX||null!=n.radiusY&&1!==n.radiusY)}(t):function Ln(r){return 0===r.buttons||0===r.offsetX&&0===r.offsetY}(t);if(S&&S.draggable&&"mousedown"===t.type&&t.preventDefault(),i||l||v||x)return;if(this._handles.length){const oe=f.style;this._rootElementTapHighlight=oe.webkitTapHighlightColor||"",oe.webkitTapHighlightColor="transparent"}this._hasStartedDragging=this._hasMoved=!1,this._removeSubscriptions(),this._initialClientRect=this._rootElement.getBoundingClientRect(),this._pointerMoveSubscription=this._dragDropRegistry.pointerMove.subscribe(this._pointerMove),this._pointerUpSubscription=this._dragDropRegistry.pointerUp.subscribe(this._pointerUp),this._scrollSubscription=this._dragDropRegistry.scrolled(this._getShadowRoot()).subscribe(oe=>this._updateOnScroll(oe)),this._boundaryElement&&(this._boundaryRect=dt(this._boundaryElement));const G=this._previewTemplate;this._pickupPositionInElement=G&&G.template&&!G.matchSize?{x:0,y:0}:this._getPointerPositionInElement(this._initialClientRect,n,t);const V=this._pickupPositionOnPage=this._lastKnownPointerPosition=this._getPointerPositionOnPage(t);this._pointerDirectionDelta={x:0,y:0},this._pointerPositionAtLastDirectionChange={x:V.x,y:V.y},this._dragStartTime=Date.now(),this._dragDropRegistry.startDragging(this,t)}_cleanupDragArtifacts(n){xt(this._rootElement,!0,ht),this._anchor.parentNode.replaceChild(this._rootElement,this._anchor),this._destroyPreview(),this._destroyPlaceholder(),this._initialClientRect=this._boundaryRect=this._previewRect=this._initialTransform=void 0,this._ngZone.run(()=>{const t=this._dropContainer,i=t.getItemIndex(this),o=this._getPointerPositionOnPage(n),l=this._getDragDistance(o),f=t._isOverContainer(o.x,o.y);this.ended.next({source:this,distance:l,dropPoint:o,event:n}),this.dropped.next({item:this,currentIndex:i,previousIndex:this._initialIndex,container:t,previousContainer:this._initialContainer,isPointerOverContainer:f,distance:l,dropPoint:o,event:n}),t.drop(this,i,this._initialIndex,this._initialContainer,f,l,o,n),this._dropContainer=this._initialContainer})}_updateActiveDropContainer({x:n,y:t},{x:i,y:o}){let l=this._initialContainer._getSiblingContainerFromPosition(this,n,t);!l&&this._dropContainer!==this._initialContainer&&this._initialContainer._isOverContainer(n,t)&&(l=this._initialContainer),l&&l!==this._dropContainer&&this._ngZone.run(()=>{this.exited.next({item:this,container:this._dropContainer}),this._dropContainer.exit(this),this._dropContainer=l,this._dropContainer.enter(this,n,t,l===this._initialContainer&&l.sortingDisabled?this._initialIndex:void 0),this.entered.next({item:this,container:l,currentIndex:l.getItemIndex(this)})}),this.isDragging()&&(this._dropContainer._startScrollingIfNecessary(i,o),this._dropContainer._sortItem(this,n,t,this._pointerDirectionDelta),this.constrainPosition?this._applyPreviewTransform(n,t):this._applyPreviewTransform(n-this._pickupPositionInElement.x,t-this._pickupPositionInElement.y))}_createPreviewElement(){const n=this._previewTemplate,t=this.previewClass,i=n?n.template:null;let o;if(i&&n){const l=n.matchSize?this._initialClientRect:null,f=n.viewContainer.createEmbeddedView(i,n.context);f.detectChanges(),o=Yt(f,this._document),this._previewRef=f,n.matchSize?Gt(o,l):o.style.transform=tt(this._pickupPositionOnPage.x,this._pickupPositionOnPage.y)}else o=Lt(this._rootElement),Gt(o,this._initialClientRect),this._initialTransform&&(o.style.transform=this._initialTransform);return ct(o.style,{"pointer-events":"none",margin:"0",position:"fixed",top:"0",left:"0","z-index":`${this._config.zIndex||1e3}`},ht),Le(o,!1),o.classList.add("cdk-drag-preview"),o.setAttribute("dir",this._direction),t&&(Array.isArray(t)?t.forEach(l=>o.classList.add(l)):o.classList.add(t)),o}_animatePreviewToPlaceholder(){if(!this._hasMoved)return Promise.resolve();const n=this._placeholder.getBoundingClientRect();this._preview.classList.add("cdk-drag-animating"),this._applyPreviewTransform(n.left,n.top);const t=function jn(r){const n=getComputedStyle(r),t=ut(n,"transition-property"),i=t.find(S=>"transform"===S||"all"===S);if(!i)return 0;const o=t.indexOf(i),l=ut(n,"transition-duration"),f=ut(n,"transition-delay");return Pt(l[o])+Pt(f[o])}(this._preview);return 0===t?Promise.resolve():this._ngZone.runOutsideAngular(()=>new Promise(i=>{const o=f=>{(!f||ie(f)===this._preview&&"transform"===f.propertyName)&&(this._preview?.removeEventListener("transitionend",o),i(),clearTimeout(l))},l=setTimeout(o,1.5*t);this._preview.addEventListener("transitionend",o)}))}_createPlaceholderElement(){const n=this._placeholderTemplate,t=n?n.template:null;let i;return t?(this._placeholderRef=n.viewContainer.createEmbeddedView(t,n.context),this._placeholderRef.detectChanges(),i=Yt(this._placeholderRef,this._document)):i=Lt(this._rootElement),i.style.pointerEvents="none",i.classList.add("cdk-drag-placeholder"),i}_getPointerPositionInElement(n,t,i){const o=t===this._rootElement?null:t,l=o?o.getBoundingClientRect():n,f=ze(i)?i.targetTouches[0]:i,S=this._getViewportScrollPosition();return{x:l.left-n.left+(f.pageX-l.left-S.left),y:l.top-n.top+(f.pageY-l.top-S.top)}}_getPointerPositionOnPage(n){const t=this._getViewportScrollPosition(),i=ze(n)?n.touches[0]||n.changedTouches[0]||{pageX:0,pageY:0}:n,o=i.pageX-t.left,l=i.pageY-t.top;if(this._ownerSVGElement){const f=this._ownerSVGElement.getScreenCTM();if(f){const S=this._ownerSVGElement.createSVGPoint();return S.x=o,S.y=l,S.matrixTransform(f.inverse())}}return{x:o,y:l}}_getConstrainedPointerPosition(n){const t=this._dropContainer?this._dropContainer.lockAxis:null;let{x:i,y:o}=this.constrainPosition?this.constrainPosition(n,this,this._initialClientRect,this._pickupPositionInElement):n;if("x"===this.lockAxis||"x"===t?o=this._pickupPositionOnPage.y:("y"===this.lockAxis||"y"===t)&&(i=this._pickupPositionOnPage.x),this._boundaryRect){const{x:l,y:f}=this._pickupPositionInElement,S=this._boundaryRect,{width:v,height:x}=this._getPreviewRect(),G=S.top+f,V=S.bottom-(x-f);i=$t(i,S.left+l,S.right-(v-l)),o=$t(o,G,V)}return{x:i,y:o}}_updatePointerDirectionDelta(n){const{x:t,y:i}=n,o=this._pointerDirectionDelta,l=this._pointerPositionAtLastDirectionChange,f=Math.abs(t-l.x),S=Math.abs(i-l.y);return f>this._config.pointerDirectionChangeThreshold&&(o.x=t>l.x?1:-1,l.x=t),S>this._config.pointerDirectionChangeThreshold&&(o.y=i>l.y?1:-1,l.y=i),o}_toggleNativeDragInteractions(){if(!this._rootElement||!this._handles)return;const n=this._handles.length>0||!this.isDragging();n!==this._nativeInteractionsEnabled&&(this._nativeInteractionsEnabled=n,Le(this._rootElement,n))}_removeRootElementListeners(n){n.removeEventListener("mousedown",this._pointerDown,et),n.removeEventListener("touchstart",this._pointerDown,Bt),n.removeEventListener("dragstart",this._nativeDragStart,et)}_applyRootElementTransform(n,t){const i=tt(n,t),o=this._rootElement.style;null==this._initialTransform&&(this._initialTransform=o.transform&&"none"!=o.transform?o.transform:""),o.transform=Qe(i,this._initialTransform)}_applyPreviewTransform(n,t){const i=this._previewTemplate?.template?void 0:this._initialTransform,o=tt(n,t);this._preview.style.transform=Qe(o,i)}_getDragDistance(n){const t=this._pickupPositionOnPage;return t?{x:n.x-t.x,y:n.y-t.y}:{x:0,y:0}}_cleanupCachedDimensions(){this._boundaryRect=this._previewRect=void 0,this._parentPositions.clear()}_containInsideBoundaryOnResize(){let{x:n,y:t}=this._passiveTransform;if(0===n&&0===t||this.isDragging()||!this._boundaryElement)return;const i=this._rootElement.getBoundingClientRect(),o=this._boundaryElement.getBoundingClientRect();if(0===o.width&&0===o.height||0===i.width&&0===i.height)return;const l=o.left-i.left,f=i.right-o.right,S=o.top-i.top,v=i.bottom-o.bottom;o.width>i.width?(l>0&&(n+=l),f>0&&(n-=f)):n=0,o.height>i.height?(S>0&&(t+=S),v>0&&(t-=v)):t=0,(n!==this._passiveTransform.x||t!==this._passiveTransform.y)&&this.setFreeDragPosition({y:t,x:n})}_getDragStartDelay(n){const t=this.dragStartDelay;return"number"==typeof t?t:ze(n)?t.touch:t?t.mouse:0}_updateOnScroll(n){const t=this._parentPositions.handleScroll(n);if(t){const i=ie(n);this._boundaryRect&&i!==this._boundaryElement&&i.contains(this._boundaryElement)&&Ve(this._boundaryRect,t.top,t.left),this._pickupPositionOnPage.x+=t.left,this._pickupPositionOnPage.y+=t.top,this._dropContainer||(this._activeTransform.x-=t.left,this._activeTransform.y-=t.top,this._applyRootElementTransform(this._activeTransform.x,this._activeTransform.y))}}_getViewportScrollPosition(){return this._parentPositions.positions.get(this._document)?.scrollPosition||this._parentPositions.getViewportScrollPosition()}_getShadowRoot(){return void 0===this._cachedShadowRoot&&(this._cachedShadowRoot=b(this._rootElement)),this._cachedShadowRoot}_getPreviewInsertionPoint(n,t){const i=this._previewContainer||"global";if("parent"===i)return n;if("global"===i){const o=this._document;return t||o.fullscreenElement||o.webkitFullscreenElement||o.mozFullScreenElement||o.msFullscreenElement||o.body}return U(i)}_getPreviewRect(){return(!this._previewRect||!this._previewRect.width&&!this._previewRect.height)&&(this._previewRect=this._preview?this._preview.getBoundingClientRect():this._initialClientRect),this._previewRect}_getTargetHandle(n){return this._handles.find(t=>n.target&&(n.target===t||t.contains(n.target)))}}function tt(r,n){return`translate3d(${Math.round(r)}px, ${Math.round(n)}px, 0)`}function $t(r,n,t){return Math.max(n,Math.min(t,r))}function ze(r){return"t"===r.type[0]}function Yt(r,n){const t=r.rootNodes;if(1===t.length&&t[0].nodeType===n.ELEMENT_NODE)return t[0];const i=n.createElement("div");return t.forEach(o=>i.appendChild(o)),i}function Gt(r,n){r.style.width=`${n.width}px`,r.style.height=`${n.height}px`,r.style.transform=tt(n.left,n.top)}function Vt(r,n,t){const i=He(n,r.length-1),o=He(t,r.length-1);if(i===o)return;const l=r[i],f=o<i?-1:1;for(let S=i;S!==o;S+=f)r[S]=r[S+f];r[o]=l}function He(r,n){return Math.max(0,Math.min(n,r))}class Xn{constructor(n,t){this._element=n,this._dragDropRegistry=t,this._itemPositions=[],this.orientation="vertical",this._previousSwap={drag:null,delta:0,overlaps:!1}}start(n){this.withItems(n)}sort(n,t,i,o){const l=this._itemPositions,f=this._getItemIndexFromPointerPosition(n,t,i,o);if(-1===f&&l.length>0)return null;const S="horizontal"===this.orientation,v=l.findIndex(ye=>ye.drag===n),x=l[f],V=x.clientRect,oe=v>f?1:-1,Se=this._getItemOffsetPx(l[v].clientRect,V,oe),de=this._getSiblingOffsetPx(v,l,oe),Ie=l.slice();return Vt(l,v,f),l.forEach((ye,rt)=>{if(Ie[rt]===ye)return;const qe=ye.drag===n,Be=qe?Se:de,Xe=qe?n.getPlaceholderElement():ye.drag.getRootElement();ye.offset+=Be,S?(Xe.style.transform=Qe(`translate3d(${Math.round(ye.offset)}px, 0, 0)`,ye.initialTransform),Ve(ye.clientRect,0,Be)):(Xe.style.transform=Qe(`translate3d(0, ${Math.round(ye.offset)}px, 0)`,ye.initialTransform),Ve(ye.clientRect,Be,0))}),this._previousSwap.overlaps=_t(V,t,i),this._previousSwap.drag=x.drag,this._previousSwap.delta=S?o.x:o.y,{previousIndex:v,currentIndex:f}}enter(n,t,i,o){const l=null==o||o<0?this._getItemIndexFromPointerPosition(n,t,i):o,f=this._activeDraggables,S=f.indexOf(n),v=n.getPlaceholderElement();let x=f[l];if(x===n&&(x=f[l+1]),!x&&(null==l||-1===l||l<f.length-1)&&this._shouldEnterAsFirstChild(t,i)&&(x=f[0]),S>-1&&f.splice(S,1),x&&!this._dragDropRegistry.isDragging(x)){const G=x.getRootElement();G.parentElement.insertBefore(v,G),f.splice(l,0,n)}else U(this._element).appendChild(v),f.push(n);v.style.transform="",this._cacheItemPositions()}withItems(n){this._activeDraggables=n.slice(),this._cacheItemPositions()}withSortPredicate(n){this._sortPredicate=n}reset(){this._activeDraggables.forEach(n=>{const t=n.getRootElement();if(t){const i=this._itemPositions.find(o=>o.drag===n)?.initialTransform;t.style.transform=i||""}}),this._itemPositions=[],this._activeDraggables=[],this._previousSwap.drag=null,this._previousSwap.delta=0,this._previousSwap.overlaps=!1}getActiveItemsSnapshot(){return this._activeDraggables}getItemIndex(n){return("horizontal"===this.orientation&&"rtl"===this.direction?this._itemPositions.slice().reverse():this._itemPositions).findIndex(i=>i.drag===n)}updateOnScroll(n,t){this._itemPositions.forEach(({clientRect:i})=>{Ve(i,n,t)}),this._itemPositions.forEach(({drag:i})=>{this._dragDropRegistry.isDragging(i)&&i._sortFromLastPointerPosition()})}_cacheItemPositions(){const n="horizontal"===this.orientation;this._itemPositions=this._activeDraggables.map(t=>{const i=t.getVisibleElement();return{drag:t,offset:0,initialTransform:i.style.transform||"",clientRect:dt(i)}}).sort((t,i)=>n?t.clientRect.left-i.clientRect.left:t.clientRect.top-i.clientRect.top)}_getItemOffsetPx(n,t,i){const o="horizontal"===this.orientation;let l=o?t.left-n.left:t.top-n.top;return-1===i&&(l+=o?t.width-n.width:t.height-n.height),l}_getSiblingOffsetPx(n,t,i){const o="horizontal"===this.orientation,l=t[n].clientRect,f=t[n+-1*i];let S=l[o?"width":"height"]*i;if(f){const v=o?"left":"top",x=o?"right":"bottom";-1===i?S-=f.clientRect[v]-l[x]:S+=l[v]-f.clientRect[x]}return S}_shouldEnterAsFirstChild(n,t){if(!this._activeDraggables.length)return!1;const i=this._itemPositions,o="horizontal"===this.orientation;if(i[0].drag!==this._activeDraggables[0]){const f=i[i.length-1].clientRect;return o?n>=f.right:t>=f.bottom}{const f=i[0].clientRect;return o?n<=f.left:t<=f.top}}_getItemIndexFromPointerPosition(n,t,i,o){const l="horizontal"===this.orientation,f=this._itemPositions.findIndex(({drag:S,clientRect:v})=>S!==n&&((!o||S!==this._previousSwap.drag||!this._previousSwap.overlaps||(l?o.x:o.y)!==this._previousSwap.delta)&&(l?t>=Math.floor(v.left)&&t<Math.floor(v.right):i>=Math.floor(v.top)&&i<Math.floor(v.bottom))));return-1!==f&&this._sortPredicate(f,n)?f:-1}}const Ht=.05;class Jn{constructor(n,t,i,o,l){this._dragDropRegistry=t,this._ngZone=o,this._viewportRuler=l,this.disabled=!1,this.sortingDisabled=!1,this.autoScrollDisabled=!1,this.autoScrollStep=2,this.enterPredicate=()=>!0,this.sortPredicate=()=>!0,this.beforeStarted=new F.x,this.entered=new F.x,this.exited=new F.x,this.dropped=new F.x,this.sorted=new F.x,this.receivingStarted=new F.x,this.receivingStopped=new F.x,this._isDragging=!1,this._draggables=[],this._siblings=[],this._activeSiblings=new Set,this._viewportScrollSubscription=H.w0.EMPTY,this._verticalScrollDirection=0,this._horizontalScrollDirection=0,this._stopScrollTimers=new F.x,this._cachedShadowRoot=null,this._startScrollInterval=()=>{this._stopScrolling(),function Zn(r=0,n=we.z){return r<0&&(r=0),(0,be.H)(r,r,n)}(0,h).pipe((0,Ge.R)(this._stopScrollTimers)).subscribe(()=>{const f=this._scrollNode,S=this.autoScrollStep;1===this._verticalScrollDirection?f.scrollBy(0,-S):2===this._verticalScrollDirection&&f.scrollBy(0,S),1===this._horizontalScrollDirection?f.scrollBy(-S,0):2===this._horizontalScrollDirection&&f.scrollBy(S,0)})},this.element=U(n),this._document=i,this.withScrollableParents([this.element]),t.registerDropContainer(this),this._parentPositions=new kt(i),this._sortStrategy=new Xn(this.element,t),this._sortStrategy.withSortPredicate((f,S)=>this.sortPredicate(f,S,this))}dispose(){this._stopScrolling(),this._stopScrollTimers.complete(),this._viewportScrollSubscription.unsubscribe(),this.beforeStarted.complete(),this.entered.complete(),this.exited.complete(),this.dropped.complete(),this.sorted.complete(),this.receivingStarted.complete(),this.receivingStopped.complete(),this._activeSiblings.clear(),this._scrollNode=null,this._parentPositions.clear(),this._dragDropRegistry.removeDropContainer(this)}isDragging(){return this._isDragging}start(){this._draggingStarted(),this._notifyReceivingSiblings()}enter(n,t,i,o){this._draggingStarted(),null==o&&this.sortingDisabled&&(o=this._draggables.indexOf(n)),this._sortStrategy.enter(n,t,i,o),this._cacheParentPositions(),this._notifyReceivingSiblings(),this.entered.next({item:n,container:this,currentIndex:this.getItemIndex(n)})}exit(n){this._reset(),this.exited.next({item:n,container:this})}drop(n,t,i,o,l,f,S,v={}){this._reset(),this.dropped.next({item:n,currentIndex:t,previousIndex:i,container:this,previousContainer:o,isPointerOverContainer:l,distance:f,dropPoint:S,event:v})}withItems(n){const t=this._draggables;return this._draggables=n,n.forEach(i=>i._withDropContainer(this)),this.isDragging()&&(t.filter(o=>o.isDragging()).every(o=>-1===n.indexOf(o))?this._reset():this._sortStrategy.withItems(this._draggables)),this}withDirection(n){return this._sortStrategy.direction=n,this}connectedTo(n){return this._siblings=n.slice(),this}withOrientation(n){return this._sortStrategy.orientation=n,this}withScrollableParents(n){const t=U(this.element);return this._scrollableElements=-1===n.indexOf(t)?[t,...n]:n.slice(),this}getScrollableParents(){return this._scrollableElements}getItemIndex(n){return this._isDragging?this._sortStrategy.getItemIndex(n):this._draggables.indexOf(n)}isReceiving(){return this._activeSiblings.size>0}_sortItem(n,t,i,o){if(this.sortingDisabled||!this._clientRect||!Dt(this._clientRect,.05,t,i))return;const l=this._sortStrategy.sort(n,t,i,o);l&&this.sorted.next({previousIndex:l.previousIndex,currentIndex:l.currentIndex,container:this,item:n})}_startScrollingIfNecessary(n,t){if(this.autoScrollDisabled)return;let i,o=0,l=0;if(this._parentPositions.positions.forEach((f,S)=>{S===this._document||!f.clientRect||i||Dt(f.clientRect,.05,n,t)&&([o,l]=function Qn(r,n,t,i){const o=jt(n,i),l=Kt(n,t);let f=0,S=0;if(o){const v=r.scrollTop;1===o?v>0&&(f=1):r.scrollHeight-v>r.clientHeight&&(f=2)}if(l){const v=r.scrollLeft;1===l?v>0&&(S=1):r.scrollWidth-v>r.clientWidth&&(S=2)}return[f,S]}(S,f.clientRect,n,t),(o||l)&&(i=S))}),!o&&!l){const{width:f,height:S}=this._viewportRuler.getViewportSize(),v={width:f,height:S,top:0,right:f,bottom:S,left:0};o=jt(v,t),l=Kt(v,n),i=window}i&&(o!==this._verticalScrollDirection||l!==this._horizontalScrollDirection||i!==this._scrollNode)&&(this._verticalScrollDirection=o,this._horizontalScrollDirection=l,this._scrollNode=i,(o||l)&&i?this._ngZone.runOutsideAngular(this._startScrollInterval):this._stopScrolling())}_stopScrolling(){this._stopScrollTimers.next()}_draggingStarted(){const n=U(this.element).style;this.beforeStarted.next(),this._isDragging=!0,this._initialScrollSnap=n.msScrollSnapType||n.scrollSnapType||"",n.scrollSnapType=n.msScrollSnapType="none",this._sortStrategy.start(this._draggables),this._cacheParentPositions(),this._viewportScrollSubscription.unsubscribe(),this._listenToScrollEvents()}_cacheParentPositions(){const n=U(this.element);this._parentPositions.cache(this._scrollableElements),this._clientRect=this._parentPositions.positions.get(n).clientRect}_reset(){this._isDragging=!1;const n=U(this.element).style;n.scrollSnapType=n.msScrollSnapType=this._initialScrollSnap,this._siblings.forEach(t=>t._stopReceiving(this)),this._sortStrategy.reset(),this._stopScrolling(),this._viewportScrollSubscription.unsubscribe(),this._parentPositions.clear()}_isOverContainer(n,t){return null!=this._clientRect&&_t(this._clientRect,n,t)}_getSiblingContainerFromPosition(n,t,i){return this._siblings.find(o=>o._canReceive(n,t,i))}_canReceive(n,t,i){if(!this._clientRect||!_t(this._clientRect,t,i)||!this.enterPredicate(n,this))return!1;const o=this._getShadowRoot().elementFromPoint(t,i);if(!o)return!1;const l=U(this.element);return o===l||l.contains(o)}_startReceiving(n,t){const i=this._activeSiblings;!i.has(n)&&t.every(o=>this.enterPredicate(o,this)||this._draggables.indexOf(o)>-1)&&(i.add(n),this._cacheParentPositions(),this._listenToScrollEvents(),this.receivingStarted.next({initiator:n,receiver:this,items:t}))}_stopReceiving(n){this._activeSiblings.delete(n),this._viewportScrollSubscription.unsubscribe(),this.receivingStopped.next({initiator:n,receiver:this})}_listenToScrollEvents(){this._viewportScrollSubscription=this._dragDropRegistry.scrolled(this._getShadowRoot()).subscribe(n=>{if(this.isDragging()){const t=this._parentPositions.handleScroll(n);t&&this._sortStrategy.updateOnScroll(t.top,t.left)}else this.isReceiving()&&this._cacheParentPositions()})}_getShadowRoot(){if(!this._cachedShadowRoot){const n=b(U(this.element));this._cachedShadowRoot=n||this._document}return this._cachedShadowRoot}_notifyReceivingSiblings(){const n=this._sortStrategy.getActiveItemsSnapshot().filter(t=>t.isDragging());this._siblings.forEach(t=>t._startReceiving(this,n))}}function jt(r,n){const{top:t,bottom:i,height:o}=r,l=o*Ht;return n>=t-l&&n<=t+l?1:n>=i-l&&n<=i+l?2:0}function Kt(r,n){const{left:t,right:i,width:o}=r,l=o*Ht;return n>=t-l&&n<=t+l?1:n>=i-l&&n<=i+l?2:0}const nt=Te({passive:!1,capture:!0});let ei=(()=>{class r{constructor(t,i){this._ngZone=t,this._dropInstances=new Set,this._dragInstances=new Set,this._activeDragInstances=[],this._globalListeners=new Map,this._draggingPredicate=o=>o.isDragging(),this.pointerMove=new F.x,this.pointerUp=new F.x,this.scroll=new F.x,this._preventDefaultWhileDragging=o=>{this._activeDragInstances.length>0&&o.preventDefault()},this._persistentTouchmoveListener=o=>{this._activeDragInstances.length>0&&(this._activeDragInstances.some(this._draggingPredicate)&&o.preventDefault(),this.pointerMove.next(o))},this._document=i}registerDropContainer(t){this._dropInstances.has(t)||this._dropInstances.add(t)}registerDragItem(t){this._dragInstances.add(t),1===this._dragInstances.size&&this._ngZone.runOutsideAngular(()=>{this._document.addEventListener("touchmove",this._persistentTouchmoveListener,nt)})}removeDropContainer(t){this._dropInstances.delete(t)}removeDragItem(t){this._dragInstances.delete(t),this.stopDragging(t),0===this._dragInstances.size&&this._document.removeEventListener("touchmove",this._persistentTouchmoveListener,nt)}startDragging(t,i){if(!(this._activeDragInstances.indexOf(t)>-1)&&(this._activeDragInstances.push(t),1===this._activeDragInstances.length)){const o=i.type.startsWith("touch");this._globalListeners.set(o?"touchend":"mouseup",{handler:l=>this.pointerUp.next(l),options:!0}).set("scroll",{handler:l=>this.scroll.next(l),options:!0}).set("selectstart",{handler:this._preventDefaultWhileDragging,options:nt}),o||this._globalListeners.set("mousemove",{handler:l=>this.pointerMove.next(l),options:nt}),this._ngZone.runOutsideAngular(()=>{this._globalListeners.forEach((l,f)=>{this._document.addEventListener(f,l.handler,l.options)})})}}stopDragging(t){const i=this._activeDragInstances.indexOf(t);i>-1&&(this._activeDragInstances.splice(i,1),0===this._activeDragInstances.length&&this._clearGlobalListeners())}isDragging(t){return this._activeDragInstances.indexOf(t)>-1}scrolled(t){const i=[this.scroll];return t&&t!==this._document&&i.push(new W.y(o=>this._ngZone.runOutsideAngular(()=>{const f=S=>{this._activeDragInstances.length&&o.next(S)};return t.addEventListener("scroll",f,!0),()=>{t.removeEventListener("scroll",f,!0)}}))),(0,at.T)(...i)}ngOnDestroy(){this._dragInstances.forEach(t=>this.removeDragItem(t)),this._dropInstances.forEach(t=>this.removeDropContainer(t)),this._clearGlobalListeners(),this.pointerMove.complete(),this.pointerUp.complete()}_clearGlobalListeners(){this._globalListeners.forEach((t,i)=>{this._document.removeEventListener(i,t.handler,t.options)}),this._globalListeners.clear()}}return r.\u0275fac=function(t){return new(t||r)(e.LFG(e.R0b),e.LFG(O.K0))},r.\u0275prov=e.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})();const ti={dragStartThreshold:5,pointerDirectionChangeThreshold:5};let ft=(()=>{class r{constructor(t,i,o,l){this._document=t,this._ngZone=i,this._viewportRuler=o,this._dragDropRegistry=l}createDrag(t,i=ti){return new qn(t,i,this._document,this._ngZone,this._viewportRuler,this._dragDropRegistry)}createDropList(t){return new Jn(t,this._dragDropRegistry,this._document,this._ngZone,this._viewportRuler)}}return r.\u0275fac=function(t){return new(t||r)(e.LFG(O.K0),e.LFG(e.R0b),e.LFG(yn),e.LFG(ei))},r.\u0275prov=e.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})();const pt=new e.OlP("CDK_DRAG_PARENT"),gt=new e.OlP("CdkDropListGroup"),Wt=new e.OlP("CDK_DRAG_CONFIG");let ii=0;const qt=new e.OlP("CdkDropList");let Xt=(()=>{class r{get disabled(){return this._disabled||!!this._group&&this._group.disabled}set disabled(t){this._dropListRef.disabled=this._disabled=M(t)}constructor(t,i,o,l,f,S,v){this.element=t,this._changeDetectorRef=o,this._scrollDispatcher=l,this._dir=f,this._group=S,this._destroyed=new F.x,this.connectedTo=[],this.id="cdk-drop-list-"+ii++,this.enterPredicate=()=>!0,this.sortPredicate=()=>!0,this.dropped=new e.vpe,this.entered=new e.vpe,this.exited=new e.vpe,this.sorted=new e.vpe,this._unsortedItems=new Set,this._dropListRef=i.createDropList(t),this._dropListRef.data=this,v&&this._assignDefaults(v),this._dropListRef.enterPredicate=(x,G)=>this.enterPredicate(x.data,G.data),this._dropListRef.sortPredicate=(x,G,V)=>this.sortPredicate(x,G.data,V.data),this._setupInputSyncSubscription(this._dropListRef),this._handleEvents(this._dropListRef),r._dropLists.push(this),S&&S._items.add(this)}addItem(t){this._unsortedItems.add(t),this._dropListRef.isDragging()&&this._syncItemsWithRef()}removeItem(t){this._unsortedItems.delete(t),this._dropListRef.isDragging()&&this._syncItemsWithRef()}getSortedItems(){return Array.from(this._unsortedItems).sort((t,i)=>t._dragRef.getVisibleElement().compareDocumentPosition(i._dragRef.getVisibleElement())&Node.DOCUMENT_POSITION_FOLLOWING?-1:1)}ngOnDestroy(){const t=r._dropLists.indexOf(this);t>-1&&r._dropLists.splice(t,1),this._group&&this._group._items.delete(this),this._unsortedItems.clear(),this._dropListRef.dispose(),this._destroyed.next(),this._destroyed.complete()}_setupInputSyncSubscription(t){this._dir&&this._dir.change.pipe((0,lt.O)(this._dir.value),(0,Ge.R)(this._destroyed)).subscribe(i=>t.withDirection(i)),t.beforeStarted.subscribe(()=>{const i=function D(r){return Array.isArray(r)?r:[r]}(this.connectedTo).map(o=>"string"==typeof o?r._dropLists.find(f=>f.id===o):o);if(this._group&&this._group._items.forEach(o=>{-1===i.indexOf(o)&&i.push(o)}),!this._scrollableParentsResolved){const o=this._scrollDispatcher.getAncestorScrollContainers(this.element).map(l=>l.getElementRef().nativeElement);this._dropListRef.withScrollableParents(o),this._scrollableParentsResolved=!0}t.disabled=this.disabled,t.lockAxis=this.lockAxis,t.sortingDisabled=M(this.sortingDisabled),t.autoScrollDisabled=M(this.autoScrollDisabled),t.autoScrollStep=L(this.autoScrollStep,2),t.connectedTo(i.filter(o=>o&&o!==this).map(o=>o._dropListRef)).withOrientation(this.orientation)})}_handleEvents(t){t.beforeStarted.subscribe(()=>{this._syncItemsWithRef(),this._changeDetectorRef.markForCheck()}),t.entered.subscribe(i=>{this.entered.emit({container:this,item:i.item.data,currentIndex:i.currentIndex})}),t.exited.subscribe(i=>{this.exited.emit({container:this,item:i.item.data}),this._changeDetectorRef.markForCheck()}),t.sorted.subscribe(i=>{this.sorted.emit({previousIndex:i.previousIndex,currentIndex:i.currentIndex,container:this,item:i.item.data})}),t.dropped.subscribe(i=>{this.dropped.emit({previousIndex:i.previousIndex,currentIndex:i.currentIndex,previousContainer:i.previousContainer.data,container:i.container.data,item:i.item.data,isPointerOverContainer:i.isPointerOverContainer,distance:i.distance,dropPoint:i.dropPoint,event:i.event}),this._changeDetectorRef.markForCheck()}),(0,at.T)(t.receivingStarted,t.receivingStopped).subscribe(()=>this._changeDetectorRef.markForCheck())}_assignDefaults(t){const{lockAxis:i,draggingDisabled:o,sortingDisabled:l,listAutoScrollDisabled:f,listOrientation:S}=t;this.disabled=o??!1,this.sortingDisabled=l??!1,this.autoScrollDisabled=f??!1,this.orientation=S||"vertical",i&&(this.lockAxis=i)}_syncItemsWithRef(){this._dropListRef.withItems(this.getSortedItems().map(t=>t._dragRef))}}return r._dropLists=[],r.\u0275fac=function(t){return new(t||r)(e.Y36(e.SBq),e.Y36(ft),e.Y36(e.sBO),e.Y36(Cn),e.Y36(Rt,8),e.Y36(gt,12),e.Y36(Wt,8))},r.\u0275dir=e.lG2({type:r,selectors:[["","cdkDropList",""],["cdk-drop-list"]],hostAttrs:[1,"cdk-drop-list"],hostVars:7,hostBindings:function(t,i){2&t&&(e.uIk("id",i.id),e.ekj("cdk-drop-list-disabled",i.disabled)("cdk-drop-list-dragging",i._dropListRef.isDragging())("cdk-drop-list-receiving",i._dropListRef.isReceiving()))},inputs:{connectedTo:["cdkDropListConnectedTo","connectedTo"],data:["cdkDropListData","data"],orientation:["cdkDropListOrientation","orientation"],id:"id",lockAxis:["cdkDropListLockAxis","lockAxis"],disabled:["cdkDropListDisabled","disabled"],sortingDisabled:["cdkDropListSortingDisabled","sortingDisabled"],enterPredicate:["cdkDropListEnterPredicate","enterPredicate"],sortPredicate:["cdkDropListSortPredicate","sortPredicate"],autoScrollDisabled:["cdkDropListAutoScrollDisabled","autoScrollDisabled"],autoScrollStep:["cdkDropListAutoScrollStep","autoScrollStep"]},outputs:{dropped:"cdkDropListDropped",entered:"cdkDropListEntered",exited:"cdkDropListExited",sorted:"cdkDropListSorted"},exportAs:["cdkDropList"],standalone:!0,features:[e._Bn([{provide:gt,useValue:void 0},{provide:qt,useExisting:r}])]}),r})();const mt=new e.OlP("CdkDragHandle");let Jt=(()=>{class r{get disabled(){return this._disabled}set disabled(t){this._disabled=M(t),this._stateChanges.next(this)}constructor(t,i){this.element=t,this._stateChanges=new F.x,this._disabled=!1,this._parentDrag=i}ngOnDestroy(){this._stateChanges.complete()}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(e.SBq),e.Y36(pt,12))},r.\u0275dir=e.lG2({type:r,selectors:[["","cdkDragHandle",""]],hostAttrs:[1,"cdk-drag-handle"],inputs:{disabled:["cdkDragHandleDisabled","disabled"]},standalone:!0,features:[e._Bn([{provide:mt,useExisting:r}])]}),r})();const Qt=new e.OlP("CdkDragPlaceholder"),en=new e.OlP("CdkDragPreview");let tn=(()=>{class r{get matchSize(){return this._matchSize}set matchSize(t){this._matchSize=M(t)}constructor(t){this.templateRef=t,this._matchSize=!1}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(e.Rgc))},r.\u0275dir=e.lG2({type:r,selectors:[["ng-template","cdkDragPreview",""]],inputs:{data:"data",matchSize:"matchSize"},standalone:!0,features:[e._Bn([{provide:en,useExisting:r}])]}),r})(),nn=(()=>{class r{get disabled(){return this._disabled||this.dropContainer&&this.dropContainer.disabled}set disabled(t){this._disabled=M(t),this._dragRef.disabled=this._disabled}constructor(t,i,o,l,f,S,v,x,G,V,oe){this.element=t,this.dropContainer=i,this._ngZone=l,this._viewContainerRef=f,this._dir=v,this._changeDetectorRef=G,this._selfHandle=V,this._parentDrag=oe,this._destroyed=new F.x,this.started=new e.vpe,this.released=new e.vpe,this.ended=new e.vpe,this.entered=new e.vpe,this.exited=new e.vpe,this.dropped=new e.vpe,this.moved=new W.y(Se=>{const de=this._dragRef.moved.pipe((0,Bn.U)(Ie=>({source:this,pointerPosition:Ie.pointerPosition,event:Ie.event,delta:Ie.delta,distance:Ie.distance}))).subscribe(Se);return()=>{de.unsubscribe()}}),this._dragRef=x.createDrag(t,{dragStartThreshold:S&&null!=S.dragStartThreshold?S.dragStartThreshold:5,pointerDirectionChangeThreshold:S&&null!=S.pointerDirectionChangeThreshold?S.pointerDirectionChangeThreshold:5,zIndex:S?.zIndex}),this._dragRef.data=this,r._dragInstances.push(this),S&&this._assignDefaults(S),i&&(this._dragRef._withDropContainer(i._dropListRef),i.addItem(this)),this._syncInputs(this._dragRef),this._handleEvents(this._dragRef)}getPlaceholderElement(){return this._dragRef.getPlaceholderElement()}getRootElement(){return this._dragRef.getRootElement()}reset(){this._dragRef.reset()}getFreeDragPosition(){return this._dragRef.getFreeDragPosition()}setFreeDragPosition(t){this._dragRef.setFreeDragPosition(t)}ngAfterViewInit(){this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.pipe((0,bt.q)(1),(0,Ge.R)(this._destroyed)).subscribe(()=>{this._updateRootElement(),this._setupHandlesListener(),this.freeDragPosition&&this._dragRef.setFreeDragPosition(this.freeDragPosition)})})}ngOnChanges(t){const i=t.rootElementSelector,o=t.freeDragPosition;i&&!i.firstChange&&this._updateRootElement(),o&&!o.firstChange&&this.freeDragPosition&&this._dragRef.setFreeDragPosition(this.freeDragPosition)}ngOnDestroy(){this.dropContainer&&this.dropContainer.removeItem(this);const t=r._dragInstances.indexOf(this);t>-1&&r._dragInstances.splice(t,1),this._ngZone.runOutsideAngular(()=>{this._destroyed.next(),this._destroyed.complete(),this._dragRef.dispose()})}_updateRootElement(){const t=this.element.nativeElement;let i=t;this.rootElementSelector&&(i=void 0!==t.closest?t.closest(this.rootElementSelector):t.parentElement?.closest(this.rootElementSelector)),this._dragRef.withRootElement(i||t)}_getBoundaryElement(){const t=this.boundaryElement;return t?"string"==typeof t?this.element.nativeElement.closest(t):U(t):null}_syncInputs(t){t.beforeStarted.subscribe(()=>{if(!t.isDragging()){const i=this._dir,o=this.dragStartDelay,l=this._placeholderTemplate?{template:this._placeholderTemplate.templateRef,context:this._placeholderTemplate.data,viewContainer:this._viewContainerRef}:null,f=this._previewTemplate?{template:this._previewTemplate.templateRef,context:this._previewTemplate.data,matchSize:this._previewTemplate.matchSize,viewContainer:this._viewContainerRef}:null;t.disabled=this.disabled,t.lockAxis=this.lockAxis,t.dragStartDelay="object"==typeof o&&o?o:L(o),t.constrainPosition=this.constrainPosition,t.previewClass=this.previewClass,t.withBoundaryElement(this._getBoundaryElement()).withPlaceholderTemplate(l).withPreviewTemplate(f).withPreviewContainer(this.previewContainer||"global"),i&&t.withDirection(i.value)}}),t.beforeStarted.pipe((0,bt.q)(1)).subscribe(()=>{if(this._parentDrag)return void t.withParent(this._parentDrag._dragRef);let i=this.element.nativeElement.parentElement;for(;i;){if(i.classList.contains("cdk-drag")){t.withParent(r._dragInstances.find(o=>o.element.nativeElement===i)?._dragRef||null);break}i=i.parentElement}})}_handleEvents(t){t.started.subscribe(i=>{this.started.emit({source:this,event:i.event}),this._changeDetectorRef.markForCheck()}),t.released.subscribe(i=>{this.released.emit({source:this,event:i.event})}),t.ended.subscribe(i=>{this.ended.emit({source:this,distance:i.distance,dropPoint:i.dropPoint,event:i.event}),this._changeDetectorRef.markForCheck()}),t.entered.subscribe(i=>{this.entered.emit({container:i.container.data,item:this,currentIndex:i.currentIndex})}),t.exited.subscribe(i=>{this.exited.emit({container:i.container.data,item:this})}),t.dropped.subscribe(i=>{this.dropped.emit({previousIndex:i.previousIndex,currentIndex:i.currentIndex,previousContainer:i.previousContainer.data,container:i.container.data,isPointerOverContainer:i.isPointerOverContainer,item:this,distance:i.distance,dropPoint:i.dropPoint,event:i.event})})}_assignDefaults(t){const{lockAxis:i,dragStartDelay:o,constrainPosition:l,previewClass:f,boundaryElement:S,draggingDisabled:v,rootElementSelector:x,previewContainer:G}=t;this.disabled=v??!1,this.dragStartDelay=o||0,i&&(this.lockAxis=i),l&&(this.constrainPosition=l),f&&(this.previewClass=f),S&&(this.boundaryElement=S),x&&(this.rootElementSelector=x),G&&(this.previewContainer=G)}_setupHandlesListener(){this._handles.changes.pipe((0,lt.O)(this._handles),(0,$n.b)(t=>{const i=t.filter(o=>o._parentDrag===this).map(o=>o.element);this._selfHandle&&this.rootElementSelector&&i.push(this.element),this._dragRef.withHandles(i)}),(0,Yn.w)(t=>(0,at.T)(...t.map(i=>i._stateChanges.pipe((0,lt.O)(i))))),(0,Ge.R)(this._destroyed)).subscribe(t=>{const i=this._dragRef,o=t.element.nativeElement;t.disabled?i.disableHandle(o):i.enableHandle(o)})}}return r._dragInstances=[],r.\u0275fac=function(t){return new(t||r)(e.Y36(e.SBq),e.Y36(qt,12),e.Y36(O.K0),e.Y36(e.R0b),e.Y36(e.s_b),e.Y36(Wt,8),e.Y36(Rt,8),e.Y36(ft),e.Y36(e.sBO),e.Y36(mt,10),e.Y36(pt,12))},r.\u0275dir=e.lG2({type:r,selectors:[["","cdkDrag",""]],contentQueries:function(t,i,o){if(1&t&&(e.Suo(o,en,5),e.Suo(o,Qt,5),e.Suo(o,mt,5)),2&t){let l;e.iGM(l=e.CRH())&&(i._previewTemplate=l.first),e.iGM(l=e.CRH())&&(i._placeholderTemplate=l.first),e.iGM(l=e.CRH())&&(i._handles=l)}},hostAttrs:[1,"cdk-drag"],hostVars:4,hostBindings:function(t,i){2&t&&e.ekj("cdk-drag-disabled",i.disabled)("cdk-drag-dragging",i._dragRef.isDragging())},inputs:{data:["cdkDragData","data"],lockAxis:["cdkDragLockAxis","lockAxis"],rootElementSelector:["cdkDragRootElement","rootElementSelector"],boundaryElement:["cdkDragBoundary","boundaryElement"],dragStartDelay:["cdkDragStartDelay","dragStartDelay"],freeDragPosition:["cdkDragFreeDragPosition","freeDragPosition"],disabled:["cdkDragDisabled","disabled"],constrainPosition:["cdkDragConstrainPosition","constrainPosition"],previewClass:["cdkDragPreviewClass","previewClass"],previewContainer:["cdkDragPreviewContainer","previewContainer"]},outputs:{started:"cdkDragStarted",released:"cdkDragReleased",ended:"cdkDragEnded",entered:"cdkDragEntered",exited:"cdkDragExited",dropped:"cdkDragDropped",moved:"cdkDragMoved"},exportAs:["cdkDrag"],standalone:!0,features:[e._Bn([{provide:pt,useExisting:r}]),e.TTD]}),r})(),si=(()=>{class r{}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({providers:[ft],imports:[vn]}),r})();var pe=R(433),Oe=R(9453),ai=R(5398),j=R(6993);class Tt{static#e=this.map={1:{moduleId:j.j.module_gen_prod_energycells_01.id},2:{moduleId:j.j.module_gen_prod_water_01.id},3:{moduleId:j.j.module_arg_prod_meat_01.id},4:{moduleId:j.j.module_par_prod_majasnails_01.id},5:{moduleId:j.j.module_gen_prod_spices_01.id},6:{moduleId:j.j.module_arg_prod_wheat_01.id},7:{moduleId:j.j.module_par_prod_sojabeans_01.id},8:{moduleId:j.j.module_tel_prod_sunriseflowers_01.id},9:{moduleId:j.j.module_tel_prod_swampplant_01.id},10:{moduleId:j.j.module_arg_prod_medicalsupplies_01.id},11:{moduleId:j.j.module_tel_prod_medicalsupplies_01.id},12:{moduleId:j.j.module_par_prod_medicalsupplies_01.id},13:{moduleId:j.j.module_arg_prod_foodrations_01.id},14:{moduleId:j.j.module_par_prod_sojahusk_01.id},15:{moduleId:j.j.module_tel_prod_nostropoil_01.id},16:{moduleId:j.j.module_arg_prod_spacefuel_01.id},17:{moduleId:j.j.module_tel_prod_spaceweed_01.id},18:{moduleId:j.j.module_par_prod_majadust_01.id},19:{moduleId:j.j.module_gen_prod_refinedmetals_01.id},20:{moduleId:j.j.module_gen_prod_siliconwafers_01.id},21:{moduleId:j.j.module_gen_prod_antimattercells_01.id},22:{moduleId:j.j.module_gen_prod_graphene_01.id},23:{moduleId:j.j.module_gen_prod_superfluidcoolant_01.id},24:{moduleId:j.j.module_gen_prod_microchips_01.id},25:{moduleId:j.j.module_gen_prod_scanningarrays_01.id},26:{moduleId:j.j.module_gen_prod_hullparts_01},27:{moduleId:j.j.module_gen_prod_advancedcomposites_01.id},28:{moduleId:j.j.module_gen_prod_engineparts_01.id},29:{moduleId:j.j.module_gen_prod_plasmaconductors_01.id},30:{moduleId:j.j.module_gen_prod_quantumtubes_01.id},31:{moduleId:j.j.module_gen_prod_advancedelectronics_01.id},32:{moduleId:j.j.module_gen_prod_antimatterconverters_01.id},33:{moduleId:j.j.module_gen_prod_claytronics_01.id},34:{moduleId:j.j.module_gen_prod_dronecomponents_01.id},35:{moduleId:j.j.module_gen_prod_missilecomponents_01.id},36:{moduleId:j.j.module_gen_prod_shieldcomponents_01.id},37:{moduleId:j.j.module_gen_prod_turretcomponents_01.id},38:{moduleId:j.j.module_gen_prod_weaponcomponents_01.id},39:{moduleId:j.j.module_gen_prod_smartchips_01.id},40:{moduleId:j.j.module_gen_prod_fieldcoils_01.id}};getLayouts(n){return n.map(i=>({name:i.name,config:i.config.map(o=>({moduleId:Tt.map[o.moduleId].moduleId,count:o.count}))}))}getSaveData(n){return null}}class li{constructor(n){this.moduleService=n}findModule(n,t){return this.moduleService.getModuleByWare(n,t)}getLayouts(n){const t=n.layouts;return t?t.map(i=>({name:i.name,config:i.config.map(o=>{const l=this.findModule(o.moduleId,o.productionId);return{count:o.count,moduleId:l?l.id:null}}).filter(o=>null!=o.moduleId)})):[]}getSaveData(n){return{layouts:n}}}class ci{getLayouts(n){return n.layouts}getSaveData(n){return{layouts:n}}}var ui=R(2323),je=R(9746),di=R(633);let Ke=(()=>{class r{static#e=this.version=2;static#t=this.storageKey="layouts";getCurrentService(){return this.services[r.version]}constructor(t,i,o){this.storageService=t,this.moduleService=i,this.analytics=o,this.services=[new Tt,new li(i),new ci]}getLayouts(){const t=this.storageService.get(r.storageKey)||{version:r.version};return this.services[t.version||0].getLayouts(t)||[]}getLayout(t){return this.analytics.event({label:t,category:"Layouts",action:"Load Layout"}),this.getLayouts().find(i=>i.name===t)}saveLayout(t){const i=this.getLayouts(),o=i.findIndex(l=>l.name.toLowerCase()===t.name.toLowerCase());o>=0?i[o]=t:i.push(t),this.analytics.event({label:t.name,category:"Layouts",action:"Save Layout"}),this.saveLayoutsInternal(i)}deleteLayout(t){this.analytics.event({label:t,category:"Layouts",action:"Delete Layout"});const i=this.getLayouts(),o=i.findIndex(l=>l.name.toLowerCase()===t.toLowerCase());o>=0&&i.splice(o,1),this.saveLayoutsInternal(i)}saveLayoutsInternal(t){const i=this.getCurrentService().getSaveData(t);this.storageService.add(r.storageKey,{...i,version:r.version})}static#n=this.\u0275fac=function(i){return new(i||r)(e.LFG(ui.V),e.LFG(je.C),e.LFG(di.y))};static#i=this.\u0275prov=e.Yz7({token:r,factory:r.\u0275fac})}return r})();var St=R(2655),rn=R(7234),Ct=R(3273);let on=(()=>{class r{static#e=this.primary="primary";static#t=this.secondary="secondary";static#n=this.success="success";static#i=this.danger="danger";static#r=this.warning="warning";static#o=this.info="info"}return r})(),sn=(()=>{class r{constructor(t){this.activeModal=t}static#e=this.\u0275fac=function(i){return new(i||r)(e.Y36(Oe.Kz))};static#t=this.\u0275cmp=e.Xpm({type:r,selectors:[["ng-component"]],inputs:{title:"title",message:"message"},decls:13,vars:2,consts:function(){let t,i;return t="\u662F",i="\u5426",[[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[3,"innerHTML"],[1,"modal-footer"],["type","button",1,"btn","btn-primary",3,"click"],t,i]},template:function(i,o){1&i&&(e.TgZ(0,"div",0)(1,"h4",1),e._uU(2),e.qZA(),e.TgZ(3,"button",2),e.NdJ("click",function(){return o.activeModal.dismiss()}),e.TgZ(4,"span",3),e._uU(5,"\xd7"),e.qZA()()(),e.TgZ(6,"div",4),e._UZ(7,"p",5),e.qZA(),e.TgZ(8,"div",6)(9,"button",7),e.NdJ("click",function(){return o.activeModal.close(!0)}),e.SDv(10,8),e.qZA(),e.TgZ(11,"button",7),e.NdJ("click",function(){return o.activeModal.close(!1)}),e.SDv(12,9),e.qZA()()),2&i&&(e.xp6(2),e.Oqu(o.title),e.xp6(5),e.Q6J("innerHTML",o.message,e.oJD))},encapsulation:2})}return r})();function _i(r,n){if(1&r){const t=e.EpF();e.TgZ(0,"a",11),e.NdJ("click",function(o){const f=e.CHM(t).$implicit,S=e.oxw();return e.KtG(S.loadLayout(o,f))}),e.TgZ(1,"div")(2,"strong"),e._uU(3),e.qZA(),e.TgZ(4,"div",12)(5,"a",13),e.NdJ("click",function(o){const f=e.CHM(t).$implicit,S=e.oxw();return e.KtG(S.loadLayout(o,f))}),e.SDv(6,14),e.qZA(),e._uU(7," | "),e.TgZ(8,"a",15),e.NdJ("click",function(o){const f=e.CHM(t).$implicit,S=e.oxw();return e.KtG(S.addLayout(o,f))}),e.SDv(9,16),e.qZA(),e._uU(10," | "),e.TgZ(11,"a",17),e.NdJ("click",function(o){const f=e.CHM(t).$implicit,S=e.oxw();return e.KtG(S.deleteLayout(o,f))}),e.SDv(12,18),e.qZA()()(),e.TgZ(13,"div",19),e._uU(14),e.qZA()()}if(2&r){const t=n.$implicit,i=e.oxw();e.xp6(3),e.Oqu(t.name),e.xp6(11),e.hij(" ",i.getModules(t)," ")}}var Pe=(()=>{return(r=Pe||(Pe={}))[r.load=0]="load",r[r.add=1]="add",Pe;var r})();let hi=(()=>{class r extends Ct.V{constructor(t,i,o,l){super(),this.activeModal=t,this.modal=i,this.layoutService=o,this.moduleService=l}ngOnInit(){this.entities=this.layoutService.getLayouts().map(t=>({name:t.name,modules:t.config.map(i=>({count:i.count,module:this.moduleService.getEntity(i.moduleId)}))}))}getModules(t){let i=!1,o=t.modules;return o.length>3&&(o=o.slice(0,3),i=!0),o.map(l=>l.count+" x "+(null==l.module?"":l.module.name)).join(", ")+(i?"...":"")}loadLayout(t,i){t.preventDefault(),t.stopPropagation(),this.activeModal.close({layoutName:i.name,type:Pe.load})}addLayout(t,i){t.preventDefault(),t.stopPropagation(),this.activeModal.close({layoutName:i.name,type:Pe.add})}deleteLayout(t,i){t.preventDefault(),t.stopPropagation();const o=this.modal.open(sn);o.componentInstance.title="Confirm Delete",o.componentInstance.message=`Are you sure you want to delete <strong>${i.name}</strong>?`,o.result.then(l=>{l&&(this.layoutService.deleteLayout(i.name),this.ngOnInit())})}static#e=this.\u0275fac=function(i){return new(i||r)(e.Y36(Oe.Kz),e.Y36(Oe.FF),e.Y36(Ke),e.Y36(je.C))};static#t=this.\u0275cmp=e.Xpm({type:r,selectors:[["ng-component"]],features:[e.qOj],decls:12,vars:1,consts:function(){let t,i,o,l,f;return t="\u8BFB\u53D6\u6A21\u677F",i="\u53D6\u6D88",o="\u8BFB\u53D6\u6A21\u677F",l="\u6DFB\u52A0\u6A21\u5757",f="\u5220\u9664",[[1,"modal-header"],[1,"modal-title"],t,["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[1,"list-group"],["class","list-group-item list-group-item-action",3,"click",4,"ngFor","ngForOf"],[1,"modal-footer"],["type","button",1,"btn","btn-secondary",3,"click"],i,[1,"list-group-item","list-group-item-action",3,"click"],[1,"float-right","small"],[1,"hover","text-primary",3,"click"],o,[1,"hover","text-secondary",3,"click"],l,[1,"hover","text-danger",3,"click"],f,[1,"small"]]},template:function(i,o){1&i&&(e.TgZ(0,"div",0)(1,"h4",1),e.SDv(2,2),e.qZA(),e.TgZ(3,"button",3),e.NdJ("click",function(){return o.activeModal.close()}),e.TgZ(4,"span",4),e._uU(5,"\xd7"),e.qZA()()(),e.TgZ(6,"div",5)(7,"div",6),e.YNc(8,_i,15,2,"a",7),e.qZA()(),e.TgZ(9,"div",8)(10,"button",9),e.NdJ("click",function(){return o.activeModal.close()}),e.SDv(11,10),e.qZA()()),2&i&&(e.xp6(8),e.Q6J("ngForOf",o.entities))},dependencies:[O.sg],encapsulation:2})}return r})(),fi=(()=>{class r{constructor(t,i,o){this.activeModal=t,this.modal=i,this.layoutService=o}canSave(){return this.name}saveLayout(){if(this.layoutService.getLayout(this.name)){const i=this.modal.open(sn);i.componentInstance.title="Confirm Save",i.componentInstance.message=`<strong>${this.name}</strong> already exists. Confirm overwrite?`,i.result.then(o=>{o&&this.activeModal.close(this.name)})}else this.activeModal.close(this.name)}static#e=this.\u0275fac=function(i){return new(i||r)(e.Y36(Oe.Kz),e.Y36(Oe.FF),e.Y36(Ke))};static#t=this.\u0275cmp=e.Xpm({type:r,selectors:[["ng-component"]],decls:14,vars:2,consts:function(){let t,i,o;return t="\u4FDD\u5B58\u6A21\u677F",i="\u4FDD\u5B58",o="\u53D6\u6D88",[[1,"modal-header"],[1,"modal-title"],t,["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[1,"form-group"],[1,"form-control",3,"ngModel","ngModelChange"],[1,"modal-footer"],["type","button",1,"btn","btn-success",3,"disabled","click"],i,["type","button",1,"btn","btn-secondary",3,"click"],o]},template:function(i,o){1&i&&(e.TgZ(0,"div",0)(1,"h4",1),e.SDv(2,2),e.qZA(),e.TgZ(3,"button",3),e.NdJ("click",function(){return o.activeModal.close()}),e.TgZ(4,"span",4),e._uU(5,"\xd7"),e.qZA()()(),e.TgZ(6,"div",5)(7,"div",6)(8,"input",7),e.NdJ("ngModelChange",function(f){return o.name=f}),e.qZA()()(),e.TgZ(9,"div",8)(10,"button",9),e.NdJ("click",function(){return o.saveLayout()}),e.SDv(11,10),e.qZA(),e.TgZ(12,"button",11),e.NdJ("click",function(){return o.activeModal.close()}),e.SDv(13,12),e.qZA()()),2&i&&(e.xp6(8),e.Q6J("ngModel",o.name),e.xp6(2),e.Q6J("disabled",!o.canSave()))},dependencies:[pe.Fj,pe.JJ,pe.On],encapsulation:2})}return r})(),pi=(()=>{class r{constructor(t){this.activeModal=t}copy(t){t.select(),document.execCommand("copy")}static#e=this.\u0275fac=function(i){return new(i||r)(e.Y36(Oe.Kz))};static#t=this.\u0275cmp=e.Xpm({type:r,selectors:[["app-share-layout"]],inputs:{url:"url"},decls:16,vars:1,consts:function(){let t,i,o;return t="\u5206\u4EAB\u6A21\u677F",i="\u590D\u5236",o="\u786E\u5B9A",[[1,"modal-header"],[1,"modal-title"],t,["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[1,"input-group"],["readonly","",1,"form-control",3,"value"],["urlInput",""],[1,"input-group-append"],["type","button",1,"btn","btn-sm","btn-outline-secondary",3,"click"],i,[1,"modal-footer"],["type","button",1,"btn","btn-success",3,"click"],o]},template:function(i,o){if(1&i){const l=e.EpF();e.TgZ(0,"div",0)(1,"h4",1),e.SDv(2,2),e.qZA(),e.TgZ(3,"button",3),e.NdJ("click",function(){return o.activeModal.dismiss()}),e.TgZ(4,"span",4),e._uU(5,"\xd7"),e.qZA()()(),e.TgZ(6,"div",5)(7,"div",6),e._UZ(8,"input",7,8),e.TgZ(10,"div",9)(11,"button",10),e.NdJ("click",function(){e.CHM(l);const S=e.MAs(9);return e.KtG(o.copy(S))}),e.SDv(12,11),e.qZA()()()(),e.TgZ(13,"div",12)(14,"button",13),e.NdJ("click",function(){return o.activeModal.close()}),e.SDv(15,14),e.qZA()()}2&i&&(e.xp6(8),e.Q6J("value",o.url))},encapsulation:2})}return r})();var Ae=R(973);let Et=(()=>{class r{static#e=this.default="default";static#t=this.argon="argon";static#n=this.teladi="teladi";static#i=this.paranid="paranid";static#r=this.recycling="recycling"}return r})();var Fe=R(4941),Ee=R(7946);const yt={argon:{race:Fe.I.argon,amount:200,consumption:[{ware:Ee.H.foodrations,amount:450},{ware:Ee.H.medicalsupplies,amount:270}]},teladi:{race:Fe.I.teladi,amount:200,consumption:[{ware:Ee.H.nostropoil,amount:228},{ware:Ee.H.medicalsupplies,amount:270}]},paranid:{race:Fe.I.paranid,amount:200,consumption:[{ware:Ee.H.sojahusk,amount:288},{ware:Ee.H.medicalsupplies,amount:270}]},split:{race:Fe.I.split,amount:200,consumption:[{ware:Ee.H.cheltmeat,amount:102},{ware:Ee.H.scruffinfruits,amount:138},{ware:Ee.H.medicalsupplies,amount:270}]},terran:{race:Fe.I.terran,amount:200,consumption:[{ware:Ee.H.terranmre,amount:258},{ware:Ee.H.medicalsupplies,amount:270}]},boron:{race:Fe.I.boron,amount:200,consumption:[{ware:Ee.H.bofu,amount:90},{ware:Ee.H.medicalsupplies,amount:198},{ware:Ee.H.water,amount:162}]},get:r=>yt[r]||yt.argon};var gi=R(5730);const an=["module_gen_prod_scrap_recycler","module_ter_prod_scrap_recycler"];class We{constructor(n,t,i="",o=1){this.wareService=n,this.moduleService=t,this.moduleId=i,this.count=o}get moduleId(){return this._moduleId}set moduleId(n){n!=this._moduleId&&(this._moduleId=n,this.update())}get count(){return this._count}set count(n){n!=this._count&&(this._count=n,this.update())}update(){if(this._moduleId){if(this.module=this.moduleService.getEntity(this.moduleId),this.needs=[],this.production=[],this.module.type==Ae.J.production){const n=this.module.product;for(let t of n){let i=null;an.includes(this.module.id)&&(i=t.production.find(l=>l.method==Et.recycling)),null==i&&(i=null==this.module.makerRace?t.production.find(l=>l.method==Et.default):t.production.find(l=>l.method==this.module.makerRace.id)||t.production.find(l=>l.method==Et.default));const o=3600/i.time;this.production.push({amount:i.amount*o,ware:t,value:i}),i.wares.forEach(l=>{const f=this.wareService.getEntity(l.ware);this.needs.push({amount:l.amount*o,ware:f})})}}else if(this.module.type==Ae.J.habitation){const n=this.module.workForce.capacity,t=yt.get(this.module.workForce.race.id);t.consumption.forEach(i=>{this.needs.push({amount:i.amount*n/t.amount,ware:i.ware})})}}else this.module=null,this.production=null,this.needs=[]}}class vt{static calculateWorkforce(n){return{value:n.reduce((o,l)=>l.module&&l.module.workForce&&l.module.workForce.max?o+l.count*l.module.workForce.max:o,0),capacity:n.reduce((o,l)=>l.module&&l.module.workForce&&l.module.workForce.capacity?o+l.count*l.module.workForce.capacity:o,0)}}static calculate(n,t,i){let o=this.calculateWorkforce(n),l=0==o.capacity||0==o.value?0:i/o.value;l>1&&(l=1);let f={};n.length>0&&(f=n.map(v=>{let x=1;if("Habitation"===v.module?.type){let V=v.module.workForce.capacity*v.count;i>=V?i-=V:(x=i/V,i=0)}const G=v.needs.map(V=>({ware:V.ware,count:v.count,amount:-V.amount,efficiency:100*x,name:v.module.name,total:v.count*-V.amount*x,type:v.module.type}));if(v.production)for(let V of v.production){const oe=V.value.effects?V.value.effects.find(de=>de.type==gi.z.work):null;let Se=null==oe?1:1+oe.product*l;if(V.ware.id===Ee.H.energycells.id){let de=parseInt(t);(isNaN(de)||de<0)&&(de=100),Se=Se*de/100}G.push({ware:V.ware,count:v.count,amount:V.amount,efficiency:100*Se,name:v.module.name,total:v.count*V.amount*Se,type:v.module.type})}return G}).reduce((v,x)=>v.concat(x)).reduce(function(v,x){return v[x.ware.id]=v[x.ware.id]||[],v[x.ware.id].push(x),v},{}));const S=[];for(const v in f)if(f.hasOwnProperty(v)){const x=f[v];let G=0;x.forEach(V=>{G+=V.total}),S.push({ware:x[0].ware,amount:G,items:x})}return S}}var At=R(1667),Ue=(()=>{return(r=Ue||(Ue={}))[r.expense=0]="expense",r[r.product=1]="product",Ue;var r})();class mi{constructor(n,t,i,o,l){this.item=n,this.component=t,this.minPrice=i,this.maxPrice=o,this.items=l}get module(){return this.item.module}get count(){return this.item.count}get price(){return this.item.count*(this.minPrice+(this.maxPrice-this.minPrice)*this.component.modulesResourcesPrice/100)}}class Ti{constructor(n,t,i){this.ware=n,this.amount=t,this.component=i}get price(){return this.amount*(this.ware.price.min+(this.ware.price.max-this.ware.price.min)*this.component.modulesResourcesPrice/100)}}class ln{constructor(n,t,i,o=null){this.model=n,this.pricePercentage=t,this.priceType=i,this.warePrice=o}get name(){return this.model.ware.name}get amount(){return this.model.amount}get price(){return null!=this.warePrice?0:this.model.ware.price.min+(this.model.ware.price.max-this.model.ware.price.min)*(this.priceType==Ue.expense?this.pricePercentage.resourcesPrice:this.pricePercentage.productsPrice)/100}}var it=R(2459);let Nt=(()=>{class r{constructor(){this.partialWorkforceChanged=new F.x,this.partialWorkforce=0}setPartialWorkforce(t){this.partialWorkforce=t,this.partialWorkforceChanged.next(this.partialWorkforce)}get $partialWorkforce(){return this.partialWorkforce}static#e=this.\u0275fac=function(i){return new(i||r)};static#t=this.\u0275prov=e.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();function Si(r,n){1&r&&e._UZ(0,"i",60)}function Ci(r,n){1&r&&e._UZ(0,"i",61)}function Ei(r,n){if(1&r&&(e.TgZ(0,"tr",64)(1,"td",65),e._uU(2),e.qZA(),e.TgZ(3,"td",10),e._uU(4),e.ALo(5,"number"),e.qZA()()),2&r){const t=n.$implicit;e.xp6(2),e.AsE("",t.count," x ",t.name,""),e.xp6(2),e.hij("-",e.xi3(5,3,t.amount*t.count,"1.0-0"),"")}}function yi(r,n){1&r&&(e.TgZ(0,"tr",64)(1,"td",65),e._uU(2," 1 x Unknown Module "),e.qZA(),e.TgZ(3,"td",10),e._uU(4,"-200"),e.qZA()())}function vi(r,n){if(1&r&&(e.ynx(0),e.YNc(1,Ei,6,6,"tr",62),e.YNc(2,yi,5,0,"tr",63),e.BQk()),2&r){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.workforceNeeded),e.xp6(1),e.Q6J("ngIf",t.isHq)}}function Ai(r,n){1&r&&e._UZ(0,"i",60)}function Ni(r,n){1&r&&e._UZ(0,"i",61)}function Mi(r,n){if(1&r&&(e.TgZ(0,"tr",35)(1,"td",65),e._uU(2),e.qZA(),e.TgZ(3,"td",10),e._uU(4),e.ALo(5,"number"),e.qZA()()),2&r){const t=n.$implicit;e.xp6(2),e.AsE("",t.count," x ",t.name,""),e.xp6(2),e.hij("+",e.xi3(5,3,t.amount*t.count,"1.0-0"),"")}}function Oi(r,n){if(1&r&&(e.ynx(0),e.YNc(1,Mi,6,6,"tr",66),e.BQk()),2&r){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.workforceCapacity)}}function Ii(r,n){1&r&&e._UZ(0,"i",60)}function wi(r,n){1&r&&e._UZ(0,"i",61)}const bi=function(r,n){return{"text-danger":r,"text-warning":n}};function Ri(r,n){if(1&r&&(e.TgZ(0,"tr",8)(1,"td",68),e._uU(2),e.ALo(3,"number"),e.qZA(),e.TgZ(4,"td",10),e._uU(5),e.ALo(6,"number"),e.qZA()()),2&r){const t=n.$implicit;e.Q6J("ngClass",e.WLB(10,bi,t.price>0,0==t.price)),e.xp6(2),e.AsE("",e.xi3(3,4,t.amount,"1.0-0")," x ",t.name,""),e.xp6(3),e.hij(" ",e.xi3(6,7,t.amount*t.price,"1.0-0")," ")}}function xi(r,n){if(1&r&&(e.ynx(0),e.YNc(1,Ri,7,13,"tr",67),e.BQk()),2&r){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.resourcesNeeded)}}function Pi(r,n){1&r&&e._UZ(0,"i",60)}function Di(r,n){1&r&&e._UZ(0,"i",61)}function ki(r,n){if(1&r&&(e.TgZ(0,"tr",70)(1,"td",68),e._uU(2),e.ALo(3,"number"),e.qZA(),e.TgZ(4,"td",10),e._uU(5),e.ALo(6,"number"),e.qZA()()),2&r){const t=n.$implicit;e.xp6(2),e.AsE("",e.xi3(3,3,t.amount,"1.0-0")," x ",t.name,""),e.xp6(3),e.hij("+",e.xi3(6,6,t.amount*t.price,"1.0-0"),"")}}function Li(r,n){if(1&r&&(e.ynx(0),e.YNc(1,ki,7,9,"tr",69),e.BQk()),2&r){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.resourcesProduced)}}function Fi(r,n){1&r&&(e.ynx(0),e.TgZ(1,"span"),e.SDv(2,71),e.qZA(),e.BQk())}function Ui(r,n){1&r&&(e.ynx(0),e.TgZ(1,"span"),e.SDv(2,72),e.qZA(),e.BQk())}function Zi(r,n){1&r&&(e.ynx(0),e.TgZ(1,"span"),e.SDv(2,73),e.qZA(),e.BQk())}function Bi(r,n){if(1&r&&(e.ynx(0),e._uU(1),e.BQk()),2&r){const t=e.oxw();e.xp6(1),e.hij("",t.resourcesPrice,"%")}}function $i(r,n){1&r&&(e.ynx(0),e.TgZ(1,"span"),e.SDv(2,74),e.qZA(),e.BQk())}function Yi(r,n){1&r&&(e.ynx(0),e.TgZ(1,"span"),e.SDv(2,75),e.qZA(),e.BQk())}function Gi(r,n){1&r&&(e.ynx(0),e.TgZ(1,"span"),e.SDv(2,76),e.qZA(),e.BQk())}function Vi(r,n){if(1&r&&(e.ynx(0),e._uU(1),e.BQk()),2&r){const t=e.oxw();e.xp6(1),e.hij("",t.productsPrice,"%")}}function zi(r,n){1&r&&e._UZ(0,"i",60)}function Hi(r,n){1&r&&e._UZ(0,"i",61)}function ji(r,n){if(1&r&&(e.TgZ(0,"tr")(1,"td",68),e._uU(2),e.qZA(),e.TgZ(3,"td",10),e._uU(4),e.ALo(5,"number"),e.qZA()()),2&r){const t=n.$implicit,i=e.oxw(2).$implicit;e.xp6(2),e.AsE("",i.count*t.amount," x ",t.ware.name,""),e.xp6(2),e.hij(" ",e.xi3(5,3,i.count*t.price,"1.0-0")," ")}}function Ki(r,n){if(1&r&&(e.ynx(0),e.YNc(1,ji,6,6,"tr",55),e.BQk()),2&r){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("ngForOf",t.items)}}function Wi(r,n){if(1&r){const t=e.EpF();e.ynx(0),e.TgZ(1,"tr",5),e.NdJ("click",function(){const l=e.CHM(t).$implicit,f=e.oxw();return e.KtG(f.toggleExpanded(l.module.id))}),e.TgZ(2,"td"),e.YNc(3,zi,1,0,"i",6),e.YNc(4,Hi,1,0,"i",7),e._uU(5),e.qZA(),e.TgZ(6,"td",10),e._uU(7),e.ALo(8,"number"),e.qZA()(),e.YNc(9,Ki,2,1,"ng-container",11),e.BQk()}if(2&r){const t=n.$implicit,i=e.oxw();e.xp6(3),e.Q6J("ngIf",!i.expandState[t.module.id]),e.xp6(1),e.Q6J("ngIf",i.expandState[t.module.id]),e.xp6(1),e.AsE(" ",t.count," x ",t.module.name," "),e.xp6(2),e.hij(" ",e.xi3(8,6,t.price,"1.0-0")," "),e.xp6(2),e.Q6J("ngIf",i.expandState[t.module.id])}}function qi(r,n){if(1&r&&(e.TgZ(0,"tr")(1,"td",10),e._uU(2),e.qZA(),e.TgZ(3,"td",10),e._uU(4),e.ALo(5,"number"),e.qZA()()),2&r){const t=n.$implicit;e.xp6(2),e.Oqu(t.ware.name),e.xp6(2),e.Oqu(e.xi3(5,2,t.value,"1.0-0"))}}function Xi(r,n){1&r&&(e.ynx(0),e.TgZ(1,"span"),e.SDv(2,77),e.qZA(),e.BQk())}function Ji(r,n){1&r&&(e.ynx(0),e.TgZ(1,"span"),e.SDv(2,78),e.qZA(),e.BQk())}function Qi(r,n){1&r&&(e.ynx(0),e.TgZ(1,"span"),e.SDv(2,79),e.qZA(),e.BQk())}function er(r,n){if(1&r&&(e.ynx(0),e._uU(1),e.BQk()),2&r){const t=e.oxw();e.xp6(1),e.hij("",t.modulesResourcesPrice,"%")}}const cn=function(r,n){return{"text-danger":r,"text-success":n}};class Ze{static#e=this.basicResources=[At.B.gases,At.B.minerals,At.B.ice];constructor(n,t){this.wareService=n,this.stationSummaryService=t,this.expandState={},this.provideBasicResources=!1,this.provideAllResources=!1,this.isHq=!1,this.resourcesPrice=50,this.productsPrice=50,this.modulesResourcesPrice=50,this._totalWorkforce=0,this.totalWorkforceCapacity=0,this.partialWorkforce=0,this.autoWorkforce=!0,this.workforceNeeded=[],this.workforceCapacity=[],this.resourcesNeeded=[],this.resourcesProduced=[],this.totalModuleResourceCosts=[],this.change=new e.vpe,this.sunlight=100}ngOnChanges(){this.update()}get totalWorkforce(){return this._totalWorkforce+(this.isHq?200:0)}onChange(){this.update(),this.change.emit()}update(){if(this._totalWorkforce=0,this.workforceNeeded=[],this.workforceCapacity=[],this.resourcesNeeded=[],this.resourcesProduced=[],this.moduleCosts=[],null==this.modules)return;this.modules.forEach(o=>{if(null!=o.module&&null!=o.module.workForce&&(null!=o.module.workForce.max&&(this._totalWorkforce+=o.count*o.module.workForce.max,this.workforceNeeded.push({amount:o.module.workForce.max,name:o.module.name,count:o.count})),null!=o.module.workForce.capacity&&this.workforceCapacity.push({amount:o.module.workForce.capacity,name:o.module.name,count:o.count})),null!=o.module){const l=this.getModuleCost(o);null!=l&&this.moduleCosts.push(l)}});const n=this.modules.reduce((o,l)=>l.module&&l.module.workForce&&l.module.workForce.capacity?o+l.count*l.module.workForce.capacity:o,0),t=this.modules.reduce((o,l)=>l.module&&l.module.workForce&&l.module.workForce.max?o+l.count*l.module.workForce.max:o,0);this.totalWorkforceCapacity=n,this.autoWorkforce?this.partialWorkforce=t>n?n:t:this.partialWorkforce>n&&(this.partialWorkforce=n),this.stationSummaryService.setPartialWorkforce(this.partialWorkforce);const i=vt.calculate(this.modules,this.sunlight,this.partialWorkforce);i.sort((o,l)=>this.wareService.compareWares(o.ware,l.ware)),i.forEach(o=>{if(o.amount<0){let l=null;(this.provideAllResources||this.provideBasicResources&&Ze.basicResources.indexOf(o.ware.group)>=0)&&(l=0);const f=new ln(o,this,Ue.expense,l);this.resourcesNeeded.push(f)}else if(o.amount>0){const l=new ln(o,this,Ue.product);this.resourcesProduced.push(l)}}),this.totalModuleResourceCosts=[],this.moduleCosts.forEach(o=>{o.items.forEach(l=>{let f=this.totalModuleResourceCosts.find(S=>S.ware.id==l.ware.id);null==f?(f={ware:l.ware,value:o.count*l.amount},this.totalModuleResourceCosts.push(f)):f.value+=o.count*l.amount})})}get workforceStep(){return 0===this.totalWorkforceCapacity?1:this.totalWorkforceCapacity/20}get workforcePercent(){return 0===this.totalWorkforceCapacity?"0%":Math.round(100*this.partialWorkforce/this.totalWorkforceCapacity)+"%"}get totalExpenses(){let n=0;return this.resourcesNeeded.forEach(t=>{n+=t.amount*t.price}),n}get totalProfits(){let n=0;return this.resourcesProduced.forEach(t=>{n+=t.amount*t.price}),n}get totalModuleCost(){let n=0;return this.moduleCosts.forEach(t=>{n+=t.price}),n}getModuleCost(n){const t=n.module.production[0];if(!t)return null;let i=0,o=0;const l=[];return t.wares.forEach(f=>{const S=this.wareService.getEntity(f.ware);i+=S.price.min*f.amount,o+=S.price.max*f.amount,l.push(new Ti(S,f.amount,this))}),new mi(n,this,i,o,l)}toggleExpanded(n){this.expandState[n]=!this.expandState[n]}static#t=this.\u0275fac=function(t){return new(t||Ze)(e.Y36(it.l),e.Y36(Nt))};static#n=this.\u0275cmp=e.Xpm({type:Ze,selectors:[["app-station-summary"]],inputs:{modules:"modules",sunlight:"sunlight"},outputs:{change:"change"},features:[e.TTD],decls:161,vars:74,consts:function(){let n,t,i,o,l,f,S,v,x,G,V,oe,Se,de,Ie,ye,rt,qe,Be,Xe,un,dn,_n,hn,fn,pn,gn,mn,Tn;return n="\u52B3\u52A8\u529B\u6D88\u8017",t="\u503C",i="\u52B3\u52A8\u529B\u6D88\u8017\u91CF",o="\u52B3\u52A8\u529B\u50A8\u5907\u91CF",l="\u603B\u90E8 (\u603B\u90E8\u7531\u4E8E\u67D0\u79CD\u539F\u56E0\u9700\u8981200\u4E2A\u5DE5\u4EBA)",f="\u5B9E\u9645\u52B3\u52A8\u529B:",S="\u81EA\u52A8",v="\u6BCF\u5C0F\u65F6\u4EA7\u54C1\u751F\u4EA7\u91CF",x="\u6570\u91CF",G="\u82B1\u8D39",V="\u4EA7\u54C1",oe="\u5229\u6DA6",Se="\u7531\u77FF\u5DE5\u63D0\u4F9B\u57FA\u672C\u8D44\u6E90",de="\u8D44\u6E90\u7531\u5176\u4ED6\u7A7A\u95F4\u7AD9\u63D0\u4F9B",Ie="\u8D44\u6E90\u5B9A\u4EF7:",ye="\u4EA7\u54C1\u5B9A\u4EF7:",rt="\u7A7A\u95F4\u7AD9\u82B1\u8D39",qe="\u6570\u91CF",Be="\u5408\u8BA1:",Xe="\u8D44\u6E90\u5B9A\u4EF7:",un="\u6700\u5C0F\u503C",dn="\u5E73\u5747\u503C",_n="\u6700\u5927\u503C",hn="\u6700\u5C0F\u503C",fn="\u5E73\u5747\u503C",pn="\u6700\u5927\u503C",gn="\u6700\u5C0F\u503C",mn="\u5E73\u5747\u503C",Tn="\u6700\u5927\u503C",[[1,"table","table-sm","small","table-hover"],["scope","col"],n,["scope","col",1,"text-right"],t,[1,"hover",3,"click"],["class","fa fa-angle-double-down",4,"ngIf"],["class","fa fa-angle-double-up",4,"ngIf"],[3,"ngClass"],i,[1,"text-right"],[4,"ngIf"],o,["colspan","2"],[1,"form-check"],["type","checkbox","id","is-hq",1,"form-check-input",3,"ngModel","ngModelChange"],["for","is-hq",1,"form-check-label"],l,[1,"row"],[1,"form-group","col"],["for","workforce-slider"],f,[1,"d-flex","flex-row"],[1,"flex-grow-1"],["type","range","id","workforce-slider","min","0",1,"form-control-range","small",3,"disabled","max","ngModel","ngModelChange"],[1,"ml-1"],["type","checkbox","id","auto-workforce-check-box",1,"form-check-input",3,"ngModel","ngModelChange"],["for","auto-workforce-check-box",1,"form-check-label"],S,v,x,[1,"hover","text-danger",3,"click"],G,[1,"hover","text-primary",3,"click"],V,[1,"text-success"],[1,"fa","fa-line-chart"],oe,["type","checkbox","id","basic-resources",1,"form-check-input",3,"ngModel","ngModelChange"],["for","basic-resources",1,"form-check-label"],Se,["type","checkbox","id","all-resources",1,"form-check-input",3,"ngModel","ngModelChange"],["for","all-resources",1,"form-check-label"],de,["for","resources-price"],Ie,[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],["type","range","id","resources-price","min","0","max","100","step","5",1,"form-control-range","small",3,"ngModel","ngModelChange"],["for","products-price"],ye,["type","range","id","products-price","min","0","max","100","step","5",1,"form-control-range","small",3,"ngModel","ngModelChange"],rt,qe,[4,"ngFor","ngForOf"],Be,["for","modules-resources-price"],Xe,["type","range","id","modules-resources-price","min","0","max","100","step","5",1,"form-control-range","small",3,"ngModel","ngModelChange"],[1,"fa","fa-angle-double-down"],[1,"fa","fa-angle-double-up"],["class","text-danger",4,"ngFor","ngForOf"],["class","text-danger",4,"ngIf"],[1,"text-danger"],[1,"pl-4"],["class","text-success",4,"ngFor","ngForOf"],[3,"ngClass",4,"ngFor","ngForOf"],[1,"pl-5"],["class","text-primary",4,"ngFor","ngForOf"],[1,"text-primary"],un,dn,_n,hn,fn,pn,gn,mn,Tn]},template:function(t,i){1&t&&(e.TgZ(0,"table",0)(1,"thead")(2,"tr")(3,"th",1),e.SDv(4,2),e.qZA(),e.TgZ(5,"th",3),e.SDv(6,4),e.qZA()()(),e.TgZ(7,"tbody")(8,"tr",5),e.NdJ("click",function(){return i.toggleExpanded("totalWorkforce")}),e.TgZ(9,"td"),e.YNc(10,Si,1,0,"i",6),e.YNc(11,Ci,1,0,"i",7),e.TgZ(12,"span",8),e.SDv(13,9),e.qZA()(),e.TgZ(14,"td",10),e._uU(15),e.ALo(16,"number"),e.qZA()(),e.YNc(17,vi,3,2,"ng-container",11),e.TgZ(18,"tr",5),e.NdJ("click",function(){return i.toggleExpanded("totalWorkforceCapacity")}),e.TgZ(19,"td"),e.YNc(20,Ai,1,0,"i",6),e.YNc(21,Ni,1,0,"i",7),e.TgZ(22,"span",8),e.SDv(23,12),e.qZA()(),e.TgZ(24,"td",10),e._uU(25),e.ALo(26,"number"),e.qZA()(),e.YNc(27,Oi,2,1,"ng-container",11),e.TgZ(28,"tr")(29,"td",13)(30,"div",14)(31,"input",15),e.NdJ("ngModelChange",function(l){return i.isHq=l})("ngModelChange",function(){return i.onChange()}),e.qZA(),e.TgZ(32,"label",16),e.SDv(33,17),e.qZA()()()(),e.TgZ(34,"tr")(35,"td",13)(36,"div",18)(37,"div",19)(38,"label",20)(39,"span"),e.SDv(40,21),e.qZA(),e._uU(41,"\xa0"),e.TgZ(42,"strong"),e._uU(43),e.ALo(44,"number"),e.qZA()(),e.TgZ(45,"div",22)(46,"div",23)(47,"input",24),e.NdJ("ngModelChange",function(l){return i.partialWorkforce=l})("ngModelChange",function(){return i.onChange()}),e.qZA()(),e.TgZ(48,"div",25),e._uU(49),e.qZA()(),e.TgZ(50,"div",14)(51,"input",26),e.NdJ("ngModelChange",function(l){return i.autoWorkforce=l})("ngModelChange",function(){return i.onChange()}),e.qZA(),e.TgZ(52,"label",27),e.SDv(53,28),e.qZA()()()()()()()(),e.TgZ(54,"table",0)(55,"thead")(56,"tr")(57,"th",1),e.SDv(58,29),e.qZA(),e.TgZ(59,"th",3),e.SDv(60,30),e.qZA()()(),e.TgZ(61,"tbody")(62,"tr",31),e.NdJ("click",function(){return i.toggleExpanded("totalExpenses")}),e.TgZ(63,"td"),e.YNc(64,Ii,1,0,"i",6),e.YNc(65,wi,1,0,"i",7),e.TgZ(66,"span"),e.SDv(67,32),e.qZA()(),e.TgZ(68,"td",10),e._uU(69),e.ALo(70,"number"),e.qZA()(),e.YNc(71,xi,2,1,"ng-container",11),e.TgZ(72,"tr",33),e.NdJ("click",function(){return i.toggleExpanded("totalProfits")}),e.TgZ(73,"td"),e.YNc(74,Pi,1,0,"i",6),e.YNc(75,Di,1,0,"i",7),e.TgZ(76,"span"),e.SDv(77,34),e.qZA()(),e.TgZ(78,"td",10),e._uU(79),e.ALo(80,"number"),e.qZA()(),e.YNc(81,Li,2,1,"ng-container",11),e.TgZ(82,"tr",35)(83,"td"),e._UZ(84,"i",36),e.TgZ(85,"strong"),e.SDv(86,37),e.qZA()(),e.TgZ(87,"td",10)(88,"strong"),e._uU(89),e.ALo(90,"number"),e.qZA()()(),e.TgZ(91,"tr")(92,"td",13)(93,"div",14)(94,"input",38),e.NdJ("ngModelChange",function(l){return i.provideBasicResources=l})("ngModelChange",function(){return i.onChange()}),e.qZA(),e.TgZ(95,"label",39),e.SDv(96,40),e.qZA()()()(),e.TgZ(97,"tr")(98,"td",13)(99,"div",14)(100,"input",41),e.NdJ("ngModelChange",function(l){return i.provideAllResources=l})("ngModelChange",function(){return i.onChange()}),e.qZA(),e.TgZ(101,"label",42),e.SDv(102,43),e.qZA()()()(),e.TgZ(103,"tr")(104,"td",13)(105,"div",18)(106,"div",19)(107,"label",44)(108,"span"),e.SDv(109,45),e.qZA(),e._uU(110,"\xa0 "),e.TgZ(111,"strong",46),e.YNc(112,Fi,3,0,"ng-container",47),e.YNc(113,Ui,3,0,"ng-container",47),e.YNc(114,Zi,3,0,"ng-container",47),e.YNc(115,Bi,2,1,"ng-container",48),e.qZA()(),e._UZ(116,"br"),e.TgZ(117,"input",49),e.NdJ("ngModelChange",function(l){return i.resourcesPrice=l})("ngModelChange",function(){return i.onChange()}),e.qZA()(),e.TgZ(118,"div",19)(119,"label",50)(120,"span"),e.SDv(121,51),e.qZA(),e._uU(122,"\xa0 "),e.TgZ(123,"strong",46),e.YNc(124,$i,3,0,"ng-container",47),e.YNc(125,Yi,3,0,"ng-container",47),e.YNc(126,Gi,3,0,"ng-container",47),e.YNc(127,Vi,2,1,"ng-container",48),e.qZA()(),e._UZ(128,"br"),e.TgZ(129,"input",52),e.NdJ("ngModelChange",function(l){return i.productsPrice=l})("ngModelChange",function(){return i.onChange()}),e.qZA()()()()()()(),e.TgZ(130,"table",0)(131,"thead")(132,"tr")(133,"th",1),e.SDv(134,53),e.qZA(),e.TgZ(135,"th",3),e.SDv(136,54),e.qZA()()(),e.TgZ(137,"tbody"),e.YNc(138,Wi,10,9,"ng-container",55),e.TgZ(139,"tr")(140,"th",10),e.SDv(141,56),e.qZA(),e.TgZ(142,"th",10),e._uU(143),e.ALo(144,"number"),e.qZA()(),e.YNc(145,qi,6,5,"tr",55),e.TgZ(146,"tr")(147,"td",13)(148,"div",18)(149,"div",19)(150,"label",57)(151,"span"),e.SDv(152,58),e.qZA(),e._uU(153,"\xa0 "),e.TgZ(154,"strong",46),e.YNc(155,Xi,3,0,"ng-container",47),e.YNc(156,Ji,3,0,"ng-container",47),e.YNc(157,Qi,3,0,"ng-container",47),e.YNc(158,er,2,1,"ng-container",48),e.qZA()(),e._UZ(159,"br"),e.TgZ(160,"input",59),e.NdJ("ngModelChange",function(l){return i.modulesResourcesPrice=l})("ngModelChange",function(){return i.onChange()}),e.qZA()()()()()()()),2&t&&(e.xp6(10),e.Q6J("ngIf",!i.expandState.totalWorkforce),e.xp6(1),e.Q6J("ngIf",i.expandState.totalWorkforce),e.xp6(1),e.Q6J("ngClass",e.WLB(68,cn,i.totalWorkforce>i.totalWorkforceCapacity,i.totalWorkforce<=i.totalWorkforceCapacity)),e.xp6(3),e.Oqu(e.xi3(16,47,i.totalWorkforce,"1.0-0")),e.xp6(2),e.Q6J("ngIf",i.expandState.totalWorkforce),e.xp6(3),e.Q6J("ngIf",!i.expandState.totalWorkforceCapacity),e.xp6(1),e.Q6J("ngIf",i.expandState.totalWorkforceCapacity),e.xp6(1),e.Q6J("ngClass",e.WLB(71,cn,i.totalWorkforce>i.totalWorkforceCapacity,i.totalWorkforce<=i.totalWorkforceCapacity)),e.xp6(3),e.hij(" ",e.xi3(26,50,i.totalWorkforceCapacity,"1.0-0")," "),e.xp6(2),e.Q6J("ngIf",i.expandState.totalWorkforceCapacity),e.xp6(4),e.Q6J("ngModel",i.isHq),e.xp6(12),e.Oqu(e.xi3(44,53,i.partialWorkforce,"1.0-0")),e.xp6(4),e.Q6J("disabled",i.autoWorkforce)("max",i.totalWorkforceCapacity)("ngModel",i.partialWorkforce),e.uIk("step",i.workforceStep),e.xp6(2),e.hij(" ",i.workforcePercent," "),e.xp6(2),e.Q6J("ngModel",i.autoWorkforce),e.xp6(13),e.Q6J("ngIf",!i.expandState.totalExpenses),e.xp6(1),e.Q6J("ngIf",i.expandState.totalExpenses),e.xp6(4),e.Oqu(e.xi3(70,56,i.totalExpenses,"1.0-0")),e.xp6(2),e.Q6J("ngIf",i.expandState.totalExpenses),e.xp6(3),e.Q6J("ngIf",!i.expandState.totalProfits),e.xp6(1),e.Q6J("ngIf",i.expandState.totalProfits),e.xp6(4),e.Oqu(e.xi3(80,59,i.totalProfits,"1.0-0")),e.xp6(2),e.Q6J("ngIf",i.expandState.totalProfits),e.xp6(8),e.Oqu(e.xi3(90,62,i.totalProfits+i.totalExpenses,"1.0-0")),e.xp6(5),e.Q6J("ngModel",i.provideBasicResources),e.xp6(6),e.Q6J("ngModel",i.provideAllResources),e.xp6(11),e.Q6J("ngSwitch",i.resourcesPrice),e.xp6(1),e.Q6J("ngSwitchCase",0),e.xp6(1),e.Q6J("ngSwitchCase",50),e.xp6(1),e.Q6J("ngSwitchCase",100),e.xp6(3),e.Q6J("ngModel",i.resourcesPrice),e.xp6(6),e.Q6J("ngSwitch",i.productsPrice),e.xp6(1),e.Q6J("ngSwitchCase",0),e.xp6(1),e.Q6J("ngSwitchCase",50),e.xp6(1),e.Q6J("ngSwitchCase",100),e.xp6(3),e.Q6J("ngModel",i.productsPrice),e.xp6(9),e.Q6J("ngForOf",i.moduleCosts),e.xp6(5),e.Oqu(e.xi3(144,65,i.totalModuleCost,"1.0-0")),e.xp6(2),e.Q6J("ngForOf",i.totalModuleResourceCosts),e.xp6(9),e.Q6J("ngSwitch",i.modulesResourcesPrice),e.xp6(1),e.Q6J("ngSwitchCase",0),e.xp6(1),e.Q6J("ngSwitchCase",50),e.xp6(1),e.Q6J("ngSwitchCase",100),e.xp6(3),e.Q6J("ngModel",i.modulesResourcesPrice))},dependencies:[O.mk,O.sg,O.O5,O.RF,O.n9,O.ED,pe.Fj,pe.eT,pe.Wl,pe.JJ,pe.On,O.JJ],encapsulation:2})}var tr=R(617),nr=R(9220);let ir=(()=>{class r extends Ct.V{constructor(t,i,o){super(),this.activeModal=t,this.moduleService=i,this.layoutService=o}ngOnInit(){}importPlans(){let t,i=null;try{const o=nr.xml2js(this.xml,{compact:!0});t=this.importCore(o)}catch{i="Failed to import layouts"}this.activeModal.close({error:i,layouts:t})}importCore(t){const i=[];for(const o of t.plans.plan){if(null==o.entry||0===o.entry.length)continue;const l=o._attributes?.name||"Imported Plan",f=[];for(const v of o.entry){const[x]=this.moduleService.getModulesByMacro(v._attributes.macro);if(x){const G=f.find(V=>V.moduleId===x.id);G?G.count++:f.push({moduleId:x.id,count:1})}}this.layoutService.saveLayout({name:l,config:f}),i.push(l)}return i}get canImport(){return this.xml}static#e=this.\u0275fac=function(i){return new(i||r)(e.Y36(Oe.Kz),e.Y36(je.C),e.Y36(Ke))};static#t=this.\u0275cmp=e.Xpm({type:r,selectors:[["app-import-plans"]],features:[e.qOj],decls:20,vars:2,consts:function(){let t;return t="\u53D6\u6D88",[[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[1,"font-italic","text-info"],[1,"small","text-secondary"],["rows","10",1,"w-100","mt-2",3,"ngModel","ngModelChange"],[1,"modal-footer"],["type","button",1,"btn","btn-success",3,"disabled","click"],["type","button",1,"btn","btn-secondary",3,"click"],t]},template:function(i,o){1&i&&(e.TgZ(0,"div",0)(1,"h4",1),e._uU(2,"Import Plans"),e.qZA(),e.TgZ(3,"button",2),e.NdJ("click",function(){return o.activeModal.close()}),e.TgZ(4,"span",3),e._uU(5,"\xd7"),e.qZA()()(),e.TgZ(6,"div",4)(7,"div"),e._uU(8,"Paste the "),e.TgZ(9,"span",5),e._uU(10,"constructionplans.xml"),e.qZA(),e._uU(11," content below. The plans will be added to your saved layout list."),e.qZA(),e.TgZ(12,"div",6),e._uU(13,"File can be found in Documents\\Egosoft\\X4\\[12345678]\\constructionplans.xml"),e.qZA(),e.TgZ(14,"textarea",7),e.NdJ("ngModelChange",function(f){return o.xml=f}),e.qZA()(),e.TgZ(15,"div",8)(16,"button",9),e.NdJ("click",function(){return o.importPlans()}),e._uU(17,"Import"),e.qZA(),e.TgZ(18,"button",10),e.NdJ("click",function(){return o.activeModal.close()}),e.SDv(19,11),e.qZA()()),2&i&&(e.xp6(14),e.Q6J("ngModel",o.xml),e.xp6(2),e.Q6J("disabled",!o.canImport))},dependencies:[pe.Fj,pe.JJ,pe.On],encapsulation:2})}return r})();var rr=R(1481);function or(r,n){if(1&r){const t=e.EpF();e.TgZ(0,"div"),e._UZ(1,"span",2),e.TgZ(2,"button",3),e.NdJ("click",function(){const l=e.CHM(t).$implicit,f=e.oxw(2);return e.KtG(f.close(l))}),e.TgZ(3,"span",4),e._uU(4,"\xd7"),e.qZA()()()}if(2&r){const t=n.$implicit;e.Gre("alert alert-",t.type,""),e.xp6(1),e.Q6J("innerHTML",t.content,e.oJD)}}function sr(r,n){if(1&r&&(e.TgZ(0,"div"),e.YNc(1,or,5,4,"div",1),e.qZA()),2&r){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.messages)}}let ar=(()=>{class r{close(t){const i=this.messages.indexOf(t);i>=0&&this.messages.splice(i,1)}static#e=this.\u0275fac=function(i){return new(i||r)};static#t=this.\u0275cmp=e.Xpm({type:r,selectors:[["app-messages"]],inputs:{messages:"messages"},decls:1,vars:1,consts:[[4,"ngIf"],[3,"class",4,"ngFor","ngForOf"],[3,"innerHTML"],["type","button","data-dismiss","alert","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"]],template:function(i,o){1&i&&e.YNc(0,sr,2,1,"div",0),2&i&&e.Q6J("ngIf",o.messages&&o.messages.length)},dependencies:[O.sg,O.O5],encapsulation:2})}return r})();function lr(r,n){1&r&&e._UZ(0,"i",12)}function cr(r,n){1&r&&e._UZ(0,"i",13)}function ur(r,n){if(1&r&&(e.ynx(0),e.TgZ(1,"span"),e.SDv(2,17),e.qZA(),e._uU(3,"\xa0"),e.TgZ(4,"strong"),e._uU(5),e.ALo(6,"number"),e.qZA(),e._uU(7,"\xa0"),e.TgZ(8,"span"),e.SDv(9,18),e.qZA(),e.BQk()),2&r){const t=e.oxw().$implicit;e.xp6(5),e.hij("",e.xi3(6,1,t.efficiency,"1.0-0"),"%")}}function dr(r,n){if(1&r&&(e.ynx(0),e.TgZ(1,"span"),e.SDv(2,19),e.qZA(),e._uU(3,"\xa0"),e.TgZ(4,"strong"),e._uU(5),e.ALo(6,"number"),e.qZA(),e._uU(7,"\xa0"),e.TgZ(8,"span"),e.SDv(9,20),e.qZA(),e.BQk()),2&r){const t=e.oxw().$implicit;e.xp6(5),e.hij("",e.xi3(6,1,t.efficiency,"1.0-0"),"%")}}const Mt=function(r,n){return{"text-danger":r,"text-success":n}};function _r(r,n){if(1&r&&(e.TgZ(0,"tr",9)(1,"td",15)(2,"strong"),e._uU(3),e.qZA(),e._uU(4," x "),e.TgZ(5,"strong"),e._uU(6),e.qZA(),e.YNc(7,ur,10,4,"ng-container",11),e.YNc(8,dr,10,4,"ng-container",11),e.qZA(),e.TgZ(9,"td",16),e._uU(10),e.ALo(11,"number"),e.qZA()()),2&r){const t=n.$implicit;e.Q6J("ngClass",e.WLB(9,Mt,t.total<0,t.total>0)),e.xp6(3),e.Oqu(t.count),e.xp6(3),e.Oqu(t.name),e.xp6(1),e.Q6J("ngIf",t.total>0),e.xp6(1),e.Q6J("ngIf","Habitation"===t.type),e.xp6(2),e.Oqu(e.xi3(11,6,t.total,"1.0-0"))}}function hr(r,n){if(1&r&&(e.ynx(0),e.YNc(1,_r,12,12,"tr",14),e.BQk()),2&r){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("ngForOf",t.items)}}function fr(r,n){if(1&r){const t=e.EpF();e.ynx(0),e.TgZ(1,"tr",6),e.NdJ("click",function(){const l=e.CHM(t).$implicit,f=e.oxw();return e.KtG(f.toggleExpanded(l))}),e.TgZ(2,"td"),e.YNc(3,lr,1,0,"i",7),e.YNc(4,cr,1,0,"i",8),e.TgZ(5,"span",9),e._uU(6),e.qZA()(),e.TgZ(7,"td",10),e._uU(8),e.ALo(9,"number"),e.qZA()(),e.YNc(10,hr,2,1,"ng-container",11),e.BQk()}if(2&r){const t=n.$implicit;e.xp6(3),e.Q6J("ngIf",!t.expanded),e.xp6(1),e.Q6J("ngIf",t.expanded),e.xp6(1),e.Q6J("ngClass",e.WLB(10,Mt,t.amount<0,t.amount>0)),e.xp6(1),e.hij(" ",t.ware.name,""),e.xp6(1),e.Q6J("ngClass",e.WLB(13,Mt,t.amount<0,t.amount>0)),e.xp6(1),e.Oqu(e.xi3(9,7,t.amount,"1.0-0")),e.xp6(2),e.Q6J("ngIf",t.expanded)}}let pr=(()=>{class r{constructor(t,i){this.wareService=t,this.stationSummaryService=i,this.expandState={},this.totalWorkforce=0,this.totalWorkforceCapacity=0,this.partialWorkforce=0,this.resources=[],this.sunlight=100,this.workforceSubscription=this.stationSummaryService.partialWorkforceChanged.subscribe(o=>{this.partialWorkforce=o,this.update()})}ngOnChanges(){this.update()}ngOnInit(){}toggleExpanded(t){t.expanded=!t.expanded,this.expandState[t.ware.id]=t.expanded}update(){if(this.totalWorkforce=0,null==this.modules)return;this.totalWorkforce=this.modules.reduce((i,o)=>o.module&&o.module.workForce&&o.module.workForce.max?i+o.count*o.module.workForce.max:i,0);const t=this.modules.reduce((i,o)=>o.module&&o.module.workForce&&o.module.workForce.capacity?i+o.count*o.module.workForce.capacity:i,0);this.totalWorkforceCapacity!=t&&(this.totalWorkforceCapacity=t,this.partialWorkforce=t),this.resources=vt.calculate(this.modules,this.sunlight,this.partialWorkforce),this.resources.forEach(i=>{i.expanded=this.expandState[i.items[0].ware.id]}),this.resources.sort((i,o)=>this.wareService.compareWares(i.ware,o.ware))}ngOnDestroy(){this.workforceSubscription.unsubscribe()}static#e=this.\u0275fac=function(i){return new(i||r)(e.Y36(it.l),e.Y36(Nt))};static#t=this.\u0275cmp=e.Xpm({type:r,selectors:[["app-station-resources"]],inputs:{modules:"modules",sunlight:"sunlight"},features:[e.TTD],decls:9,vars:1,consts:function(){let t,i,o,l,f,S;return t="\u8D44\u6E90",i="\u6570\u91CF",o="\u4EE5",l="\u6548\u7387",f="\u4EE5",S="\u5BB9\u91CF",[[1,"table","table-sm","small"],["scope","col"],t,["scope","col",1,"text-right"],i,[4,"ngFor","ngForOf"],[1,"hover",3,"click"],["class","fa fa-angle-double-down",4,"ngIf"],["class","fa fa-angle-double-up",4,"ngIf"],[3,"ngClass"],[1,"text-right",3,"ngClass"],[4,"ngIf"],[1,"fa","fa-angle-double-down"],[1,"fa","fa-angle-double-up"],[3,"ngClass",4,"ngFor","ngForOf"],[1,"pl-4"],[1,"text-right"],o,l,f,S]},template:function(i,o){1&i&&(e.TgZ(0,"table",0)(1,"thead")(2,"tr")(3,"th",1),e.SDv(4,2),e.qZA(),e.TgZ(5,"th",3),e.SDv(6,4),e.qZA()()(),e.TgZ(7,"tbody"),e.YNc(8,fr,11,16,"ng-container",5),e.qZA()()),2&i&&(e.xp6(8),e.Q6J("ngForOf",o.resources))},dependencies:[O.mk,O.sg,O.O5,O.JJ],encapsulation:2})}return r})();function gr(r,n){if(1&r){const t=e.EpF();e.TgZ(0,"div",9),e.NdJ("click",function(){const l=e.CHM(t).$implicit,f=e.oxw(4);return e.KtG(f.onClick(l))}),e.TgZ(1,"label"),e._uU(2),e.qZA()()}if(2&r){const t=n.$implicit;e.xp6(2),e.Oqu(t.name)}}function mr(r,n){if(1&r&&(e.TgZ(0,"div",6)(1,"label",7)(2,"b"),e._uU(3),e.qZA()(),e.YNc(4,gr,3,1,"div",8),e.qZA()),2&r){const t=e.oxw().$implicit;e.xp6(3),e.Oqu(t.name),e.xp6(1),e.Q6J("ngForOf",t.modules)}}function Tr(r,n){if(1&r&&(e.ynx(0),e.YNc(1,mr,5,2,"div",5),e.BQk()),2&r){const t=n.$implicit;e.xp6(1),e.Q6J("ngIf",t.modules.length>0)}}function Sr(r,n){if(1&r){const t=e.EpF();e.TgZ(0,"div",3),e.NdJ("focus",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.onFocus())})("blur",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.onBlur())}),e.YNc(1,Tr,2,1,"ng-container",4),e.qZA()}if(2&r){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.filteredGroups)}}let Cr=(()=>{class r{constructor(){this.id=null,this.groups=[],this.filteredGroups=[],this.selectModule=new e.vpe,this.inputString="",this.visible=!1}ngOnInit(){this.filteredGroups=this.groups.map(t=>Object.assign({},t)),this.setName()}filterModules(t){for(let i=0;i<this.groups.length;i++)this.filteredGroups[i].modules=[...this.groups[i].modules.filter(o=>o.name.trim().toLowerCase().includes(t.trim().toLowerCase()))]}changed(t){t?this.filterModules(t):this.filteredGroups=this.groups.map(i=>Object.assign({},i))}onFocus(){clearTimeout(this.timeout),this.filterModules(this.inputString),this.visible=!0}onBlur(){this.timeout=setTimeout(()=>{this.setName(),this.visible=!1},100)}onClick(t){this.inputString=t.name,this.filterModules(this.inputString),this.selectModule.emit(t.id),this.visible=!1}setName(){this.id&&this.groups.forEach(t=>{const i=t.modules.filter(o=>o.id===this.id)[0];i&&(this.inputString=i.name)})}static#e=this.\u0275fac=function(i){return new(i||r)};static#t=this.\u0275cmp=e.Xpm({type:r,selectors:[["app-autocomplete"]],inputs:{id:"id",groups:"groups"},outputs:{selectModule:"selectModule"},decls:3,vars:2,consts:function(){let t;return t="( \u9009\u62E9 )",[[1,"autocomplete-container"],["type","search","placeholder",t,1,"form-control","form-control-sm",3,"ngModel","ngModelChange","focus","blur"],["tabindex","0","class","autocomplete",3,"focus","blur",4,"ngIf"],["tabindex","0",1,"autocomplete",3,"focus","blur"],[4,"ngFor","ngForOf"],["class","autocomplete__group-container",4,"ngIf"],[1,"autocomplete__group-container"],[1,"autocomplete__group-title"],["class","autocomplete__group-item",3,"click",4,"ngFor","ngForOf"],[1,"autocomplete__group-item",3,"click"]]},template:function(i,o){1&i&&(e.TgZ(0,"div",0)(1,"input",1),e.NdJ("ngModelChange",function(f){return o.inputString=f})("ngModelChange",function(f){return o.changed(f)})("focus",function(){return o.onFocus()})("blur",function(){return o.onBlur()}),e.qZA(),e.YNc(2,Sr,2,1,"div",2),e.qZA()),2&i&&(e.xp6(1),e.Q6J("ngModel",o.inputString),e.xp6(1),e.Q6J("ngIf",o.visible))},dependencies:[O.sg,O.O5,pe.Fj,pe.JJ,pe.On],styles:[".autocomplete-container[_ngcontent-%COMP%]{position:relative}.autocomplete[_ngcontent-%COMP%]{max-height:40vh;overflow:hidden;overflow-y:scroll;position:absolute;background-color:#444;border-radius:.2rem;border:1px solid #ced4da;z-index:1}.autocomplete__group-title[_ngcontent-%COMP%]{color:#ddd;font-size:1.15em;padding-left:10px}.autocomplete__group-item[_ngcontent-%COMP%]{font-size:1.1em;padding-left:20px;padding-right:10px}.autocomplete__group-item[_ngcontent-%COMP%]:hover{background-color:#0003;cursor:pointer}.autocomplete__group-item[_ngcontent-%COMP%]:hover   label[_ngcontent-%COMP%]{cursor:pointer}label[_ngcontent-%COMP%]{margin:0}input[type=search][_ngcontent-%COMP%]::-webkit-search-cancel-button{-webkit-appearance:searchfield-cancel-button}"]})}return r})();function Er(r,n){if(1&r&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&r){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",t.module.name," ")}}function yr(r,n){if(1&r){const t=e.EpF();e.TgZ(0,"tr",14)(1,"td"),e.YNc(2,Er,2,1,"div",15),e.TgZ(3,"div",16)(4,"app-autocomplete",17),e.NdJ("selectModule",function(o){const f=e.CHM(t).$implicit,S=e.oxw();return e.KtG(S.onSelectModule(o,f))}),e.qZA()()(),e.TgZ(5,"td")(6,"div",16)(7,"input",18),e.NdJ("ngModelChange",function(o){const f=e.CHM(t).$implicit;return e.KtG(f.count=o)})("ngModelChange",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.onChange())}),e.qZA()()(),e.TgZ(8,"td"),e._UZ(9,"i",19),e.qZA(),e.TgZ(10,"td")(11,"i",20),e.NdJ("click",function(){const l=e.CHM(t).$implicit,f=e.oxw();return e.KtG(f.removeModule(l))}),e.qZA()()()}if(2&r){const t=n.$implicit,i=e.oxw();e.xp6(4),e.Q6J("id",t.moduleId)("groups",i.wareGroups),e.xp6(3),e.Q6J("ngModel",t.count)}}let vr=(()=>{class r{constructor(t,i,o){this.moduleService=t,this.wareService=i,this.stationSummaryService=o,this.change=new e.vpe,this.sunlight=100}ngOnInit(){const t=this.moduleService.getModulesByType(Ae.J.production).reduce((i,o)=>{if(an.includes(o.id))return i[Ae.J.recycling]=i[Ae.J.recycling]||{name:Ae.J.recycling,group:Ae.J.recycling,modules:[]},i[Ae.J.recycling].modules.push(o),i;for(let l of o.product)i[l.group.id]=i[l.group.id]||{name:l.group.name,group:l.group,modules:[]},i[l.group.id].modules.push(o);return i},[]);this.wareGroups=Object.keys(t).map(i=>t[i]).sort((i,o)=>this.wareService.compareGroups(i.group,o.group));for(const i of Ae.B)this.wareGroups.push({name:i,modules:this.moduleService.getModulesByType(i)})}removeModule(t){const i=this.modules.indexOf(t);i>=0&&(this.modules.splice(i,1),this.onChange())}addModule(){this.modules.push(new We(this.wareService,this.moduleService))}onChange(){this.change.emit()}autofillModules(){const t=this.modules.find(o=>o.module?.type===Ae.J.habitation);let i="default";for(t&&(i=t.module.makerRace.id);;){const o=vt.calculate(this.modules,this.sunlight,this.stationSummaryService.$partialWorkforce);let l=!1;const f=this.modules;for(const S of o){if(S.amount>=0)continue;const v=this.moduleService.getModuleByWare(S.ware.id,i)||this.moduleService.getModuleByWare(S.ware.id);if(null==v)continue;l=!0;const x=v.product.find(de=>de.id==S.ware.id),G=x.production.find(de=>de.method==i)||x.production.find(de=>"default"==de.method),oe=Math.ceil(-S.amount/(G.amount*(3600/G.time))),Se=f.find(de=>de.module?.id==v.id);null==Se?f.push(new We(this.wareService,this.moduleService,v.id,oe)):Se.count+=oe}if(!l)break}this.onChange()}onSelectModule(t,i){this.modules[this.modules.indexOf(i)].moduleId=t,this.onChange()}drop(t){Vt(this.modules,t.previousIndex,t.currentIndex)}static#e=this.\u0275fac=function(i){return new(i||r)(e.Y36(je.C),e.Y36(it.l),e.Y36(Nt))};static#t=this.\u0275cmp=e.Xpm({type:r,selectors:[["app-station-modules"]],inputs:{modules:"modules",sunlight:"sunlight"},outputs:{change:"change"},decls:27,vars:1,consts:function(){let t,i,o,l;return t="\u6A21\u5757",i="\u8BA1\u6570",o="\u6DFB\u52A0\u6A21\u5757",l="\u81EA\u52A8\u586B\u5145\u6A21\u5757",[[1,"table","table-sm","table-hover","small"],["scope","col"],t,i,["aria-hidden","true",1,"fa","fa-ellipsis-v"],["aria-hidden","true",1,"fa","fa-trash"],["cdkDropList","",3,"cdkDropListDropped"],["cdkDrag","","cdkDragBoundary",".table",4,"ngFor","ngForOf"],["type","button",1,"btn","btn-secondary","btn-sm",3,"click"],[1,"fa","fa-plus-square"],o,["type","button",1,"btn","btn-sm","btn-info",3,"click"],[1,"fa","fa-list"],l,["cdkDrag","","cdkDragBoundary",".table"],[4,"cdkDragPreview"],[1,"form-group"],[3,"id","groups","selectModule"],["type","number","placeholder","Module Count","min","0",1,"form-control","form-control-sm",3,"ngModel","ngModelChange"],["cdkDragHandle","",1,"fa","fa-ellipsis-v","move"],["aria-hidden","true",1,"fa","fa-trash","hover",3,"click"]]},template:function(i,o){1&i&&(e.TgZ(0,"table",0)(1,"thead")(2,"tr")(3,"th",1),e.SDv(4,2),e.qZA(),e.TgZ(5,"th",1),e.SDv(6,3),e.qZA(),e.TgZ(7,"th",1),e._UZ(8,"i",4),e.qZA(),e.TgZ(9,"th",1),e._UZ(10,"i",5),e.qZA()()(),e.TgZ(11,"tbody",6),e.NdJ("cdkDropListDropped",function(f){return o.drop(f)}),e.YNc(12,yr,12,3,"tr",7),e.qZA(),e.TgZ(13,"tfoot")(14,"tr")(15,"th")(16,"button",8),e.NdJ("click",function(){return o.addModule()}),e._UZ(17,"i",9),e._uU(18,"\xa0"),e.TgZ(19,"span"),e.SDv(20,10),e.qZA()(),e._uU(21,"\xa0 "),e.TgZ(22,"button",11),e.NdJ("click",function(){return o.autofillModules()}),e._UZ(23,"i",12),e._uU(24,"\xa0"),e.TgZ(25,"span"),e.SDv(26,13),e.qZA()()()()()()),2&i&&(e.xp6(12),e.Q6J("ngForOf",o.modules))},dependencies:[O.sg,pe.Fj,pe.wV,pe.JJ,pe.qQ,pe.On,Xt,nn,Jt,tn,Cr],styles:[".cdk-drag-preview[_ngcontent-%COMP%]{background-color:#fff;padding:20px;box-sizing:border-box;border-radius:4px;box-shadow:0 5px 5px -3px #0003,0 8px 10px 1px #00000024,0 3px 14px 2px #0000001f}.cdk-drag-animating[_ngcontent-%COMP%]{transition:transform .25s cubic-bezier(0,0,.2,1)}.move[_ngcontent-%COMP%]{cursor:move}"]})}return r})();function Ar(r,n){if(1&r){const t=e.EpF();e.TgZ(0,"div",4)(1,"button",5),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(2);return e.KtG(o.result=null)}),e.TgZ(2,"span",6),e._uU(3,"\xd7"),e.qZA()(),e.TgZ(4,"div"),e._uU(5," Failed to import plans. "),e.qZA()()}}function Nr(r,n){1&r&&(e.TgZ(0,"span"),e._uU(1," | "),e.qZA())}function Mr(r,n){if(1&r){const t=e.EpF();e.ynx(0),e.TgZ(1,"a",10),e.NdJ("click",function(){const l=e.CHM(t).$implicit,f=e.oxw(3);return e.KtG(f.selectLayout(l))}),e._uU(2),e.qZA(),e.YNc(3,Nr,2,0,"span",0),e.BQk()}if(2&r){const t=n.$implicit,i=n.last;e.xp6(2),e.Oqu(t),e.xp6(1),e.Q6J("ngIf",!i)}}function Or(r,n){if(1&r){const t=e.EpF();e.TgZ(0,"div",7)(1,"button",5),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(2);return e.KtG(o.result=null)}),e.TgZ(2,"span",6),e._uU(3,"\xd7"),e.qZA()(),e.TgZ(4,"div"),e._uU(5," Imported plans, but errors occurred trying to import some of them. "),e.TgZ(6,"div",8),e.YNc(7,Mr,4,2,"ng-container",9),e.qZA()()()}if(2&r){const t=e.oxw(2);e.xp6(7),e.Q6J("ngForOf",t.result.layouts)}}function Ir(r,n){1&r&&(e.TgZ(0,"span"),e._uU(1," | "),e.qZA())}function wr(r,n){if(1&r){const t=e.EpF();e.ynx(0),e.TgZ(1,"a",10),e.NdJ("click",function(){const l=e.CHM(t).$implicit,f=e.oxw(3);return e.KtG(f.selectLayout(l))}),e._uU(2),e.qZA(),e.YNc(3,Ir,2,0,"span",0),e.BQk()}if(2&r){const t=n.$implicit,i=n.last;e.xp6(2),e.Oqu(t),e.xp6(1),e.Q6J("ngIf",!i)}}function br(r,n){if(1&r){const t=e.EpF();e.TgZ(0,"div",11)(1,"button",12),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(2);return e.KtG(o.result=null)}),e.TgZ(2,"span",6),e._uU(3,"\xd7"),e.qZA()(),e.TgZ(4,"div"),e._uU(5," Successfully imported plans "),e.TgZ(6,"div",8),e.YNc(7,wr,4,2,"ng-container",9),e.qZA()()()}if(2&r){const t=e.oxw(2);e.xp6(7),e.Q6J("ngForOf",t.result.layouts)}}function Rr(r,n){if(1&r&&(e.ynx(0),e.YNc(1,Ar,6,0,"div",1),e.YNc(2,Or,8,1,"div",2),e.YNc(3,br,8,1,"div",3),e.BQk()),2&r){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.result.error&&(!t.result.layouts||0===t.result.layouts.length)),e.xp6(1),e.Q6J("ngIf",t.result.error&&t.result.layouts&&t.result.layouts.length>0),e.xp6(1),e.Q6J("ngIf",!t.result.error&&t.result.layouts&&t.result.layouts.length>0)}}let xr=(()=>{class r{constructor(){this.selectPlan=new e.vpe}set result(t){this._result=t}get result(){return this._result}selectLayout(t){this.selectPlan.emit(t)}static#e=this.\u0275fac=function(i){return new(i||r)};static#t=this.\u0275cmp=e.Xpm({type:r,selectors:[["app-import-result"]],inputs:{result:"result"},outputs:{selectPlan:"selectPlan"},decls:1,vars:1,consts:[[4,"ngIf"],["class","alert alert-danger",4,"ngIf"],["class","alert alert-warning",4,"ngIf"],["class","alert alert-success",4,"ngIf"],[1,"alert","alert-danger"],["type","button","data-dismiss","alert","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"alert","alert-warning"],[1,"small"],[4,"ngFor","ngForOf"],[1,"cursor-pointer","link","text-primary",3,"click"],[1,"alert","alert-success"],["type","button","data-dismiss","alert","aria-label","Close",1,"close","pull-right",3,"click"]],template:function(i,o){1&i&&e.YNc(0,Rr,4,3,"ng-container",0),2&i&&e.Q6J("ngIf",o.result)},dependencies:[O.sg,O.O5],encapsulation:2})}return r})();const Pr=["stationResources","stationSummary"];function Dr(r,n){if(1&r){const t=e.EpF();e.TgZ(0,"div",21)(1,"div",38),e._UZ(2,"app-messages",39),e.TgZ(3,"app-import-result",40),e.NdJ("selectPlan",function(o){e.CHM(t);const l=e.oxw();return e.KtG(l.onSelectPlan(o))}),e.qZA()()()}if(2&r){const t=e.oxw();e.xp6(2),e.Q6J("messages",t.messages),e.xp6(1),e.Q6J("result",t.importResult)}}function kr(r,n){1&r&&(e.TgZ(0,"span",41),e.SDv(1,42),e.qZA())}function Lr(r,n){if(1&r&&(e.TgZ(0,"span",41),e._uU(1),e.qZA()),2&r){const t=e.oxw();e.xp6(1),e.Oqu(t.layout.name)}}let Fr=(()=>{class r extends Ct.V{constructor(t,i,o,l,f,S){super(),this.modal=t,this.route=i,this.layoutService=o,this.titleService=l,this.wareService=f,this.moduleService=S,this.messages=[],this.modules=[],this.sunlight=100}ngOnInit(){this.titleService.setTitle(`${tr.q} - Station Calculator`),this.route.queryParams.pipe((0,Ge.R)(this.onDestroy)).subscribe(t=>{if(t.l)try{const i=t.l.replace(/-/g,"=").replace(/,/g,"&"),o=rn.parse(i);this.modules=o.map(l=>new We(this.wareService,this.moduleService,l.module,l.count))}catch(i){console.log(i)}}),0===this.modules.length&&this.modules.push(new We(this.wareService,this.moduleService))}onChange(){this.components.forEach(t=>t.update())}shareLayout(){const t=this.modal.open(pi),i=this.modules.filter(f=>f.count>0&&f.moduleId).map(f=>({module:f.moduleId,count:f.count})),o=rn.stringify(i).replace(/=/g,"-").replace(/&/g,","),l=window.location.href.split("?")[0];t.componentInstance.url=`${l}?l=${o}`}saveLayoutAs(){this.modal.open(fi).result.then(i=>{i&&(this.layout={name:i,resourcesPrice:this.summaryComponent.resourcesPrice,productsPrice:this.summaryComponent.productsPrice,modulesResourcesPrice:this.summaryComponent.modulesResourcesPrice,provideBasicResources:this.summaryComponent.provideBasicResources,provideAllResources:this.summaryComponent.provideAllResources,isHeadquarters:this.summaryComponent.isHq,sunlight:this.sunlight,config:this.getModuleConfig()},this.layoutService.saveLayout(this.layout),this.messages.push({type:on.success,content:`<strong>${i}</strong> successfully saved.`}))})}saveLayout(){this.layout&&this.layout.name?(this.layout.config=this.getModuleConfig(),this.layout.resourcesPrice=this.summaryComponent.resourcesPrice,this.layout.productsPrice=this.summaryComponent.productsPrice,this.layout.modulesResourcesPrice=this.summaryComponent.modulesResourcesPrice,this.layout.provideBasicResources=this.summaryComponent.provideBasicResources,this.layout.provideAllResources=this.summaryComponent.provideAllResources,this.layout.isHeadquarters=this.summaryComponent.isHq,this.layout.sunlight=this.sunlight,this.layoutService.saveLayout(this.layout),this.messages.push({type:on.success,content:`<strong>${this.layout.name}</strong> successfully saved.`})):this.saveLayoutAs()}newLayout(){this.layout={name:null,config:[{moduleId:"",count:1}]},this.loadLayoutInternal(this.layout)}loadLayout(){this.modal.open(hi,{size:"lg"}).result.then(i=>{if(i){const o=this.layoutService.getLayout(i.layoutName);if(o)if(i.type==Pe.load)this.layout=o,this.loadLayoutInternal(o);else if(i.type==Pe.add){const l=this.modules.concat([]);this.getModules(o.config).forEach(S=>{const v=l.find(x=>x.moduleId==S.moduleId);null==v?l.push(S):v.count+=S.count}),this.modules=l}}})}importPlans(){this.modal.open(ir).result.then(i=>this.importResult=i)}loadLayoutInternal(t){this.modules=this.getModules(t.config),this.summaryComponent.productsPrice=null==t.productsPrice?50:t.productsPrice,this.summaryComponent.modulesResourcesPrice=null==t.modulesResourcesPrice?50:t.modulesResourcesPrice,this.summaryComponent.resourcesPrice=null==t.resourcesPrice?50:t.resourcesPrice,this.summaryComponent.provideBasicResources=t.provideBasicResources,this.summaryComponent.provideAllResources=t.provideAllResources,this.summaryComponent.isHq=t.isHeadquarters,this.sunlight=t.sunlight||100}getModuleConfig(){return this.modules.map(t=>({moduleId:t.moduleId,count:t.count}))}getModules(t){return t.map(i=>new We(this.wareService,this.moduleService,i.moduleId,i.count))}onSelectPlan(t){const i=this.layoutService.getLayout(t);i&&this.loadLayoutInternal(i)}static#e=this.\u0275fac=function(i){return new(i||r)(e.Y36(Oe.FF),e.Y36(St.gz),e.Y36(Ke),e.Y36(rr.Dx),e.Y36(it.l),e.Y36(je.C))};static#t=this.\u0275cmp=e.Xpm({type:r,selectors:[["app-station-calculator"]],viewQuery:function(i,o){if(1&i&&(e.Gf(Ze,7),e.Gf(Pr,5)),2&i){let l;e.iGM(l=e.CRH())&&(o.summaryComponent=l.first),e.iGM(l=e.CRH())&&(o.components=l)}},features:[e.qOj],decls:64,vars:10,consts:function(){let t,i,o,l,f,S,v,x,G,V;return t="\u65B0\u5EFA",i="\u4FDD\u5B58",o="\u4FDD\u5B58\u4E3A",l="\u8BFB\u53D6",f="\u5206\u4EAB",S="\u5BFC\u5165",v="\u9633\u5149",x="\u7A7A\u95F4\u7AD9\u8D44\u6E90",G="\u7A7A\u95F4\u7AD9\u6458\u8981",V="\u7A7A\u95F4\u7AD9\u6A21\u5757",[[1,"row","content-row"],[1,"col-md-12"],[1,"card","shadow"],[1,"card-header","shadow-sm"],["type","button",1,"btn","btn-sm","btn-info",3,"click"],[1,"fa","fa-file"],t,["type","button",1,"btn","btn-sm","btn-primary",3,"click"],[1,"fa","fa-save"],i,o,[1,"fa","fa-folder-open"],l,["type","button",1,"btn","btn-sm","btn-secondary",3,"click"],[1,"fa","fa-share-square"],f,["type","button",1,"btn","btn-sm","btn-dark",3,"click"],[1,"fa","fa-file-text"],S,[1,"card-body"],["class","row",4,"ngIf"],[1,"row"],[1,"col-md-4","col-sm-12"],[1,"card-title","d-flex","align-items-center"],["class","flex-fill",4,"ngIf"],[1,"d-flex","align-items-center"],[1,"form-label","text-nowrap","px-2"],v,[1,"input-group"],["type","text","id","sun-light","name","sunlight",1,"form-control",2,"width","70px",3,"ngModel","ngModelChange"],[1,"input-group-text"],[3,"modules","sunlight","change"],[1,"card-title"],x,[3,"modules","sunlight"],["stationResources",""],G,["stationSummary",""],[1,"col"],[3,"messages"],[3,"result","selectPlan"],[1,"flex-fill"],V]},template:function(i,o){1&i&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"button",4),e.NdJ("click",function(){return o.newLayout()}),e._UZ(5,"i",5),e._uU(6,"\xa0"),e.TgZ(7,"span"),e.SDv(8,6),e.qZA()(),e._uU(9,"\xa0 "),e.TgZ(10,"button",7),e.NdJ("click",function(){return o.saveLayout()}),e._UZ(11,"i",8),e._uU(12,"\xa0"),e.TgZ(13,"span"),e.SDv(14,9),e.qZA()(),e._uU(15,"\xa0 "),e.TgZ(16,"button",7),e.NdJ("click",function(){return o.saveLayoutAs()}),e._UZ(17,"i",8),e._uU(18,"\xa0"),e.TgZ(19,"span"),e.SDv(20,10),e.qZA()(),e._uU(21,"\xa0 "),e.TgZ(22,"button",4),e.NdJ("click",function(){return o.loadLayout()}),e._UZ(23,"i",11),e._uU(24,"\xa0"),e.TgZ(25,"span"),e.SDv(26,12),e.qZA()(),e._uU(27,"\xa0 "),e.TgZ(28,"button",13),e.NdJ("click",function(){return o.shareLayout()}),e._UZ(29,"i",14),e._uU(30,"\xa0"),e.TgZ(31,"span"),e.SDv(32,15),e.qZA()(),e._uU(33,"\xa0 "),e.TgZ(34,"button",16),e.NdJ("click",function(){return o.importPlans()}),e._UZ(35,"i",17),e._uU(36,"\xa0"),e.TgZ(37,"span"),e.SDv(38,18),e.qZA()()(),e.TgZ(39,"div",19),e.YNc(40,Dr,4,2,"div",20),e.TgZ(41,"div",21)(42,"div",22)(43,"h6",23),e.YNc(44,kr,2,0,"span",24),e.YNc(45,Lr,2,1,"span",24),e.TgZ(46,"div",25)(47,"label",26),e.SDv(48,27),e.qZA(),e.TgZ(49,"div",28)(50,"input",29),e.NdJ("ngModelChange",function(f){return o.sunlight=f}),e.qZA(),e.TgZ(51,"span",30),e._uU(52,"%"),e.qZA()()()(),e.TgZ(53,"app-station-modules",31),e.NdJ("change",function(){return o.onChange()}),e.qZA()(),e.TgZ(54,"div",22)(55,"h6",32),e.SDv(56,33),e.qZA(),e._UZ(57,"app-station-resources",34,35),e.qZA(),e.TgZ(59,"div",22)(60,"h6",32),e.SDv(61,36),e.qZA(),e._UZ(62,"app-station-summary",34,37),e.qZA()()()()()()),2&i&&(e.xp6(40),e.Q6J("ngIf",o.messages.length||o.importResult),e.xp6(4),e.Q6J("ngIf",!o.layout),e.xp6(1),e.Q6J("ngIf",o.layout),e.xp6(5),e.Q6J("ngModel",o.sunlight),e.xp6(3),e.Q6J("modules",o.modules)("sunlight",o.sunlight),e.xp6(4),e.Q6J("modules",o.modules)("sunlight",o.sunlight),e.xp6(5),e.Q6J("modules",o.modules)("sunlight",o.sunlight))},dependencies:[O.O5,pe.Fj,pe.JJ,pe.On,ar,pr,vr,Ze,xr],encapsulation:2})}return r})(),Ur=(()=>{class r{static#e=this.\u0275fac=function(i){return new(i||r)};static#t=this.\u0275mod=e.oAB({type:r});static#n=this.\u0275inj=e.cJS({imports:[St.Bz.forChild([{path:"",component:Fr}]),St.Bz]})}return r})(),Zr=(()=>{class r{static#e=this.\u0275fac=function(i){return new(i||r)};static#t=this.\u0275mod=e.oAB({type:r});static#n=this.\u0275inj=e.cJS({providers:[Ke],imports:[Oe.bz,O.ez,pe.u5,ai.m,Ur,si]})}return r})()},5343:(he,te)=>{"use strict";te.byteLength=function g(B){var Y=D(B),q=Y[1];return 3*(Y[0]+q)/4-q},te.toByteArray=function X(B){var Y,u,H=D(B),q=H[0],se=H[1],N=new O(function U(B,Y,H){return 3*(Y+H)/4-H}(0,q,se)),k=0,h=se>0?q-4:q;for(u=0;u<h;u+=4)Y=e[B.charCodeAt(u)]<<18|e[B.charCodeAt(u+1)]<<12|e[B.charCodeAt(u+2)]<<6|e[B.charCodeAt(u+3)],N[k++]=Y>>16&255,N[k++]=Y>>8&255,N[k++]=255&Y;return 2===se&&(Y=e[B.charCodeAt(u)]<<2|e[B.charCodeAt(u+1)]>>4,N[k++]=255&Y),1===se&&(Y=e[B.charCodeAt(u)]<<10|e[B.charCodeAt(u+1)]<<4|e[B.charCodeAt(u+2)]>>2,N[k++]=Y>>8&255,N[k++]=255&Y),N},te.fromByteArray=function W(B){for(var Y,H=B.length,q=H%3,se=[],N=16383,k=0,h=H-q;k<h;k+=N)se.push(z(B,k,k+N>h?h:k+N));return 1===q?se.push(R[(Y=B[H-1])>>2]+R[Y<<4&63]+"=="):2===q&&se.push(R[(Y=(B[H-2]<<8)+B[H-1])>>10]+R[Y>>4&63]+R[Y<<2&63]+"="),se.join("")};for(var R=[],e=[],O=typeof Uint8Array<"u"?Uint8Array:Array,M="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",L=0,m=M.length;L<m;++L)R[L]=M[L],e[M.charCodeAt(L)]=L;function D(B){var Y=B.length;if(Y%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var H=B.indexOf("=");return-1===H&&(H=Y),[H,H===Y?0:4-H%4]}function F(B){return R[B>>18&63]+R[B>>12&63]+R[B>>6&63]+R[63&B]}function z(B,Y,H){for(var se=[],N=Y;N<H;N+=3)se.push(F((B[N]<<16&16711680)+(B[N+1]<<8&65280)+(255&B[N+2])));return se.join("")}e["-".charCodeAt(0)]=62,e["_".charCodeAt(0)]=63},3172:(he,te,R)=>{"use strict";var e=R(5343),O=R(8461),M="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;te.Buffer=g,te.SlowBuffer=function N(d){return+d!=d&&(d=0),g.alloc(+d)},te.INSPECT_MAX_BYTES=50;var L=2147483647;function D(d){if(d>L)throw new RangeError('The value "'+d+'" is invalid for option "size"');var s=new Uint8Array(d);return Object.setPrototypeOf(s,g.prototype),s}function g(d,s,a){if("number"==typeof d){if("string"==typeof s)throw new TypeError('The "string" argument must be of type string. Received type number');return z(d)}return U(d,s,a)}function U(d,s,a){if("string"==typeof d)return function W(d,s){if(("string"!=typeof s||""===s)&&(s="utf8"),!g.isEncoding(s))throw new TypeError("Unknown encoding: "+s);var a=0|k(d,s),p=D(a),E=p.write(d,s);return E!==a&&(p=p.slice(0,E)),p}(d,s);if(ArrayBuffer.isView(d))return function Y(d){if(Q(d,Uint8Array)){var s=new Uint8Array(d);return H(s.buffer,s.byteOffset,s.byteLength)}return B(d)}(d);if(null==d)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof d);if(Q(d,ArrayBuffer)||d&&Q(d.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(Q(d,SharedArrayBuffer)||d&&Q(d.buffer,SharedArrayBuffer)))return H(d,s,a);if("number"==typeof d)throw new TypeError('The "value" argument must not be of type number. Received type number');var p=d.valueOf&&d.valueOf();if(null!=p&&p!==d)return g.from(p,s,a);var E=function q(d){if(g.isBuffer(d)){var s=0|se(d.length),a=D(s);return 0===a.length||d.copy(a,0,0,s),a}return void 0!==d.length?"number"!=typeof d.length||me(d.length)?D(0):B(d):"Buffer"===d.type&&Array.isArray(d.data)?B(d.data):void 0}(d);if(E)return E;if(typeof Symbol<"u"&&null!=Symbol.toPrimitive&&"function"==typeof d[Symbol.toPrimitive])return g.from(d[Symbol.toPrimitive]("string"),s,a);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof d)}function X(d){if("number"!=typeof d)throw new TypeError('"size" argument must be of type number');if(d<0)throw new RangeError('The value "'+d+'" is invalid for option "size"')}function z(d){return X(d),D(d<0?0:0|se(d))}function B(d){for(var s=d.length<0?0:0|se(d.length),a=D(s),p=0;p<s;p+=1)a[p]=255&d[p];return a}function H(d,s,a){if(s<0||d.byteLength<s)throw new RangeError('"offset" is outside of buffer bounds');if(d.byteLength<s+(a||0))throw new RangeError('"length" is outside of buffer bounds');var p;return p=void 0===s&&void 0===a?new Uint8Array(d):void 0===a?new Uint8Array(d,s):new Uint8Array(d,s,a),Object.setPrototypeOf(p,g.prototype),p}function se(d){if(d>=L)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+L.toString(16)+" bytes");return 0|d}function k(d,s){if(g.isBuffer(d))return d.length;if(ArrayBuffer.isView(d)||Q(d,ArrayBuffer))return d.byteLength;if("string"!=typeof d)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof d);var a=d.length,p=arguments.length>2&&!0===arguments[2];if(!p&&0===a)return 0;for(var E=!1;;)switch(s){case"ascii":case"latin1":case"binary":return a;case"utf8":case"utf-8":return c(d).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*a;case"hex":return a>>>1;case"base64":return J(d).length;default:if(E)return p?-1:c(d).length;s=(""+s).toLowerCase(),E=!0}}function h(d,s,a){var p=!1;if((void 0===s||s<0)&&(s=0),s>this.length||((void 0===a||a>this.length)&&(a=this.length),a<=0)||(a>>>=0)<=(s>>>=0))return"";for(d||(d="utf8");;)switch(d){case"hex":return we(this,s,a);case"utf8":case"utf-8":return ve(this,s,a);case"ascii":return ne(this,s,a);case"latin1":case"binary":return Je(this,s,a);case"base64":return Ne(this,s,a);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return xe(this,s,a);default:if(p)throw new TypeError("Unknown encoding: "+d);d=(d+"").toLowerCase(),p=!0}}function u(d,s,a){var p=d[s];d[s]=d[a],d[a]=p}function y(d,s,a,p,E){if(0===d.length)return-1;if("string"==typeof a?(p=a,a=0):a>2147483647?a=2147483647:a<-2147483648&&(a=-2147483648),me(a=+a)&&(a=E?0:d.length-1),a<0&&(a=d.length+a),a>=d.length){if(E)return-1;a=d.length-1}else if(a<0){if(!E)return-1;a=0}if("string"==typeof s&&(s=g.from(s,p)),g.isBuffer(s))return 0===s.length?-1:P(d,s,a,p,E);if("number"==typeof s)return s&=255,"function"==typeof Uint8Array.prototype.indexOf?E?Uint8Array.prototype.indexOf.call(d,s,a):Uint8Array.prototype.lastIndexOf.call(d,s,a):P(d,[s],a,p,E);throw new TypeError("val must be string, number or Buffer")}function P(d,s,a,p,E){var ue,w=1,b=d.length,ee=s.length;if(void 0!==p&&("ucs2"===(p=String(p).toLowerCase())||"ucs-2"===p||"utf16le"===p||"utf-16le"===p)){if(d.length<2||s.length<2)return-1;w=2,b/=2,ee/=2,a/=2}function ie(ot,st){return 1===w?ot[st]:ot.readUInt16BE(st*w)}if(E){var Ce=-1;for(ue=a;ue<b;ue++)if(ie(d,ue)===ie(s,-1===Ce?0:ue-Ce)){if(-1===Ce&&(Ce=ue),ue-Ce+1===ee)return Ce*w}else-1!==Ce&&(ue-=ue-Ce),Ce=-1}else for(a+ee>b&&(a=b-ee),ue=a;ue>=0;ue--){for(var fe=!0,Ye=0;Ye<ee;Ye++)if(ie(d,ue+Ye)!==ie(s,Ye)){fe=!1;break}if(fe)return ue}return-1}function $(d,s,a,p){a=Number(a)||0;var E=d.length-a;p?(p=Number(p))>E&&(p=E):p=E;var w=s.length;p>w/2&&(p=w/2);for(var b=0;b<p;++b){var ee=parseInt(s.substr(2*b,2),16);if(me(ee))return b;d[a+b]=ee}return b}function T(d,s,a,p){return ce(c(s,d.length-a),d,a,p)}function K(d,s,a,p){return ce(function I(d){for(var s=[],a=0;a<d.length;++a)s.push(255&d.charCodeAt(a));return s}(s),d,a,p)}function re(d,s,a,p){return ce(J(s),d,a,p)}function _e(d,s,a,p){return ce(function C(d,s){for(var a,p,w=[],b=0;b<d.length&&!((s-=2)<0);++b)p=(a=d.charCodeAt(b))>>8,w.push(a%256),w.push(p);return w}(s,d.length-a),d,a,p)}function Ne(d,s,a){return e.fromByteArray(0===s&&a===d.length?d:d.slice(s,a))}function ve(d,s,a){a=Math.min(d.length,a);for(var p=[],E=s;E<a;){var ie,ue,Ce,fe,w=d[E],b=null,ee=w>239?4:w>223?3:w>191?2:1;if(E+ee<=a)switch(ee){case 1:w<128&&(b=w);break;case 2:128==(192&(ie=d[E+1]))&&(fe=(31&w)<<6|63&ie)>127&&(b=fe);break;case 3:ue=d[E+2],128==(192&(ie=d[E+1]))&&128==(192&ue)&&(fe=(15&w)<<12|(63&ie)<<6|63&ue)>2047&&(fe<55296||fe>57343)&&(b=fe);break;case 4:ue=d[E+2],Ce=d[E+3],128==(192&(ie=d[E+1]))&&128==(192&ue)&&128==(192&Ce)&&(fe=(15&w)<<18|(63&ie)<<12|(63&ue)<<6|63&Ce)>65535&&fe<1114112&&(b=fe)}null===b?(b=65533,ee=1):b>65535&&(p.push((b-=65536)>>>10&1023|55296),b=56320|1023&b),p.push(b),E+=ee}return function De(d){var s=d.length;if(s<=Me)return String.fromCharCode.apply(String,d);for(var a="",p=0;p<s;)a+=String.fromCharCode.apply(String,d.slice(p,p+=Me));return a}(p)}te.kMaxLength=L,!(g.TYPED_ARRAY_SUPPORT=function m(){try{var d=new Uint8Array(1),s={foo:function(){return 42}};return Object.setPrototypeOf(s,Uint8Array.prototype),Object.setPrototypeOf(d,s),42===d.foo()}catch{return!1}}())&&typeof console<"u"&&"function"==typeof console.error&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(g.prototype,"parent",{enumerable:!0,get:function(){if(g.isBuffer(this))return this.buffer}}),Object.defineProperty(g.prototype,"offset",{enumerable:!0,get:function(){if(g.isBuffer(this))return this.byteOffset}}),g.poolSize=8192,g.from=function(d,s,a){return U(d,s,a)},Object.setPrototypeOf(g.prototype,Uint8Array.prototype),Object.setPrototypeOf(g,Uint8Array),g.alloc=function(d,s,a){return function F(d,s,a){return X(d),d<=0?D(d):void 0!==s?"string"==typeof a?D(d).fill(s,a):D(d).fill(s):D(d)}(d,s,a)},g.allocUnsafe=function(d){return z(d)},g.allocUnsafeSlow=function(d){return z(d)},g.isBuffer=function(s){return null!=s&&!0===s._isBuffer&&s!==g.prototype},g.compare=function(s,a){if(Q(s,Uint8Array)&&(s=g.from(s,s.offset,s.byteLength)),Q(a,Uint8Array)&&(a=g.from(a,a.offset,a.byteLength)),!g.isBuffer(s)||!g.isBuffer(a))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(s===a)return 0;for(var p=s.length,E=a.length,w=0,b=Math.min(p,E);w<b;++w)if(s[w]!==a[w]){p=s[w],E=a[w];break}return p<E?-1:E<p?1:0},g.isEncoding=function(s){switch(String(s).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},g.concat=function(s,a){if(!Array.isArray(s))throw new TypeError('"list" argument must be an Array of Buffers');if(0===s.length)return g.alloc(0);var p;if(void 0===a)for(a=0,p=0;p<s.length;++p)a+=s[p].length;var E=g.allocUnsafe(a),w=0;for(p=0;p<s.length;++p){var b=s[p];if(Q(b,Uint8Array))w+b.length>E.length?g.from(b).copy(E,w):Uint8Array.prototype.set.call(E,b,w);else{if(!g.isBuffer(b))throw new TypeError('"list" argument must be an Array of Buffers');b.copy(E,w)}w+=b.length}return E},g.byteLength=k,g.prototype._isBuffer=!0,g.prototype.swap16=function(){var s=this.length;if(s%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var a=0;a<s;a+=2)u(this,a,a+1);return this},g.prototype.swap32=function(){var s=this.length;if(s%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var a=0;a<s;a+=4)u(this,a,a+3),u(this,a+1,a+2);return this},g.prototype.swap64=function(){var s=this.length;if(s%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var a=0;a<s;a+=8)u(this,a,a+7),u(this,a+1,a+6),u(this,a+2,a+5),u(this,a+3,a+4);return this},g.prototype.toLocaleString=g.prototype.toString=function(){var s=this.length;return 0===s?"":0===arguments.length?ve(this,0,s):h.apply(this,arguments)},g.prototype.equals=function(s){if(!g.isBuffer(s))throw new TypeError("Argument must be a Buffer");return this===s||0===g.compare(this,s)},g.prototype.inspect=function(){var s="",a=te.INSPECT_MAX_BYTES;return s=this.toString("hex",0,a).replace(/(.{2})/g,"$1 ").trim(),this.length>a&&(s+=" ... "),"<Buffer "+s+">"},M&&(g.prototype[M]=g.prototype.inspect),g.prototype.compare=function(s,a,p,E,w){if(Q(s,Uint8Array)&&(s=g.from(s,s.offset,s.byteLength)),!g.isBuffer(s))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof s);if(void 0===a&&(a=0),void 0===p&&(p=s?s.length:0),void 0===E&&(E=0),void 0===w&&(w=this.length),a<0||p>s.length||E<0||w>this.length)throw new RangeError("out of range index");if(E>=w&&a>=p)return 0;if(E>=w)return-1;if(a>=p)return 1;if(this===s)return 0;for(var b=(w>>>=0)-(E>>>=0),ee=(p>>>=0)-(a>>>=0),ie=Math.min(b,ee),ue=this.slice(E,w),Ce=s.slice(a,p),fe=0;fe<ie;++fe)if(ue[fe]!==Ce[fe]){b=ue[fe],ee=Ce[fe];break}return b<ee?-1:ee<b?1:0},g.prototype.includes=function(s,a,p){return-1!==this.indexOf(s,a,p)},g.prototype.indexOf=function(s,a,p){return y(this,s,a,p,!0)},g.prototype.lastIndexOf=function(s,a,p){return y(this,s,a,p,!1)},g.prototype.write=function(s,a,p,E){if(void 0===a)E="utf8",p=this.length,a=0;else if(void 0===p&&"string"==typeof a)E=a,p=this.length,a=0;else{if(!isFinite(a))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");a>>>=0,isFinite(p)?(p>>>=0,void 0===E&&(E="utf8")):(E=p,p=void 0)}var w=this.length-a;if((void 0===p||p>w)&&(p=w),s.length>0&&(p<0||a<0)||a>this.length)throw new RangeError("Attempt to write outside buffer bounds");E||(E="utf8");for(var b=!1;;)switch(E){case"hex":return $(this,s,a,p);case"utf8":case"utf-8":return T(this,s,a,p);case"ascii":case"latin1":case"binary":return K(this,s,a,p);case"base64":return re(this,s,a,p);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return _e(this,s,a,p);default:if(b)throw new TypeError("Unknown encoding: "+E);E=(""+E).toLowerCase(),b=!0}},g.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var Me=4096;function ne(d,s,a){var p="";a=Math.min(d.length,a);for(var E=s;E<a;++E)p+=String.fromCharCode(127&d[E]);return p}function Je(d,s,a){var p="";a=Math.min(d.length,a);for(var E=s;E<a;++E)p+=String.fromCharCode(d[E]);return p}function we(d,s,a){var p=d.length;(!s||s<0)&&(s=0),(!a||a<0||a>p)&&(a=p);for(var E="",w=s;w<a;++w)E+=Te[d[w]];return E}function xe(d,s,a){for(var p=d.slice(s,a),E="",w=0;w<p.length-1;w+=2)E+=String.fromCharCode(p[w]+256*p[w+1]);return E}function ae(d,s,a){if(d%1!=0||d<0)throw new RangeError("offset is not uint");if(d+s>a)throw new RangeError("Trying to access beyond buffer length")}function ge(d,s,a,p,E,w){if(!g.isBuffer(d))throw new TypeError('"buffer" argument must be a Buffer instance');if(s>E||s<w)throw new RangeError('"value" argument is out of bounds');if(a+p>d.length)throw new RangeError("Index out of range")}function ke(d,s,a,p,E,w){if(a+p>d.length)throw new RangeError("Index out of range");if(a<0)throw new RangeError("Index out of range")}function be(d,s,a,p,E){return s=+s,a>>>=0,E||ke(d,0,a,4),O.write(d,s,a,p,23,4),a+4}function Re(d,s,a,p,E){return s=+s,a>>>=0,E||ke(d,0,a,8),O.write(d,s,a,p,52,8),a+8}g.prototype.slice=function(s,a){var p=this.length;(s=~~s)<0?(s+=p)<0&&(s=0):s>p&&(s=p),(a=void 0===a?p:~~a)<0?(a+=p)<0&&(a=0):a>p&&(a=p),a<s&&(a=s);var E=this.subarray(s,a);return Object.setPrototypeOf(E,g.prototype),E},g.prototype.readUintLE=g.prototype.readUIntLE=function(s,a,p){s>>>=0,a>>>=0,p||ae(s,a,this.length);for(var E=this[s],w=1,b=0;++b<a&&(w*=256);)E+=this[s+b]*w;return E},g.prototype.readUintBE=g.prototype.readUIntBE=function(s,a,p){s>>>=0,a>>>=0,p||ae(s,a,this.length);for(var E=this[s+--a],w=1;a>0&&(w*=256);)E+=this[s+--a]*w;return E},g.prototype.readUint8=g.prototype.readUInt8=function(s,a){return s>>>=0,a||ae(s,1,this.length),this[s]},g.prototype.readUint16LE=g.prototype.readUInt16LE=function(s,a){return s>>>=0,a||ae(s,2,this.length),this[s]|this[s+1]<<8},g.prototype.readUint16BE=g.prototype.readUInt16BE=function(s,a){return s>>>=0,a||ae(s,2,this.length),this[s]<<8|this[s+1]},g.prototype.readUint32LE=g.prototype.readUInt32LE=function(s,a){return s>>>=0,a||ae(s,4,this.length),(this[s]|this[s+1]<<8|this[s+2]<<16)+16777216*this[s+3]},g.prototype.readUint32BE=g.prototype.readUInt32BE=function(s,a){return s>>>=0,a||ae(s,4,this.length),16777216*this[s]+(this[s+1]<<16|this[s+2]<<8|this[s+3])},g.prototype.readIntLE=function(s,a,p){s>>>=0,a>>>=0,p||ae(s,a,this.length);for(var E=this[s],w=1,b=0;++b<a&&(w*=256);)E+=this[s+b]*w;return E>=(w*=128)&&(E-=Math.pow(2,8*a)),E},g.prototype.readIntBE=function(s,a,p){s>>>=0,a>>>=0,p||ae(s,a,this.length);for(var E=a,w=1,b=this[s+--E];E>0&&(w*=256);)b+=this[s+--E]*w;return b>=(w*=128)&&(b-=Math.pow(2,8*a)),b},g.prototype.readInt8=function(s,a){return s>>>=0,a||ae(s,1,this.length),128&this[s]?-1*(255-this[s]+1):this[s]},g.prototype.readInt16LE=function(s,a){s>>>=0,a||ae(s,2,this.length);var p=this[s]|this[s+1]<<8;return 32768&p?4294901760|p:p},g.prototype.readInt16BE=function(s,a){s>>>=0,a||ae(s,2,this.length);var p=this[s+1]|this[s]<<8;return 32768&p?4294901760|p:p},g.prototype.readInt32LE=function(s,a){return s>>>=0,a||ae(s,4,this.length),this[s]|this[s+1]<<8|this[s+2]<<16|this[s+3]<<24},g.prototype.readInt32BE=function(s,a){return s>>>=0,a||ae(s,4,this.length),this[s]<<24|this[s+1]<<16|this[s+2]<<8|this[s+3]},g.prototype.readFloatLE=function(s,a){return s>>>=0,a||ae(s,4,this.length),O.read(this,s,!0,23,4)},g.prototype.readFloatBE=function(s,a){return s>>>=0,a||ae(s,4,this.length),O.read(this,s,!1,23,4)},g.prototype.readDoubleLE=function(s,a){return s>>>=0,a||ae(s,8,this.length),O.read(this,s,!0,52,8)},g.prototype.readDoubleBE=function(s,a){return s>>>=0,a||ae(s,8,this.length),O.read(this,s,!1,52,8)},g.prototype.writeUintLE=g.prototype.writeUIntLE=function(s,a,p,E){s=+s,a>>>=0,p>>>=0,E||ge(this,s,a,p,Math.pow(2,8*p)-1,0);var b=1,ee=0;for(this[a]=255&s;++ee<p&&(b*=256);)this[a+ee]=s/b&255;return a+p},g.prototype.writeUintBE=g.prototype.writeUIntBE=function(s,a,p,E){s=+s,a>>>=0,p>>>=0,E||ge(this,s,a,p,Math.pow(2,8*p)-1,0);var b=p-1,ee=1;for(this[a+b]=255&s;--b>=0&&(ee*=256);)this[a+b]=s/ee&255;return a+p},g.prototype.writeUint8=g.prototype.writeUInt8=function(s,a,p){return s=+s,a>>>=0,p||ge(this,s,a,1,255,0),this[a]=255&s,a+1},g.prototype.writeUint16LE=g.prototype.writeUInt16LE=function(s,a,p){return s=+s,a>>>=0,p||ge(this,s,a,2,65535,0),this[a]=255&s,this[a+1]=s>>>8,a+2},g.prototype.writeUint16BE=g.prototype.writeUInt16BE=function(s,a,p){return s=+s,a>>>=0,p||ge(this,s,a,2,65535,0),this[a]=s>>>8,this[a+1]=255&s,a+2},g.prototype.writeUint32LE=g.prototype.writeUInt32LE=function(s,a,p){return s=+s,a>>>=0,p||ge(this,s,a,4,4294967295,0),this[a+3]=s>>>24,this[a+2]=s>>>16,this[a+1]=s>>>8,this[a]=255&s,a+4},g.prototype.writeUint32BE=g.prototype.writeUInt32BE=function(s,a,p){return s=+s,a>>>=0,p||ge(this,s,a,4,4294967295,0),this[a]=s>>>24,this[a+1]=s>>>16,this[a+2]=s>>>8,this[a+3]=255&s,a+4},g.prototype.writeIntLE=function(s,a,p,E){if(s=+s,a>>>=0,!E){var w=Math.pow(2,8*p-1);ge(this,s,a,p,w-1,-w)}var b=0,ee=1,ie=0;for(this[a]=255&s;++b<p&&(ee*=256);)s<0&&0===ie&&0!==this[a+b-1]&&(ie=1),this[a+b]=(s/ee>>0)-ie&255;return a+p},g.prototype.writeIntBE=function(s,a,p,E){if(s=+s,a>>>=0,!E){var w=Math.pow(2,8*p-1);ge(this,s,a,p,w-1,-w)}var b=p-1,ee=1,ie=0;for(this[a+b]=255&s;--b>=0&&(ee*=256);)s<0&&0===ie&&0!==this[a+b+1]&&(ie=1),this[a+b]=(s/ee>>0)-ie&255;return a+p},g.prototype.writeInt8=function(s,a,p){return s=+s,a>>>=0,p||ge(this,s,a,1,127,-128),s<0&&(s=255+s+1),this[a]=255&s,a+1},g.prototype.writeInt16LE=function(s,a,p){return s=+s,a>>>=0,p||ge(this,s,a,2,32767,-32768),this[a]=255&s,this[a+1]=s>>>8,a+2},g.prototype.writeInt16BE=function(s,a,p){return s=+s,a>>>=0,p||ge(this,s,a,2,32767,-32768),this[a]=s>>>8,this[a+1]=255&s,a+2},g.prototype.writeInt32LE=function(s,a,p){return s=+s,a>>>=0,p||ge(this,s,a,4,2147483647,-2147483648),this[a]=255&s,this[a+1]=s>>>8,this[a+2]=s>>>16,this[a+3]=s>>>24,a+4},g.prototype.writeInt32BE=function(s,a,p){return s=+s,a>>>=0,p||ge(this,s,a,4,2147483647,-2147483648),s<0&&(s=4294967295+s+1),this[a]=s>>>24,this[a+1]=s>>>16,this[a+2]=s>>>8,this[a+3]=255&s,a+4},g.prototype.writeFloatLE=function(s,a,p){return be(this,s,a,!0,p)},g.prototype.writeFloatBE=function(s,a,p){return be(this,s,a,!1,p)},g.prototype.writeDoubleLE=function(s,a,p){return Re(this,s,a,!0,p)},g.prototype.writeDoubleBE=function(s,a,p){return Re(this,s,a,!1,p)},g.prototype.copy=function(s,a,p,E){if(!g.isBuffer(s))throw new TypeError("argument should be a Buffer");if(p||(p=0),!E&&0!==E&&(E=this.length),a>=s.length&&(a=s.length),a||(a=0),E>0&&E<p&&(E=p),E===p||0===s.length||0===this.length)return 0;if(a<0)throw new RangeError("targetStart out of bounds");if(p<0||p>=this.length)throw new RangeError("Index out of range");if(E<0)throw new RangeError("sourceEnd out of bounds");E>this.length&&(E=this.length),s.length-a<E-p&&(E=s.length-a+p);var w=E-p;return this===s&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(a,p,E):Uint8Array.prototype.set.call(s,this.subarray(p,E),a),w},g.prototype.fill=function(s,a,p,E){if("string"==typeof s){if("string"==typeof a?(E=a,a=0,p=this.length):"string"==typeof p&&(E=p,p=this.length),void 0!==E&&"string"!=typeof E)throw new TypeError("encoding must be a string");if("string"==typeof E&&!g.isEncoding(E))throw new TypeError("Unknown encoding: "+E);if(1===s.length){var w=s.charCodeAt(0);("utf8"===E&&w<128||"latin1"===E)&&(s=w)}}else"number"==typeof s?s&=255:"boolean"==typeof s&&(s=Number(s));if(a<0||this.length<a||this.length<p)throw new RangeError("Out of range index");if(p<=a)return this;var b;if(a>>>=0,p=void 0===p?this.length:p>>>0,s||(s=0),"number"==typeof s)for(b=a;b<p;++b)this[b]=s;else{var ee=g.isBuffer(s)?s:g.from(s,E),ie=ee.length;if(0===ie)throw new TypeError('The value "'+s+'" is invalid for argument "value"');for(b=0;b<p-a;++b)this[b+a]=ee[b%ie]}return this};var $e=/[^+/0-9A-Za-z-_]/g;function c(d,s){s=s||1/0;for(var a,p=d.length,E=null,w=[],b=0;b<p;++b){if((a=d.charCodeAt(b))>55295&&a<57344){if(!E){if(a>56319){(s-=3)>-1&&w.push(239,191,189);continue}if(b+1===p){(s-=3)>-1&&w.push(239,191,189);continue}E=a;continue}if(a<56320){(s-=3)>-1&&w.push(239,191,189),E=a;continue}a=65536+(E-55296<<10|a-56320)}else E&&(s-=3)>-1&&w.push(239,191,189);if(E=null,a<128){if((s-=1)<0)break;w.push(a)}else if(a<2048){if((s-=2)<0)break;w.push(a>>6|192,63&a|128)}else if(a<65536){if((s-=3)<0)break;w.push(a>>12|224,a>>6&63|128,63&a|128)}else{if(!(a<1114112))throw new Error("Invalid code point");if((s-=4)<0)break;w.push(a>>18|240,a>>12&63|128,a>>6&63|128,63&a|128)}}return w}function J(d){return e.toByteArray(function _(d){if((d=(d=d.split("=")[0]).trim().replace($e,"")).length<2)return"";for(;d.length%4!=0;)d+="=";return d}(d))}function ce(d,s,a,p){for(var E=0;E<p&&!(E+a>=s.length||E>=d.length);++E)s[E+a]=d[E];return E}function Q(d,s){return d instanceof s||null!=d&&null!=d.constructor&&null!=d.constructor.name&&d.constructor.name===s.name}function me(d){return d!=d}var Te=function(){for(var d="0123456789abcdef",s=new Array(256),a=0;a<16;++a)for(var p=16*a,E=0;E<16;++E)s[p+E]=d[a]+d[E];return s}()},8461:(he,te)=>{te.read=function(R,e,O,M,L){var m,D,g=8*L-M-1,U=(1<<g)-1,X=U>>1,F=-7,z=O?L-1:0,W=O?-1:1,B=R[e+z];for(z+=W,m=B&(1<<-F)-1,B>>=-F,F+=g;F>0;m=256*m+R[e+z],z+=W,F-=8);for(D=m&(1<<-F)-1,m>>=-F,F+=M;F>0;D=256*D+R[e+z],z+=W,F-=8);if(0===m)m=1-X;else{if(m===U)return D?NaN:1/0*(B?-1:1);D+=Math.pow(2,M),m-=X}return(B?-1:1)*D*Math.pow(2,m-M)},te.write=function(R,e,O,M,L,m){var D,g,U,X=8*m-L-1,F=(1<<X)-1,z=F>>1,W=23===L?Math.pow(2,-24)-Math.pow(2,-77):0,B=M?0:m-1,Y=M?1:-1,H=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(g=isNaN(e)?1:0,D=F):(D=Math.floor(Math.log(e)/Math.LN2),e*(U=Math.pow(2,-D))<1&&(D--,U*=2),(e+=D+z>=1?W/U:W*Math.pow(2,1-z))*U>=2&&(D++,U/=2),D+z>=F?(g=0,D=F):D+z>=1?(g=(e*U-1)*Math.pow(2,L),D+=z):(g=e*Math.pow(2,z-1)*Math.pow(2,L),D=0));L>=8;R[O+B]=255&g,B+=Y,g/=256,L-=8);for(D=D<<L|g,X+=L;X>0;R[O+B]=255&D,B+=Y,D/=256,X-=8);R[O+B-Y]|=128*H}},3502:(he,te,R)=>{var e=R(3172),O=e.Buffer;function M(m,D){for(var g in m)D[g]=m[g]}function L(m,D,g){return O(m,D,g)}O.from&&O.alloc&&O.allocUnsafe&&O.allocUnsafeSlow?he.exports=e:(M(e,te),te.Buffer=L),L.prototype=Object.create(O.prototype),M(O,L),L.from=function(m,D,g){if("number"==typeof m)throw new TypeError("Argument must not be a number");return O(m,D,g)},L.alloc=function(m,D,g){if("number"!=typeof m)throw new TypeError("Argument must be a number");var U=O(m);return void 0!==D?"string"==typeof g?U.fill(D,g):U.fill(D):U.fill(0),U},L.allocUnsafe=function(m){if("number"!=typeof m)throw new TypeError("Argument must be a number");return O(m)},L.allocUnsafeSlow=function(m){if("number"!=typeof m)throw new TypeError("Argument must be a number");return e.SlowBuffer(m)}},1503:(he,te,R)=>{!function(e){e.parser=function(_,c){return new M(_,c)},e.SAXParser=M,e.SAXStream=F,e.createStream=function X(_,c){return new F(_,c)},e.MAX_BUFFER_LENGTH=65536;var g,O=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];function M(_,c){if(!(this instanceof M))return new M(_,c);var I=this;(function m(_){for(var c=0,I=O.length;c<I;c++)_[O[c]]=""})(I),I.q=I.c="",I.bufferCheckPosition=e.MAX_BUFFER_LENGTH,I.opt=c||{},I.opt.lowercase=I.opt.lowercase||I.opt.lowercasetags,I.looseCase=I.opt.lowercase?"toLowerCase":"toUpperCase",I.tags=[],I.closed=I.closedRoot=I.sawRoot=!1,I.tag=I.error=null,I.strict=!!_,I.noscript=!(!_&&!I.opt.noscript),I.state=T.BEGIN,I.strictEntities=I.opt.strictEntities,I.ENTITIES=Object.create(I.strictEntities?e.XML_ENTITIES:e.ENTITIES),I.attribList=[],I.opt.xmlns&&(I.ns=Object.create(H)),I.trackPosition=!1!==I.opt.position,I.trackPosition&&(I.position=I.line=I.column=0),re(I,"onready")}e.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"],Object.create||(Object.create=function(_){function c(){}return c.prototype=_,new c}),Object.keys||(Object.keys=function(_){var c=[];for(var I in _)_.hasOwnProperty(I)&&c.push(I);return c}),M.prototype={end:function(){De(this)},write:function $e(_){var c=this;if(this.error)throw this.error;if(c.closed)return Me(c,"Cannot write after close. Assign an onready handler.");if(null===_)return De(c);"object"==typeof _&&(_=_.toString());for(var I=0,C="";C=Re(_,I++),c.c=C,C;)switch(c.trackPosition&&(c.position++,"\n"===C?(c.line++,c.column=0):c.column++),c.state){case T.BEGIN:if(c.state=T.BEGIN_WHITESPACE,"\ufeff"===C)continue;be(c,C);continue;case T.BEGIN_WHITESPACE:be(c,C);continue;case T.TEXT:if(c.sawRoot&&!c.closedRoot){for(var J=I-1;C&&"<"!==C&&"&"!==C;)(C=Re(_,I++))&&c.trackPosition&&(c.position++,"\n"===C?(c.line++,c.column=0):c.column++);c.textNode+=_.substring(J,I-1)}"<"!==C||c.sawRoot&&c.closedRoot&&!c.strict?(!h(C)&&(!c.sawRoot||c.closedRoot)&&ne(c,"Text data outside of root node."),"&"===C?c.state=T.TEXT_ENTITY:c.textNode+=C):(c.state=T.OPEN_WAKA,c.startTagPosition=c.position);continue;case T.SCRIPT:"<"===C?c.state=T.SCRIPT_ENDING:c.script+=C;continue;case T.SCRIPT_ENDING:"/"===C?c.state=T.CLOSE_TAG:(c.script+="<"+C,c.state=T.SCRIPT);continue;case T.OPEN_WAKA:"!"===C?(c.state=T.SGML_DECL,c.sgmlDecl=""):h(C)||(P(q,C)?(c.state=T.OPEN_TAG,c.tagName=C):"/"===C?(c.state=T.CLOSE_TAG,c.tagName=""):"?"===C?(c.state=T.PROC_INST,c.procInstName=c.procInstBody=""):(ne(c,"Unencoded <"),c.startTagPosition+1<c.position&&(C=new Array(c.position-c.startTagPosition).join(" ")+C),c.textNode+="<"+C,c.state=T.TEXT));continue;case T.SGML_DECL:(c.sgmlDecl+C).toUpperCase()===z?(_e(c,"onopencdata"),c.state=T.CDATA,c.sgmlDecl="",c.cdata=""):c.sgmlDecl+C==="--"?(c.state=T.COMMENT,c.comment="",c.sgmlDecl=""):(c.sgmlDecl+C).toUpperCase()===W?(c.state=T.DOCTYPE,(c.doctype||c.sawRoot)&&ne(c,"Inappropriately located doctype declaration"),c.doctype="",c.sgmlDecl=""):">"===C?(_e(c,"onsgmldeclaration",c.sgmlDecl),c.sgmlDecl="",c.state=T.TEXT):(u(C)&&(c.state=T.SGML_DECL_QUOTED),c.sgmlDecl+=C);continue;case T.SGML_DECL_QUOTED:C===c.q&&(c.state=T.SGML_DECL,c.q=""),c.sgmlDecl+=C;continue;case T.DOCTYPE:">"===C?(c.state=T.TEXT,_e(c,"ondoctype",c.doctype),c.doctype=!0):(c.doctype+=C,"["===C?c.state=T.DOCTYPE_DTD:u(C)&&(c.state=T.DOCTYPE_QUOTED,c.q=C));continue;case T.DOCTYPE_QUOTED:c.doctype+=C,C===c.q&&(c.q="",c.state=T.DOCTYPE);continue;case T.DOCTYPE_DTD:c.doctype+=C,"]"===C?c.state=T.DOCTYPE:u(C)&&(c.state=T.DOCTYPE_DTD_QUOTED,c.q=C);continue;case T.DOCTYPE_DTD_QUOTED:c.doctype+=C,C===c.q&&(c.state=T.DOCTYPE_DTD,c.q="");continue;case T.COMMENT:"-"===C?c.state=T.COMMENT_ENDING:c.comment+=C;continue;case T.COMMENT_ENDING:"-"===C?(c.state=T.COMMENT_ENDED,c.comment=ve(c.opt,c.comment),c.comment&&_e(c,"oncomment",c.comment),c.comment=""):(c.comment+="-"+C,c.state=T.COMMENT);continue;case T.COMMENT_ENDED:">"!==C?(ne(c,"Malformed comment"),c.comment+="--"+C,c.state=T.COMMENT):c.state=T.TEXT;continue;case T.CDATA:"]"===C?c.state=T.CDATA_ENDING:c.cdata+=C;continue;case T.CDATA_ENDING:"]"===C?c.state=T.CDATA_ENDING_2:(c.cdata+="]"+C,c.state=T.CDATA);continue;case T.CDATA_ENDING_2:">"===C?(c.cdata&&_e(c,"oncdata",c.cdata),_e(c,"onclosecdata"),c.cdata="",c.state=T.TEXT):"]"===C?c.cdata+="]":(c.cdata+="]]"+C,c.state=T.CDATA);continue;case T.PROC_INST:"?"===C?c.state=T.PROC_INST_ENDING:h(C)?c.state=T.PROC_INST_BODY:c.procInstName+=C;continue;case T.PROC_INST_BODY:if(!c.procInstBody&&h(C))continue;"?"===C?c.state=T.PROC_INST_ENDING:c.procInstBody+=C;continue;case T.PROC_INST_ENDING:">"===C?(_e(c,"onprocessinginstruction",{name:c.procInstName,body:c.procInstBody}),c.procInstName=c.procInstBody="",c.state=T.TEXT):(c.procInstBody+="?"+C,c.state=T.PROC_INST_BODY);continue;case T.OPEN_TAG:P(se,C)?c.tagName+=C:(Je(c),">"===C?ae(c):"/"===C?c.state=T.OPEN_TAG_SLASH:(h(C)||ne(c,"Invalid character in tag name"),c.state=T.ATTRIB));continue;case T.OPEN_TAG_SLASH:">"===C?(ae(c,!0),ge(c)):(ne(c,"Forward-slash in opening tag not followed by >"),c.state=T.ATTRIB);continue;case T.ATTRIB:if(h(C))continue;">"===C?ae(c):"/"===C?c.state=T.OPEN_TAG_SLASH:P(q,C)?(c.attribName=C,c.attribValue="",c.state=T.ATTRIB_NAME):ne(c,"Invalid attribute name");continue;case T.ATTRIB_NAME:"="===C?c.state=T.ATTRIB_VALUE:">"===C?(ne(c,"Attribute without value"),c.attribValue=c.attribName,xe(c),ae(c)):h(C)?c.state=T.ATTRIB_NAME_SAW_WHITE:P(se,C)?c.attribName+=C:ne(c,"Invalid attribute name");continue;case T.ATTRIB_NAME_SAW_WHITE:if("="===C)c.state=T.ATTRIB_VALUE;else{if(h(C))continue;ne(c,"Attribute without value"),c.tag.attributes[c.attribName]="",c.attribValue="",_e(c,"onattribute",{name:c.attribName,value:""}),c.attribName="",">"===C?ae(c):P(q,C)?(c.attribName=C,c.state=T.ATTRIB_NAME):(ne(c,"Invalid attribute name"),c.state=T.ATTRIB)}continue;case T.ATTRIB_VALUE:if(h(C))continue;u(C)?(c.q=C,c.state=T.ATTRIB_VALUE_QUOTED):(ne(c,"Unquoted attribute value"),c.state=T.ATTRIB_VALUE_UNQUOTED,c.attribValue=C);continue;case T.ATTRIB_VALUE_QUOTED:if(C!==c.q){"&"===C?c.state=T.ATTRIB_VALUE_ENTITY_Q:c.attribValue+=C;continue}xe(c),c.q="",c.state=T.ATTRIB_VALUE_CLOSED;continue;case T.ATTRIB_VALUE_CLOSED:h(C)?c.state=T.ATTRIB:">"===C?ae(c):"/"===C?c.state=T.OPEN_TAG_SLASH:P(q,C)?(ne(c,"No whitespace between attributes"),c.attribName=C,c.attribValue="",c.state=T.ATTRIB_NAME):ne(c,"Invalid attribute name");continue;case T.ATTRIB_VALUE_UNQUOTED:if(!y(C)){"&"===C?c.state=T.ATTRIB_VALUE_ENTITY_U:c.attribValue+=C;continue}xe(c),">"===C?ae(c):c.state=T.ATTRIB;continue;case T.CLOSE_TAG:if(c.tagName)">"===C?ge(c):P(se,C)?c.tagName+=C:c.script?(c.script+="</"+c.tagName,c.tagName="",c.state=T.SCRIPT):(h(C)||ne(c,"Invalid tagname in closing tag"),c.state=T.CLOSE_TAG_SAW_WHITE);else{if(h(C))continue;$(q,C)?c.script?(c.script+="</"+C,c.state=T.SCRIPT):ne(c,"Invalid tagname in closing tag."):c.tagName=C}continue;case T.CLOSE_TAG_SAW_WHITE:if(h(C))continue;">"===C?ge(c):ne(c,"Invalid characters in closing tag");continue;case T.TEXT_ENTITY:case T.ATTRIB_VALUE_ENTITY_Q:case T.ATTRIB_VALUE_ENTITY_U:var Q,me;switch(c.state){case T.TEXT_ENTITY:Q=T.TEXT,me="textNode";break;case T.ATTRIB_VALUE_ENTITY_Q:Q=T.ATTRIB_VALUE_QUOTED,me="attribValue";break;case T.ATTRIB_VALUE_ENTITY_U:Q=T.ATTRIB_VALUE_UNQUOTED,me="attribValue"}";"===C?(c[me]+=ke(c),c.entity="",c.state=Q):P(c.entity.length?k:N,C)?c.entity+=C:(ne(c,"Invalid character in entity name"),c[me]+="&"+c.entity+C,c.entity="",c.state=Q);continue;default:throw new Error(c,"Unknown state: "+c.state)}return c.position>=c.bufferCheckPosition&&function L(_){for(var c=Math.max(e.MAX_BUFFER_LENGTH,10),I=0,C=0,J=O.length;C<J;C++){var ce=_[O[C]].length;if(ce>c)switch(O[C]){case"textNode":Ne(_);break;case"cdata":_e(_,"oncdata",_.cdata),_.cdata="";break;case"script":_e(_,"onscript",_.script),_.script="";break;default:Me(_,"Max buffer length exceeded: "+O[C])}I=Math.max(I,ce)}_.bufferCheckPosition=e.MAX_BUFFER_LENGTH-I+_.position}(c),c},resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){!function D(_){Ne(_),""!==_.cdata&&(_e(_,"oncdata",_.cdata),_.cdata=""),""!==_.script&&(_e(_,"onscript",_.script),_.script="")}(this)}};try{g=Object(function(){var c=new Error("Cannot find module 'stream'");throw c.code="MODULE_NOT_FOUND",c}())}catch{g=function(){}}var U=e.EVENTS.filter(function(_){return"error"!==_&&"end"!==_});function F(_,c){if(!(this instanceof F))return new F(_,c);g.apply(this),this._parser=new M(_,c),this.writable=!0,this.readable=!0;var I=this;this._parser.onend=function(){I.emit("end")},this._parser.onerror=function(C){I.emit("error",C),I._parser.error=null},this._decoder=null,U.forEach(function(C){Object.defineProperty(I,"on"+C,{get:function(){return I._parser["on"+C]},set:function(J){if(!J)return I.removeAllListeners(C),I._parser["on"+C]=J,J;I.on(C,J)},enumerable:!0,configurable:!1})})}(F.prototype=Object.create(g.prototype,{constructor:{value:F}})).write=function(_){if("function"==typeof Buffer&&"function"==typeof Buffer.isBuffer&&Buffer.isBuffer(_)){if(!this._decoder){var c=R(3054).s;this._decoder=new c("utf8")}_=this._decoder.write(_)}return this._parser.write(_.toString()),this.emit("data",_),!0},F.prototype.end=function(_){return _&&_.length&&this.write(_),this._parser.end(),!0},F.prototype.on=function(_,c){var I=this;return!I._parser["on"+_]&&-1!==U.indexOf(_)&&(I._parser["on"+_]=function(){var C=1===arguments.length?[arguments[0]]:Array.apply(null,arguments);C.splice(0,0,_),I.emit.apply(I,C)}),g.prototype.on.call(I,_,c)};var z="[CDATA[",W="DOCTYPE",B="http://www.w3.org/XML/1998/namespace",Y="http://www.w3.org/2000/xmlns/",H={xml:B,xmlns:Y},q=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,se=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/,N=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,k=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/;function h(_){return" "===_||"\n"===_||"\r"===_||"\t"===_}function u(_){return'"'===_||"'"===_}function y(_){return">"===_||h(_)}function P(_,c){return _.test(c)}function $(_,c){return!P(_,c)}var _,c,I,T=0;for(var K in e.STATE={BEGIN:T++,BEGIN_WHITESPACE:T++,TEXT:T++,TEXT_ENTITY:T++,OPEN_WAKA:T++,SGML_DECL:T++,SGML_DECL_QUOTED:T++,DOCTYPE:T++,DOCTYPE_QUOTED:T++,DOCTYPE_DTD:T++,DOCTYPE_DTD_QUOTED:T++,COMMENT_STARTING:T++,COMMENT:T++,COMMENT_ENDING:T++,COMMENT_ENDED:T++,CDATA:T++,CDATA_ENDING:T++,CDATA_ENDING_2:T++,PROC_INST:T++,PROC_INST_BODY:T++,PROC_INST_ENDING:T++,OPEN_TAG:T++,OPEN_TAG_SLASH:T++,ATTRIB:T++,ATTRIB_NAME:T++,ATTRIB_NAME_SAW_WHITE:T++,ATTRIB_VALUE:T++,ATTRIB_VALUE_QUOTED:T++,ATTRIB_VALUE_CLOSED:T++,ATTRIB_VALUE_UNQUOTED:T++,ATTRIB_VALUE_ENTITY_Q:T++,ATTRIB_VALUE_ENTITY_U:T++,CLOSE_TAG:T++,CLOSE_TAG_SAW_WHITE:T++,SCRIPT:T++,SCRIPT_ENDING:T++},e.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},e.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(e.ENTITIES).forEach(function(_){var c=e.ENTITIES[_],I="number"==typeof c?String.fromCharCode(c):c;e.ENTITIES[_]=I}),e.STATE)e.STATE[e.STATE[K]]=K;function re(_,c,I){_[c]&&_[c](I)}function _e(_,c,I){_.textNode&&Ne(_),re(_,c,I)}function Ne(_){_.textNode=ve(_.opt,_.textNode),_.textNode&&re(_,"ontext",_.textNode),_.textNode=""}function ve(_,c){return _.trim&&(c=c.trim()),_.normalize&&(c=c.replace(/\s+/g," ")),c}function Me(_,c){return Ne(_),_.trackPosition&&(c+="\nLine: "+_.line+"\nColumn: "+_.column+"\nChar: "+_.c),c=new Error(c),_.error=c,re(_,"onerror",c),_}function De(_){return _.sawRoot&&!_.closedRoot&&ne(_,"Unclosed root tag"),_.state!==T.BEGIN&&_.state!==T.BEGIN_WHITESPACE&&_.state!==T.TEXT&&Me(_,"Unexpected end"),Ne(_),_.c="",_.closed=!0,re(_,"onend"),M.call(_,_.strict,_.opt),_}function ne(_,c){if("object"!=typeof _||!(_ instanceof M))throw new Error("bad call to strictFail");_.strict&&Me(_,c)}function Je(_){_.strict||(_.tagName=_.tagName[_.looseCase]());var c=_.tags[_.tags.length-1]||_,I=_.tag={name:_.tagName,attributes:{}};_.opt.xmlns&&(I.ns=c.ns),_.attribList.length=0,_e(_,"onopentagstart",I)}function we(_,c){var C=_.indexOf(":")<0?["",_]:_.split(":"),J=C[0],ce=C[1];return c&&"xmlns"===_&&(J="xmlns",ce=""),{prefix:J,local:ce}}function xe(_){if(_.strict||(_.attribName=_.attribName[_.looseCase]()),-1!==_.attribList.indexOf(_.attribName)||_.tag.attributes.hasOwnProperty(_.attribName))_.attribName=_.attribValue="";else{if(_.opt.xmlns){var c=we(_.attribName,!0),C=c.local;if("xmlns"===c.prefix)if("xml"===C&&_.attribValue!==B)ne(_,"xml: prefix must be bound to "+B+"\nActual: "+_.attribValue);else if("xmlns"===C&&_.attribValue!==Y)ne(_,"xmlns: prefix must be bound to "+Y+"\nActual: "+_.attribValue);else{var J=_.tag,ce=_.tags[_.tags.length-1]||_;J.ns===ce.ns&&(J.ns=Object.create(ce.ns)),J.ns[C]=_.attribValue}_.attribList.push([_.attribName,_.attribValue])}else _.tag.attributes[_.attribName]=_.attribValue,_e(_,"onattribute",{name:_.attribName,value:_.attribValue});_.attribName=_.attribValue=""}}function ae(_,c){if(_.opt.xmlns){var I=_.tag,C=we(_.tagName);I.prefix=C.prefix,I.local=C.local,I.uri=I.ns[C.prefix]||"",I.prefix&&!I.uri&&(ne(_,"Unbound namespace prefix: "+JSON.stringify(_.tagName)),I.uri=C.prefix),I.ns&&(_.tags[_.tags.length-1]||_).ns!==I.ns&&Object.keys(I.ns).forEach(function(b){_e(_,"onopennamespace",{prefix:b,uri:I.ns[b]})});for(var ce=0,Q=_.attribList.length;ce<Q;ce++){var me=_.attribList[ce],Te=me[0],d=me[1],s=we(Te,!0),a=s.prefix,E=""===a?"":I.ns[a]||"",w={name:Te,value:d,prefix:a,local:s.local,uri:E};a&&"xmlns"!==a&&!E&&(ne(_,"Unbound namespace prefix: "+JSON.stringify(a)),w.uri=a),_.tag.attributes[Te]=w,_e(_,"onattribute",w)}_.attribList.length=0}_.tag.isSelfClosing=!!c,_.sawRoot=!0,_.tags.push(_.tag),_e(_,"onopentag",_.tag),c||(_.state=_.noscript||"script"!==_.tagName.toLowerCase()?T.TEXT:T.SCRIPT,_.tag=null,_.tagName=""),_.attribName=_.attribValue="",_.attribList.length=0}function ge(_){if(!_.tagName)return ne(_,"Weird empty close tag."),_.textNode+="</>",void(_.state=T.TEXT);if(_.script){if("script"!==_.tagName)return _.script+="</"+_.tagName+">",_.tagName="",void(_.state=T.SCRIPT);_e(_,"onscript",_.script),_.script=""}var c=_.tags.length,I=_.tagName;_.strict||(I=I[_.looseCase]());for(var C=I;c--&&_.tags[c].name!==C;)ne(_,"Unexpected close tag");if(c<0)return ne(_,"Unmatched closing tag: "+_.tagName),_.textNode+="</"+_.tagName+">",void(_.state=T.TEXT);_.tagName=I;for(var ce=_.tags.length;ce-- >c;){var Q=_.tag=_.tags.pop();_.tagName=_.tag.name,_e(_,"onclosetag",_.tagName);var me={};for(var Te in Q.ns)me[Te]=Q.ns[Te];_.opt.xmlns&&Q.ns!==(_.tags[_.tags.length-1]||_).ns&&Object.keys(Q.ns).forEach(function(s){_e(_,"onclosenamespace",{prefix:s,uri:Q.ns[s]})})}0===c&&(_.closedRoot=!0),_.tagName=_.attribValue=_.attribName="",_.attribList.length=0,_.state=T.TEXT}function ke(_){var C,c=_.entity,I=c.toLowerCase(),J="";return _.ENTITIES[c]?_.ENTITIES[c]:_.ENTITIES[I]?_.ENTITIES[I]:("#"===(c=I).charAt(0)&&("x"===c.charAt(1)?(c=c.slice(2),J=(C=parseInt(c,16)).toString(16)):(c=c.slice(1),J=(C=parseInt(c,10)).toString(10))),c=c.replace(/^0+/,""),isNaN(C)||J.toLowerCase()!==c?(ne(_,"Invalid character entity"),"&"+_.entity+";"):String.fromCodePoint(C))}function be(_,c){"<"===c?(_.state=T.OPEN_WAKA,_.startTagPosition=_.position):h(c)||(ne(_,"Non-whitespace before first tag."),_.textNode=c,_.state=T.TEXT)}function Re(_,c){var I="";return c<_.length&&(I=_.charAt(c)),I}T=e.STATE,String.fromCodePoint||(_=String.fromCharCode,c=Math.floor,I=function(){var J=[],me=-1,Te=arguments.length;if(!Te)return"";for(var d="";++me<Te;){var s=Number(arguments[me]);if(!isFinite(s)||s<0||s>1114111||c(s)!==s)throw RangeError("Invalid code point: "+s);s<=65535?J.push(s):J.push(55296+((s-=65536)>>10),s%1024+56320),(me+1===Te||J.length>16384)&&(d+=_.apply(null,J),J.length=0)}return d},Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:I,configurable:!0,writable:!0}):String.fromCodePoint=I)}(te)},3054:(he,te,R)=>{"use strict";var e=R(3502).Buffer,O=e.isEncoding||function(N){switch((N=""+N)&&N.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function m(N){var k;switch(this.encoding=function L(N){var k=function M(N){if(!N)return"utf8";for(var k;;)switch(N){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return N;default:if(k)return;N=(""+N).toLowerCase(),k=!0}}(N);if("string"!=typeof k&&(e.isEncoding===O||!O(N)))throw new Error("Unknown encoding: "+N);return k||N}(N),this.encoding){case"utf16le":this.text=W,this.end=B,k=4;break;case"utf8":this.fillLast=X,k=4;break;case"base64":this.text=Y,this.end=H,k=3;break;default:return this.write=q,void(this.end=se)}this.lastNeed=0,this.lastTotal=0,this.lastChar=e.allocUnsafe(k)}function D(N){return N<=127?0:N>>5==6?2:N>>4==14?3:N>>3==30?4:N>>6==2?-1:-2}function X(N){var k=this.lastTotal-this.lastNeed,h=function U(N,k,h){if(128!=(192&k[0]))return N.lastNeed=0,"\ufffd";if(N.lastNeed>1&&k.length>1){if(128!=(192&k[1]))return N.lastNeed=1,"\ufffd";if(N.lastNeed>2&&k.length>2&&128!=(192&k[2]))return N.lastNeed=2,"\ufffd"}}(this,N);return void 0!==h?h:this.lastNeed<=N.length?(N.copy(this.lastChar,k,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(N.copy(this.lastChar,k,0,N.length),void(this.lastNeed-=N.length))}function W(N,k){if((N.length-k)%2==0){var h=N.toString("utf16le",k);if(h){var u=h.charCodeAt(h.length-1);if(u>=55296&&u<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=N[N.length-2],this.lastChar[1]=N[N.length-1],h.slice(0,-1)}return h}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=N[N.length-1],N.toString("utf16le",k,N.length-1)}function B(N){var k=N&&N.length?this.write(N):"";return this.lastNeed?k+this.lastChar.toString("utf16le",0,this.lastTotal-this.lastNeed):k}function Y(N,k){var h=(N.length-k)%3;return 0===h?N.toString("base64",k):(this.lastNeed=3-h,this.lastTotal=3,1===h?this.lastChar[0]=N[N.length-1]:(this.lastChar[0]=N[N.length-2],this.lastChar[1]=N[N.length-1]),N.toString("base64",k,N.length-h))}function H(N){var k=N&&N.length?this.write(N):"";return this.lastNeed?k+this.lastChar.toString("base64",0,3-this.lastNeed):k}function q(N){return N.toString(this.encoding)}function se(N){return N&&N.length?this.write(N):""}te.s=m,m.prototype.write=function(N){if(0===N.length)return"";var k,h;if(this.lastNeed){if(void 0===(k=this.fillLast(N)))return"";h=this.lastNeed,this.lastNeed=0}else h=0;return h<N.length?k?k+this.text(N,h):this.text(N,h):k||""},m.prototype.end=function z(N){var k=N&&N.length?this.write(N):"";return this.lastNeed?k+"\ufffd":k},m.prototype.text=function F(N,k){var h=function g(N,k,h){var u=k.length-1;if(u<h)return 0;var y=D(k[u]);return y>=0?(y>0&&(N.lastNeed=y-1),y):--u<h||-2===y?0:(y=D(k[u]))>=0?(y>0&&(N.lastNeed=y-2),y):--u<h||-2===y?0:(y=D(k[u]))>=0?(y>0&&(2===y?y=0:N.lastNeed=y-3),y):0}(this,N,k);if(!this.lastNeed)return N.toString("utf8",k);this.lastTotal=h;var u=N.length-(h-this.lastNeed);return N.copy(this.lastChar,0,u),N.toString("utf8",k,u)},m.prototype.fillLast=function(N){if(this.lastNeed<=N.length)return N.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);N.copy(this.lastChar,this.lastTotal-this.lastNeed,0,N.length),this.lastNeed-=N.length}},7234:he=>{"use strict";var te=/([=:@$/])/g,R=/([&;/])/g,e=/[=:@$]/,O=/[&;]/;function M(g,U){return encodeURI(g.replace(U,"/$1"))}he.exports={stringify:function m(g,U){if(!U)return function L(g){return"string"==typeof g?g.replace(/;+$/g,""):g}(m(g,!0));if("number"==typeof g||!0===g||!1===g||null===g)return":"+g;var X=[];if(g instanceof Array){for(var F=0;F<g.length;++F)X.push(typeof g[F]>"u"?":null":m(g[F],!0));return"@"+X.join("&")+";"}if("object"==typeof g){for(var z in g){var W=m(g[z],!0);W&&X.push(M(z,te)+W)}return"$"+X.join("&")+";"}return typeof g>"u"?void 0:"="+M(g.toString(),R)},parse:function D(g){var U=0;function X(z){for(var W="";U!==g.length;++U){if("/"===g.charAt(U)){if((U+=1)===g.length){W+=";";break}}else if(g.charAt(U).match(z))break;W+=g.charAt(U)}return W}return g=decodeURI(g),function F(){var B,z=g.charAt(U++);if("="===z)return X(O);if(":"===z){var W=X(O);return"true"===W||"false"!==W&&(W=parseFloat(W),isNaN(W)?null:W)}if("@"===z){B=[];e:if(!(U>=g.length||";"===g.charAt(U)))for(;;){if(B.push(F()),U>=g.length||";"===g.charAt(U))break e;U+=1}return U+=1,B}if("$"===z){B={};e:if(!(U>=g.length||";"===g.charAt(U)))for(;;){if(B[X(e)]=F(),U>=g.length||";"===g.charAt(U))break e;U+=1}return U+=1,B}throw new Error("Unexpected char "+z)}()}}},5097:he=>{he.exports={isArray:function(te){return Array.isArray?Array.isArray(te):"[object Array]"===Object.prototype.toString.call(te)}}},9220:(he,te,R)=>{var e=R(9910),O=R(6976),M=R(3559),L=R(1097);he.exports={xml2js:e,xml2json:O,js2xml:M,json2xml:L}},3559:(he,te,R)=>{var M,L,e=R(5886),O=R(5097).isArray;function D(h,u,y){return(!y&&h.spaces?"\n":"")+Array(u+1).join(h.spaces)}function g(h,u,y){if(u.ignoreAttributes)return"";"attributesFn"in u&&(h=u.attributesFn(h,L,M));var P,$,T,K,re=[];for(P in h)h.hasOwnProperty(P)&&null!=h[P]&&(K=u.noQuotesForNativeAttributes&&"string"!=typeof h[P]?"":'"',$=($=""+h[P]).replace(/"/g,"&quot;"),T="attributeNameFn"in u?u.attributeNameFn(P,$,L,M):P,re.push(u.spaces&&u.indentAttributes?D(u,y+1,!1):" "),re.push(T+"="+K+("attributeValueFn"in u?u.attributeValueFn($,P,L,M):$)+K));return h&&Object.keys(h).length&&u.spaces&&u.indentAttributes&&re.push(D(u,y,!1)),re.join("")}function U(h,u,y){return M=h,L="xml",u.ignoreDeclaration?"":"<?xml"+g(h[u.attributesKey],u,y)+"?>"}function X(h,u,y){if(u.ignoreInstruction)return"";var P;for(P in h)if(h.hasOwnProperty(P))break;var $="instructionNameFn"in u?u.instructionNameFn(P,h[P],L,M):P;if("object"==typeof h[P])return M=h,L=$,"<?"+$+g(h[P][u.attributesKey],u,y)+"?>";var T=h[P]?h[P]:"";return"instructionFn"in u&&(T=u.instructionFn(T,P,L,M)),"<?"+$+(T?" "+T:"")+"?>"}function F(h,u){return u.ignoreComment?"":"\x3c!--"+("commentFn"in u?u.commentFn(h,L,M):h)+"--\x3e"}function z(h,u){return u.ignoreCdata?"":"<![CDATA["+("cdataFn"in u?u.cdataFn(h,L,M):h.replace("]]>","]]]]><![CDATA[>"))+"]]>"}function W(h,u){return u.ignoreDoctype?"":"<!DOCTYPE "+("doctypeFn"in u?u.doctypeFn(h,L,M):h)+">"}function B(h,u){return u.ignoreText?"":(h=(h=(h=""+h).replace(/&amp;/g,"&")).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),"textFn"in u?u.textFn(h,L,M):h)}function q(h,u,y,P){return h.reduce(function($,T){var K=D(u,y,P&&!$);switch(T.type){case"element":return $+K+function H(h,u,y){M=h,L=h.name;var P=[],$="elementNameFn"in u?u.elementNameFn(h.name,h):h.name;P.push("<"+$),h[u.attributesKey]&&P.push(g(h[u.attributesKey],u,y));var T=h[u.elementsKey]&&h[u.elementsKey].length||h[u.attributesKey]&&"preserve"===h[u.attributesKey]["xml:space"];return T||(T="fullTagEmptyElementFn"in u?u.fullTagEmptyElementFn(h.name,h):u.fullTagEmptyElement),T?(P.push(">"),h[u.elementsKey]&&h[u.elementsKey].length&&(P.push(q(h[u.elementsKey],u,y+1)),M=h,L=h.name),P.push(u.spaces&&function Y(h,u){var y;if(h.elements&&h.elements.length)for(y=0;y<h.elements.length;++y)switch(h.elements[y][u.typeKey]){case"text":if(u.indentText)return!0;break;case"cdata":if(u.indentCdata)return!0;break;case"instruction":if(u.indentInstruction)return!0;break;default:return!0}return!1}(h,u)?"\n"+Array(y+1).join(u.spaces):""),P.push("</"+$+">")):P.push("/>"),P.join("")}(T,u,y);case"comment":return $+K+F(T[u.commentKey],u);case"doctype":return $+K+W(T[u.doctypeKey],u);case"cdata":return $+(u.indentCdata?K:"")+z(T[u.cdataKey],u);case"text":return $+(u.indentText?K:"")+B(T[u.textKey],u);case"instruction":var re={};return re[T[u.nameKey]]=T[u.attributesKey]?T:T[u.instructionKey],$+(u.indentInstruction?K:"")+X(re,u,y)}},"")}function se(h,u,y){var P;for(P in h)if(h.hasOwnProperty(P))switch(P){case u.parentKey:case u.attributesKey:break;case u.textKey:if(u.indentText||y)return!0;break;case u.cdataKey:if(u.indentCdata||y)return!0;break;case u.instructionKey:if(u.indentInstruction||y)return!0;break;default:return!0}return!1}function N(h,u,y,P,$){M=h,L=u;var T="elementNameFn"in y?y.elementNameFn(u,h):u;if(typeof h>"u"||null===h||""===h)return"fullTagEmptyElementFn"in y&&y.fullTagEmptyElementFn(u,h)||y.fullTagEmptyElement?"<"+T+"></"+T+">":"<"+T+"/>";var K=[];if(u){if(K.push("<"+T),"object"!=typeof h)return K.push(">"+B(h,y)+"</"+T+">"),K.join("");h[y.attributesKey]&&K.push(g(h[y.attributesKey],y,P));var re=se(h,y,!0)||h[y.attributesKey]&&"preserve"===h[y.attributesKey]["xml:space"];if(re||(re="fullTagEmptyElementFn"in y?y.fullTagEmptyElementFn(u,h):y.fullTagEmptyElement),!re)return K.push("/>"),K.join("");K.push(">")}return K.push(k(h,y,P+1,!1)),M=h,L=u,u&&K.push(($?D(y,P,!1):"")+"</"+T+">"),K.join("")}function k(h,u,y,P){var $,T,K,re=[];for(T in h)if(h.hasOwnProperty(T))for(K=O(h[T])?h[T]:[h[T]],$=0;$<K.length;++$){switch(T){case u.declarationKey:re.push(U(K[$],u,y));break;case u.instructionKey:re.push((u.indentInstruction?D(u,y,P):"")+X(K[$],u,y));break;case u.attributesKey:case u.parentKey:break;case u.textKey:re.push((u.indentText?D(u,y,P):"")+B(K[$],u));break;case u.cdataKey:re.push((u.indentCdata?D(u,y,P):"")+z(K[$],u));break;case u.doctypeKey:re.push(D(u,y,P)+W(K[$],u));break;case u.commentKey:re.push(D(u,y,P)+F(K[$],u));break;default:re.push(D(u,y,P)+N(K[$],T,u,y,se(K[$],u)))}P=P&&!re.length}return re.join("")}he.exports=function(h,u){u=function m(h){var u=e.copyOptions(h);return e.ensureFlagExists("ignoreDeclaration",u),e.ensureFlagExists("ignoreInstruction",u),e.ensureFlagExists("ignoreAttributes",u),e.ensureFlagExists("ignoreText",u),e.ensureFlagExists("ignoreComment",u),e.ensureFlagExists("ignoreCdata",u),e.ensureFlagExists("ignoreDoctype",u),e.ensureFlagExists("compact",u),e.ensureFlagExists("indentText",u),e.ensureFlagExists("indentCdata",u),e.ensureFlagExists("indentAttributes",u),e.ensureFlagExists("indentInstruction",u),e.ensureFlagExists("fullTagEmptyElement",u),e.ensureFlagExists("noQuotesForNativeAttributes",u),e.ensureSpacesExists(u),"number"==typeof u.spaces&&(u.spaces=Array(u.spaces+1).join(" ")),e.ensureKeyExists("declaration",u),e.ensureKeyExists("instruction",u),e.ensureKeyExists("attributes",u),e.ensureKeyExists("text",u),e.ensureKeyExists("comment",u),e.ensureKeyExists("cdata",u),e.ensureKeyExists("doctype",u),e.ensureKeyExists("type",u),e.ensureKeyExists("name",u),e.ensureKeyExists("elements",u),e.checkFnExists("doctype",u),e.checkFnExists("instruction",u),e.checkFnExists("cdata",u),e.checkFnExists("comment",u),e.checkFnExists("text",u),e.checkFnExists("instructionName",u),e.checkFnExists("elementName",u),e.checkFnExists("attributeName",u),e.checkFnExists("attributeValue",u),e.checkFnExists("attributes",u),e.checkFnExists("fullTagEmptyElement",u),u}(u);var y=[];return M=h,L="_root_",u.compact?y.push(k(h,u,0,!0)):(h[u.declarationKey]&&y.push(U(h[u.declarationKey],u,0)),h[u.elementsKey]&&h[u.elementsKey].length&&y.push(q(h[u.elementsKey],u,0,!y.length))),y.join("")}},1097:(he,te,R)=>{var e=R(3559);he.exports=function(O,M){O instanceof Buffer&&(O=O.toString());var L=null;if("string"==typeof O)try{L=JSON.parse(O)}catch{throw new Error("The JSON structure is invalid")}else L=O;return e(L,M)}},5886:(he,te,R)=>{var e=R(5097).isArray;he.exports={copyOptions:function(O){var M,L={};for(M in O)O.hasOwnProperty(M)&&(L[M]=O[M]);return L},ensureFlagExists:function(O,M){(!(O in M)||"boolean"!=typeof M[O])&&(M[O]=!1)},ensureSpacesExists:function(O){(!("spaces"in O)||"number"!=typeof O.spaces&&"string"!=typeof O.spaces)&&(O.spaces=0)},ensureAlwaysArrayExists:function(O){(!("alwaysArray"in O)||"boolean"!=typeof O.alwaysArray&&!e(O.alwaysArray))&&(O.alwaysArray=!1)},ensureKeyExists:function(O,M){(!(O+"Key"in M)||"string"!=typeof M[O+"Key"])&&(M[O+"Key"]=M.compact?"_"+O:O)},checkFnExists:function(O,M){return O+"Fn"in M}}},9910:(he,te,R)=>{var m,g,e=R(1503),M=R(5886),L=R(5097).isArray;function X(h){var u=Number(h);if(!isNaN(u))return u;var y=h.toLowerCase();return"true"===y||"false"!==y&&h}function F(h,u){var y;if(m.compact){if(!g[m[h+"Key"]]&&(L(m.alwaysArray)?-1!==m.alwaysArray.indexOf(m[h+"Key"]):m.alwaysArray)&&(g[m[h+"Key"]]=[]),g[m[h+"Key"]]&&!L(g[m[h+"Key"]])&&(g[m[h+"Key"]]=[g[m[h+"Key"]]]),h+"Fn"in m&&"string"==typeof u&&(u=m[h+"Fn"](u,g)),"instruction"===h&&("instructionFn"in m||"instructionNameFn"in m))for(y in u)if(u.hasOwnProperty(y))if("instructionFn"in m)u[y]=m.instructionFn(u[y],y,g);else{var P=u[y];delete u[y],u[m.instructionNameFn(y,P,g)]=P}L(g[m[h+"Key"]])?g[m[h+"Key"]].push(u):g[m[h+"Key"]]=u}else{g[m.elementsKey]||(g[m.elementsKey]=[]);var $={};if($[m.typeKey]=h,"instruction"===h){for(y in u)if(u.hasOwnProperty(y))break;$[m.nameKey]="instructionNameFn"in m?m.instructionNameFn(y,u,g):y,m.instructionHasAttributes?($[m.attributesKey]=u[y][m.attributesKey],"instructionFn"in m&&($[m.attributesKey]=m.instructionFn($[m.attributesKey],y,g))):("instructionFn"in m&&(u[y]=m.instructionFn(u[y],y,g)),$[m.instructionKey]=u[y])}else h+"Fn"in m&&(u=m[h+"Fn"](u,g)),$[m[h+"Key"]]=u;m.addParent&&($[m.parentKey]=g),g[m.elementsKey].push($)}}function z(h){var u;if("attributesFn"in m&&h&&(h=m.attributesFn(h,g)),(m.trim||"attributeValueFn"in m||"attributeNameFn"in m||m.nativeTypeAttributes)&&h)for(u in h)if(h.hasOwnProperty(u)&&(m.trim&&(h[u]=h[u].trim()),m.nativeTypeAttributes&&(h[u]=X(h[u])),"attributeValueFn"in m&&(h[u]=m.attributeValueFn(h[u],u,g)),"attributeNameFn"in m)){var y=h[u];delete h[u],h[m.attributeNameFn(u,h[u],g)]=y}return h}function W(h){var u={};if(h.body&&("xml"===h.name.toLowerCase()||m.instructionHasAttributes)){for(var P,y=/([\w:-]+)\s*=\s*(?:"([^"]*)"|'([^']*)'|(\w+))\s*/g;null!==(P=y.exec(h.body));)u[P[1]]=P[2]||P[3]||P[4];u=z(u)}if("xml"===h.name.toLowerCase()){if(m.ignoreDeclaration)return;g[m.declarationKey]={},Object.keys(u).length&&(g[m.declarationKey][m.attributesKey]=u),m.addParent&&(g[m.declarationKey][m.parentKey]=g)}else{if(m.ignoreInstruction)return;m.trim&&(h.body=h.body.trim());var $={};m.instructionHasAttributes&&Object.keys(u).length?($[h.name]={},$[h.name][m.attributesKey]=u):$[h.name]=h.body,F("instruction",$)}}function B(h,u){var y;if("object"==typeof h&&(u=h.attributes,h=h.name),u=z(u),"elementNameFn"in m&&(h=m.elementNameFn(h,g)),m.compact){var P;if(y={},!m.ignoreAttributes&&u&&Object.keys(u).length)for(P in y[m.attributesKey]={},u)u.hasOwnProperty(P)&&(y[m.attributesKey][P]=u[P]);!(h in g)&&(L(m.alwaysArray)?-1!==m.alwaysArray.indexOf(h):m.alwaysArray)&&(g[h]=[]),g[h]&&!L(g[h])&&(g[h]=[g[h]]),L(g[h])?g[h].push(y):g[h]=y}else g[m.elementsKey]||(g[m.elementsKey]=[]),(y={})[m.typeKey]="element",y[m.nameKey]=h,!m.ignoreAttributes&&u&&Object.keys(u).length&&(y[m.attributesKey]=u),m.alwaysChildren&&(y[m.elementsKey]=[]),g[m.elementsKey].push(y);y[m.parentKey]=g,g=y}function Y(h){m.ignoreText||!h.trim()&&!m.captureSpacesBetweenElements||(m.trim&&(h=h.trim()),m.nativeType&&(h=X(h)),m.sanitize&&(h=h.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")),F("text",h))}function H(h){m.ignoreComment||(m.trim&&(h=h.trim()),F("comment",h))}function q(h){var u=g[m.parentKey];m.addParent||delete g[m.parentKey],g=u}function se(h){m.ignoreCdata||(m.trim&&(h=h.trim()),F("cdata",h))}function N(h){m.ignoreDoctype||(h=h.replace(/^ /,""),m.trim&&(h=h.trim()),F("doctype",h))}function k(h){h.note=h}he.exports=function(h,u){var y=e.parser(!0,{}),P={};if(g=P,m=function U(h){return m=M.copyOptions(h),M.ensureFlagExists("ignoreDeclaration",m),M.ensureFlagExists("ignoreInstruction",m),M.ensureFlagExists("ignoreAttributes",m),M.ensureFlagExists("ignoreText",m),M.ensureFlagExists("ignoreComment",m),M.ensureFlagExists("ignoreCdata",m),M.ensureFlagExists("ignoreDoctype",m),M.ensureFlagExists("compact",m),M.ensureFlagExists("alwaysChildren",m),M.ensureFlagExists("addParent",m),M.ensureFlagExists("trim",m),M.ensureFlagExists("nativeType",m),M.ensureFlagExists("nativeTypeAttributes",m),M.ensureFlagExists("sanitize",m),M.ensureFlagExists("instructionHasAttributes",m),M.ensureFlagExists("captureSpacesBetweenElements",m),M.ensureAlwaysArrayExists(m),M.ensureKeyExists("declaration",m),M.ensureKeyExists("instruction",m),M.ensureKeyExists("attributes",m),M.ensureKeyExists("text",m),M.ensureKeyExists("comment",m),M.ensureKeyExists("cdata",m),M.ensureKeyExists("doctype",m),M.ensureKeyExists("type",m),M.ensureKeyExists("name",m),M.ensureKeyExists("elements",m),M.ensureKeyExists("parent",m),M.checkFnExists("doctype",m),M.checkFnExists("instruction",m),M.checkFnExists("cdata",m),M.checkFnExists("comment",m),M.checkFnExists("text",m),M.checkFnExists("instructionName",m),M.checkFnExists("elementName",m),M.checkFnExists("attributeName",m),M.checkFnExists("attributeValue",m),M.checkFnExists("attributes",m),m}(u),y.opt={strictEntities:!0},y.onopentag=B,y.ontext=Y,y.oncomment=H,y.onclosetag=q,y.onerror=k,y.oncdata=se,y.ondoctype=N,y.onprocessinginstruction=W,y.write(h).close(),P[m.elementsKey]){var $=P[m.elementsKey];delete P[m.elementsKey],P[m.elementsKey]=$,delete P.text}return P}},6976:(he,te,R)=>{var e=R(5886),O=R(9910);he.exports=function(L,m){var D,g,X;return D=function M(L){var m=e.copyOptions(L);return e.ensureSpacesExists(m),m}(m),g=O(L,D),X="compact"in D&&D.compact?"_parent":"parent",("addParent"in D&&D.addParent?JSON.stringify(g,function(F,z){return F===X?"_":z},D.spaces):JSON.stringify(g,null,D.spaces)).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")}}}]);